 AS V1.42 Beta [Bld 227] - Source File emuz80monRevB021.asm - Page 1 - 10/24/2022 10:32:49


       1/       0 :                     	page	0
       2/       0 :                     	cpu	z80
       3/       0 :                     ;;; 
       4/       0 :                     ;;; Universal Monitor for Zilog Z80
       5/       0 :                     ;;;   Copyright (C) 2019,2020,2021 Haruo Asano
       6/       0 :                     ;;;
       7/       0 :                     
       8/       0 :                     ;;; 2022.10.10 It was added functions by A.honda
       9/       0 :                     ;;; Rev.B02
      10/       0 :                     
      11/       0 :                     ;;; Constants
      12/       0 : =0DH                 CR	EQU	0DH
      13/       0 : =0AH                 LF	EQU	0AH
      14/       0 : =8H                  BS	EQU	08H
      15/       0 : =7FH                 DEL	EQU	7FH
      16/       0 : =20H                 BUFLEN	equ	32	
      17/       0 : =8H                  F_bitSize	equ	8
      18/       0 :                     ;;;
      19/       0 :                     ;;; Memory switch
      20/       0 :                     ;;;
      21/       0 :                     
      22/       0 : =1H                  RAM12K = 1
      23/       0 : =0H                  RAM8K = 0
      24/       0 : =0H                  RAM4K = 0
      25/       0 : =0H                  BACKDOOR = 0
      26/       0 :                     
      27/       0 : =>TRUE               	IF	RAM12K
      28/       0 :                     ;; ROM48K RAM12K for PIC18F47Q84
      29/       0 : =0FF00H              UARTDR	EQU	0FF00H	; UART DATA REGISTOR
      30/       0 : =0FF01H              UARTCR	EQU	0FF01H	; UART CONTROL REGISTOR
      31/       0 : =0EF00H              WORK_B	equ	0EF00H	; work area EF00-EFFF
      32/       0 : =0EF00H              STACKM	equ	0EF00H	; monitor stack
      33/       0 : =0EEC0H              STACK	equ	0EEC0H	; user stack
      34/       0 : =0H                  ROM_B	equ	0000H	;EMUZ80_Q84 ROM base address
      35/       0 : =0C000H              RAM_B	equ	0C000H	;EMUZ80_Q84 RAM base address
      36/       0 : =0EFFFH              RAM_E	equ	0EFFFH	;EMUZ80_Q84 RAM END address
      37/       0 : =0F000H              IO_B	equ	0F000H	;EMUZ80_Q84 I/O base address
      38/       0 : [27]                 	ENDIF
      39/       0 :                     
      40/       0 : =>FALSE              	IF	RAM8K
      41/       0 :                     ; ORIGINAL MEMORY MAP for PIC18F47Q84
      42/       0 :                     UARTDR	EQU	0E000H	; UART DATA REGISTOR
      43/       0 :                     UARTCR	EQU	0E001H	; UART CONTROL REGISTOR
      44/       0 :                     WORK_B	equ	9F00H	; work area 9F00-9FFF
      45/       0 :                     STACKM	equ	9F00H	; monitor stack
      46/       0 :                     STACK	equ	9EC0H	; user stack
      47/       0 :                     ROM_B	equ	0000H	;EMUZ80_Q84 ROM base address
      48/       0 :                     RAM_B	equ	8000H	;EMUZ80_Q84 RAM base address
      49/       0 :                     RAM_E	equ	9FFFH	;EMUZ80_Q84 RAM END address
      50/       0 :                     IO_B	equ	0E000H	;EMUZ80_Q84 I/O base address
      51/       0 : [40]                 	ENDIF
      52/       0 :                     
      53/       0 : =>FALSE              	IF	RAM4K
      54/       0 :                     ; ORIGINAL MEMORY MAP for PIC18F47Q43
      55/       0 :                     
      56/       0 :                     UARTDR	EQU	0E000H	; UART DATA REGISTOR
      57/       0 :                     UARTCR	EQU	0E001H	; UART CONTROL REGISTOR
      58/       0 :                     WORK_B	equ	8F00H	; work area 8F00-8FFF
      59/       0 :                     STACKM	equ	8F00H	; monitor stack
      60/       0 :                     STACK	equ	8EC0H	; user stack
      61/       0 :                     ROM_B	equ	0000H	;EMUZ80_Q43 ROM base address
      62/       0 :                     RAM_B	equ	8000H	;EMUZ80_Q43 RAM base address
      63/       0 :                     RAM_E	equ	9FFFH	;EMUZ80_Q43 RAM END address
      64/       0 :                     IO_B	equ	0E000H	;EMUZ80_Q43 I/O base address
      65/       0 : [53]                 	ENDIF
      66/       0 :                     
      67/       0 : =2000H               BASIC_TOP	equ	2000H
      68/       0 : =2000H               BASIC_CST	equ	2000H	; basic cold start
      69/       0 : =2003H               BASIC_WST	equ	2003H	; basic warm start
      70/       0 :                     
      71/       0 : =>TRUE               	IF	RAM12K
      72/       0 : =0F800H              TIM0_CTL0	equ	0F800H	; timer0 control0 register
      73/       0 : =0F801H              TIM0_CTL1	equ	0F801H	; timer0 control1 register
      74/       0 : =0F810H              TIMER0_CNTL	equ	0F810H	; timer0 16bit counter LSB
      75/       0 : =0F811H              TIMER0_CNTH	equ	0F811H	; timer0 16bit counter MSB
      76/       0 : =0F820H              TIMER0_SCTL	equ	0F820H	; timer0 seconds counter LSB
      77/       0 : =0F821H              TIMER0_SCTH	equ	0F821H	; timer0 seconds counter MSB
      78/       0 : =87E1H               TIMER0_INITC	equ	87e1h	; timer adjust count number
      79/       0 : [71]                 	ENDIF
      80/       0 :                     
      81/       0 : =40H                 ENTRY	EQU	0040H		; Entry point
      82/       0 :                     
      83/       0 :                     ;;; 
      84/       0 :                     ;;; ROM area
      85/       0 :                     ;;;
      86/       0 :                     start:
      87/       0 :                     
      88/       0 :                     	ORG	ROM_B	; (RST 00H)
      89/       0 :                     
      90/       0 :                     E_CSTART:
      91/       0 : C3 40 00            	JP	CSTART
      92/       3 :                     
      93/       3 :                     E_WSTART:
      94/       3 : C3 91 18            	JP	API01
      95/       6 :                     
      96/       6 : 00 00               	db	0008H - $ dup(00H)
      97/       8 :                     ;	ORG	0008H	; (RST 08H)
      98/       8 : =>FALSE              	IF	BACKDOOR
      99/       8 :                     	JP	RST08H
     100/       8 : =>TRUE               	ELSE
     101/       8 : C3 B8 1F            	JP	CONOUT
     102/       B : [98]                 	ENDIF
     103/       B :                     
     104/       B : 00 00 00 00 00      	db	0010H - $ dup(00H)
     105/      10 :                     ;	ORG	0010H	; (RST 10H)
     106/      10 : =>FALSE              	IF	BACKDOOR
     107/      10 :                     	JP	RST10H
     108/      10 : =>TRUE               	ELSE
     109/      10 : C3 A7 1F            	JP	CONIN
     110/      13 : [106]                	ENDIF
     111/      13 :                     
     112/      13 : 00 00 00 00 00      	db	0018H - $ dup(00H)	; nop
     113/      18 :                     ;	ORG	0018H	; (RST 18H)
     114/      18 : =>FALSE              	IF	BACKDOOR
     115/      18 :                     	JP	RST18H
     116/      18 : =>TRUE               	ELSE
     117/      18 : C3 B2 1F            	JP	CONST
     118/      1B : [114]                	ENDIF
     119/      1B :                     
     120/      1B : 00 00 00 00 00      	db	0020H - $ dup(00H)	; nop
     121/      20 :                     ;	ORG	0020H	; (RST 20H)
     122/      20 : =>FALSE              	IF	BACKDOOR
     123/      20 :                     	JP	RST20H
     124/      20 : =>TRUE               	ELSE
     125/      20 : C9                  	RET
     126/      21 : [122]                	ENDIF
     127/      21 :                     
     128/      21 : 00 00 00 00 00 00   	db	0028H - $ dup(00H)	; nop
               27 : 00                
     129/      28 :                     ;	ORG	0028H	; (RST 28H)
     130/      28 : =>FALSE              	IF	BACKDOOR
     131/      28 :                     	RET
     132/      28 : =>TRUE               	ELSE
     133/      28 : C9                  	RET
     134/      29 : [130]                	ENDIF
     135/      29 :                     
     136/      29 : 00 00 00 00 00 00   	db	0030H - $ dup(00H)	; nop
               2F : 00                
     137/      30 :                     ;	ORG	0030H
     138/      30 : =>FALSE              	IF	BACKDOOR
     139/      30 :                     	JP	RST30H
     140/      30 : =>TRUE               	ELSE
     141/      30 : C3 54 18            	JP	RST30H_IN
     142/      33 : [138]                	ENDIF
     143/      33 :                     
     144/      33 : 00 00 00 00 00      	db	0038H - $ dup(00H)	; nop
     145/      38 :                     ;	ORG	0038H
     146/      38 : =>FALSE              	IF	BACKDOOR
     147/      38 :                     	JP	RST38H;
     148/      38 : =>TRUE               	ELSE
     149/      38 : C3 D5 18            	JP	RST38H_IN
     150/      3B : [146]                	ENDIF
     151/      3B :                     
     152/      3B :                     	;;
     153/      3B :                     	;; Entry point
     154/      3B :                     	;;
     155/      3B :                     
     156/      3B : 00 00 00 00 00      	db	ENTRY - $ dup(00H)
     157/      40 :                     	;	ORG	ENTRY
     158/      40 :                     
     159/      40 : =>FALSE              	IF	BACKDOOR
     160/      40 :                     ;;;
     161/      40 :                     ;;; RST 08H Handler
     162/      40 :                     ;;;
     163/      40 :                     RST08H:
     164/      40 :                     
     165/      40 :                     	ld	(save_hl), hl	; save hl
     166/      40 :                     	ld	hl, (stealRST08)
     167/      40 :                     	jr	jmp_rst
     168/      40 :                     
     169/      40 :                     ;;;
     170/      40 :                     ;;; RST 10H Handler
     171/      40 :                     ;;;
     172/      40 :                     RST10H:
     173/      40 :                     
     174/      40 :                     	ld	(save_hl), hl	; save hl
     175/      40 :                     	ld	hl, (stealRST10)
     176/      40 :                     	jr	jmp_rst
     177/      40 :                     
     178/      40 :                     ;;;
     179/      40 :                     ;;; RST 18H Handler
     180/      40 :                     ;;;
     181/      40 :                     RST18H:
     182/      40 :                     
     183/      40 :                     	ld	(save_hl), hl	; save hl
     184/      40 :                     	ld	hl, (stealRST18)
     185/      40 :                     	jr	jmp_rst
     186/      40 :                     
     187/      40 :                     ;;;
     188/      40 :                     ;;; RST 20H Handler
     189/      40 :                     ;;;
     190/      40 :                     RST20H:
     191/      40 :                     
     192/      40 :                     	ld	(save_hl), hl	; save hl
     193/      40 :                     	ld	hl, (stealRST20)
     194/      40 :                     	jr	jmp_rst
     195/      40 :                     
     196/      40 :                     ;;;
     197/      40 :                     ;;; RST 28H Handler
     198/      40 :                     ;;;
     199/      40 :                     RST28H:
     200/      40 :                     
     201/      40 :                     	ld	(save_hl), hl	; save hl
     202/      40 :                     	ld	hl, (stealRST28)
     203/      40 :                     	jr	jmp_rst
     204/      40 :                     
     205/      40 :                     ;;;
     206/      40 :                     ;;; RST 30H Handler
     207/      40 :                     ;;;
     208/      40 :                     RST30H:
     209/      40 :                     
     210/      40 :                     	ld	(save_hl), hl	; save hl
     211/      40 :                     	ld	hl, (stealRST30)
     212/      40 :                     	jr	jmp_rst
     213/      40 :                     
     214/      40 :                     ;;;
     215/      40 :                     ;;; RST 38H Handler
     216/      40 :                     ;;;
     217/      40 :                     RST38H:
     218/      40 :                     
     219/      40 :                     	ld	(save_hl), hl	; save hl
     220/      40 :                     	ld	hl, (stealRST38)
     221/      40 :                     jmp_rst:
     222/      40 :                     	push	hl		; set jump address
     223/      40 :                     	ld	hl, (save_hl)	; restore hl
     224/      40 :                     RST20H_IN:
     225/      40 :                     RST28H_IN:
     226/      40 :                     	ret			; jump (stealRST38)
     227/      40 : [159]                	ENDIF
     228/      40 :                     
     229/      40 :                     ;;;
     230/      40 :                     ;;; Universal Monitor Z80 Cold start
     231/      40 :                     ;;;
     232/      40 :                     
     233/      40 :                     CSTART:
     234/      40 : F3                  	DI
     235/      41 : 31 00 EF            	LD	SP,STACKM	; monitor stask defines STACKM
     236/      44 :                     
     237/      44 : 21 00 C0            	LD	HL,RAM_B
     238/      47 : 22 20 EF            	LD	(DSADDR),HL
     239/      4A : 22 27 EF            	LD	(SADDR),HL
     240/      4D : 22 25 EF            	LD	(GADDR),HL
     241/      50 : 3E 49               	LD	A,'I'
     242/      52 : 32 29 EF            	LD	(HEXMOD),A
     243/      55 :                     	
     244/      55 : =>FALSE              	IF	BACKDOOR
     245/      55 :                     	; init back door RST XXH entory point
     246/      55 :                     	ld	hl, CONOUT		; RST 08H : CONOUT
     247/      55 :                     	ld	(stealRST08), hl
     248/      55 :                     	ld	hl, CONIN
     249/      55 :                     	ld	(stealRST10), hl	; RST 10H : CONIN
     250/      55 :                     	ld	hl, CONST
     251/      55 :                     	ld	(stealRST18), hl	; RST 18H : CONST
     252/      55 :                     	ld	hl, RST20H_IN
     253/      55 :                     	ld	(stealRST20), hl
     254/      55 :                     	ld	hl, RST28H_IN
     255/      55 :                     	ld	(stealRST28), hl
     256/      55 :                     	ld	hl, RST30H_IN
     257/      55 :                     	ld	(stealRST30), hl
     258/      55 :                     	ld	hl, RST38H_IN
     259/      55 :                     	ld	(stealRST38), hl
     260/      55 : [244]                	ENDIF
     261/      55 :                     
     262/      55 :                     	;; Initialize register value
     263/      55 : AF                  	XOR	A
     264/      56 : 21 2C EF            	LD	HL,REG_B
     265/      59 : 06 1A               	LD	B,REG_E-REG_B
     266/      5B :                     IR0:
     267/      5B : 77                  	LD	(HL),A
     268/      5C : 23                  	INC	HL
     269/      5D : 10 FC               	DJNZ	IR0
     270/      5F :                     
     271/      5F : 21 C0 EE            	LD	HL,STACK		; user stack define STACK
     272/      62 : 22 40 EF            	LD	(REGSP),HL
     273/      65 : 21 00 C0            	ld	hl, RAM_B
     274/      68 : 22 42 EF            	ld	(REGPC), HL		; set program counter
     275/      6B :                     
     276/      6B : 06 08               	ld	b, F_bitSize
     277/      6D : 3E 2E               	ld	a, '.'
     278/      6F : 21 71 EF            	ld	hl, F_bit
     279/      72 :                     ir00:
     280/      72 : 77                  	ld	(hl), a
     281/      73 : 23                  	inc	hl
     282/      74 : 10 FC               	djnz	ir00		; init F_bit string
     283/      76 : AF                  	xor	a
     284/      77 : 77                  	ld	(hl), a		; delimiter
     285/      78 :                     ;
     286/      78 :                     ;	LD	B,100
     287/      78 :                     ;TL:	
     288/      78 :                     ;	XOR	A
     289/      78 :                     ;	CALL	CONOUT
     290/      78 :                     ;	DJNZ	TL
     291/      78 :                     ;
     292/      78 :                     	
     293/      78 :                     ; init dbg work area
     294/      78 :                     
     295/      78 : 06 14               	LD	B, dbg_wend - dbg_wtop
     296/      7A : 21 5D EF            	ld	hl,dbg_wtop	
     297/      7D : AF                  	XOR	A
     298/      7E :                     
     299/      7E :                     dbg_wini:
     300/      7E : 77                  	ld	(hl), a
     301/      7F : 23                  	inc	hl
     302/      80 : 10 FC               	DJNZ	dbg_wini
     303/      82 :                     
     304/      82 : 3E 49               	ld	a, 'I'
     305/      84 : 32 57 EF            	ld	(TM_mode), a	; default call_in mode
     306/      87 : 3E 4E               	ld	a, 'N'
     307/      89 : 32 56 EF            	ld	(TP_mode), a	; default display reg mode
     308/      8C : 2E 00               	ld	l, 0
     309/      8E : 65                  	ld	h, l
     310/      8F : 22 58 EF            	ld	(TC_cnt), hl	; clear trace step counter to 0
     311/      92 : AF                  	xor	a
     312/      93 : 32 5C EF            	ld	(fever_t), a	; clear flag trace forever
     313/      96 :                     	; init bp, tp, gstop address & opcode
     314/      96 : 21 00 C0            	ld	hl, RAM_B
     315/      99 : 22 5F EF            	ld	(tpt1_adr), hl
     316/      9C : 22 63 EF            	ld	(tpt2_adr), hl
     317/      9F : 22 67 EF            	ld	(bpt1_adr), hl
     318/      A2 : 22 6B EF            	ld	(bpt2_adr), hl
     319/      A5 : 22 6F EF            	ld	(tmpb_adr), hl
     320/      A8 : 7E                  	ld	a, (hl)
     321/      A9 : 32 5E EF            	ld	(tpt1_op), a
     322/      AC : 32 62 EF            	ld	(tpt2_op), a
     323/      AF : 32 66 EF            	ld	(bpt1_op), a
     324/      B2 : 32 6A EF            	ld	(bpt2_op), a
     325/      B5 : 32 6E EF            	ld	(tmpb_op), a
     326/      B8 :                     	
     327/      B8 :                     ;; Opening message
     328/      B8 :                     
     329/      B8 : 21 10 1D            	LD	HL,OPNMSG
     330/      BB : CD 48 17            	CALL	STROUT
     331/      BE :                     ;	EI
     332/      BE :                     
     333/      BE :                     WSTART:
     334/      BE : 21 4F 1D            	LD	HL,PROMPT
     335/      C1 : CD 48 17            	CALL	STROUT
     336/      C4 : CD A8 17            	CALL	GETLIN
     337/      C7 : CD 02 18            	CALL	SKIPSP
     338/      CA :                     ;	CALL	UPPER
     339/      CA : B7                  	OR	A
     340/      CB : 28 F1               	JR	Z, WSTART
     341/      CD :                     
     342/      CD : FE 44               	CP	'D'
     343/      CF : CA 60 06            	JP	Z, DUMP
     344/      D2 : FE 47               	CP	'G'
     345/      D4 : CA 47 13            	JP	Z, GO
     346/      D7 : FE 53               	CP	'S'
     347/      D9 : CA 0E 14            	JP	Z, SETM
     348/      DC :                     
     349/      DC : FE 4C               	CP	'L'
     350/      DE : CA 84 14            	JP	Z, LOADH
     351/      E1 : FE 50               	CP	'P'
     352/      E3 : CA 5E 15            	JP	Z, SAVEH
     353/      E6 :                     
     354/      E6 : FE 52               	CP	'R'
     355/      E8 : CA 36 16            	JP	Z, REG
     356/      EB :                     
     357/      EB : FE 23               	cp	'#'
     358/      ED : CA 0E 01            	jp	Z, Launcher
     359/      F0 :                     
     360/      F0 : FE 42               	cp	'B'
     361/      F2 : CA 22 02            	jp	z, brk_cmd	; break point command
     362/      F5 :                     	
     363/      F5 : FE 54               	cp	'T'
     364/      F7 : CA D7 02            	jp	z, trace_cmd	; trace point command
     365/      FA :                     
     366/      FA : FE 3F               	cp	'?'
     367/      FC : 28 08               	jr	z, command_hlp	; command help message
     368/      FE :                     
     369/      FE :                     ERR:
     370/      FE : 21 6C 1D            	LD	HL,ERRMSG
     371/     101 : CD 48 17            	CALL	STROUT
     372/     104 : 18 B8               	JR	WSTART
     373/     106 :                     
     374/     106 :                     ;;
     375/     106 :                     ;; command help
     376/     106 :                     ;;
     377/     106 :                     command_hlp:
     378/     106 :                     
     379/     106 : 21 65 1B            	LD	HL, cmd_hlp
     380/     109 : CD 48 17            	CALL	STROUT
     381/     10C : 18 B0               	JR	WSTART
     382/     10E :                     
     383/     10E :                     ;;
     384/     10E :                     ;; Launch appended program
     385/     10E :                     ;;
     386/     10E :                     Launcher:
     387/     10E : 23                  	INC	HL
     388/     10F : CD 02 18            	CALL	SKIPSP		; A <- next char
     389/     112 :                     ;	CALL	UPPER
     390/     112 : B7                  	OR	A
     391/     113 : 28 E9               	JR	Z,ERR
     392/     115 :                     
     393/     115 :                     	; check L or number
     394/     115 :                     	
     395/     115 : FE 4C               	cp	'L'
     396/     117 : 28 25               	JR	Z,LST_PRG	; list append program
     397/     119 :                     
     398/     119 :                     	; check number
     399/     119 :                     
     400/     119 : CD B6 01            	call	GET_NUM		; return BC : number
     401/     11C : 38 E0               	JR	C, ERR
     402/     11E :                     
     403/     11E :                     	; check number
     404/     11E : 79                  	LD	A, C
     405/     11F : FE 11               	CP	(lanch1 - ApendTBL)/2 +1	; a < 17 ?
     406/     121 : D2 FE 00            	JP	NC, ERR
     407/     124 : B7                  	OR	A				; check '0'
     408/     125 : CA FE 00            	JP	Z, ERR
     409/     128 :                     
     410/     128 :                     	; A <- append program No.
     411/     128 :                     
     412/     128 : 3D                  	DEC	A	; 0 <= A <= 0FH
     413/     129 : 17                  	RLA		; A = A * 2
     414/     12A : 16 00               	LD	D, 0
     415/     12C : 5F                  	LD	E, A
     416/     12D : 21 5C 01            	LD	HL, ApendTBL
     417/     130 : 19                  	ADD	HL, DE	; get lanch address point
     418/     131 : 5E                  	LD	E, (HL)
     419/     132 : 23                  	INC	HL
     420/     133 : 56                  	LD	D, (HL)	; DE : JUMP POINT
     421/     134 :                     
     422/     134 :                     	; Jump to append program
     423/     134 :                     	
     424/     134 : EB                  	EX	DE, HL
     425/     135 : 5E                  	LD	E, (HL)
     426/     136 : 23                  	INC	HL
     427/     137 : 56                  	LD	D, (HL)	; DE : jump address
     428/     138 : 7A                  	LD	A, D
     429/     139 : B3                  	OR	E	; address check
     430/     13A : 28 C2               	JR	Z,ERR	; jump address NULL
     431/     13C : EB                  	EX	DE, HL
     432/     13D : E9                  	JP	(HL)	; lanch append program
     433/     13E :                     	
     434/     13E :                     	; List out append program
     435/     13E :                     LST_PRG:
     436/     13E :                     	; get address to DE
     437/     13E : 21 5C 01            	LD	HL, ApendTBL
     438/     141 :                     
     439/     141 :                     LST_PRG1:
     440/     141 : 5E                  	LD	E, (HL)
     441/     142 : 23                  	INC	HL
     442/     143 : 56                  	LD	D, (HL)
     443/     144 : 23                  	INC	HL
     444/     145 :                     
     445/     145 : D5                  	PUSH	DE
     446/     146 : DD E1               	POP	IX	; IX <-DE
     447/     148 : DD 7E 00            	LD	A, (IX+0)
     448/     14B : DD B6 01            	OR	(IX+1)
     449/     14E : 28 09               	JR	Z, LST_END
     450/     150 : 13                  	INC	DE
     451/     151 : 13                  	INC	DE	; get string address
     452/     152 :                     	
     453/     152 : EB                  	EX	DE, HL
     454/     153 : CD 48 17            	CALL	STROUT
     455/     156 : EB                  	EX	DE, HL
     456/     157 : 18 E8               	JR	LST_PRG1
     457/     159 :                     
     458/     159 :                     LST_END:
     459/     159 : C3 BE 00            	JP	WSTART
     460/     15C :                     	
     461/     15C :                     ; Append program launch table
     462/     15C :                     ;
     463/     15C :                     ApendTBL:
     464/     15C : 7C 01               	dw	lanch1
     465/     15E : 98 01               	dw	lanch2
     466/     160 : B4 01               	dw	lanch3
     467/     162 : B4 01               	dw	lanch4
     468/     164 : B4 01               	dw	lanch5
     469/     166 : B4 01               	dw	lanch6
     470/     168 : B4 01               	dw	lanch7
     471/     16A : B4 01               	dw	lanch8
     472/     16C : B4 01               	dw	lanch9
     473/     16E : B4 01               	dw	lanch10
     474/     170 : B4 01               	dw	lanch11
     475/     172 : B4 01               	dw	lanch12
     476/     174 : B4 01               	dw	lanch13
     477/     176 : B4 01               	dw	lanch14
     478/     178 : B4 01               	dw	lanch15
     479/     17A : B4 01               	dw	lanch16
     480/     17C :                     	
     481/     17C :                     lanch1:
     482/     17C : 00 20               	dw	BASIC_CST
     483/     17E : 31 2E 20 42 41 53   	DB	"1. BASIC4.7b Cold Start",CR,LF,00H
              184 : 49 43 34 2E 37 62 
              18A : 20 43 6F 6C 64 20 
              190 : 53 74 61 72 74 0D 
              196 : 0A 00             
     484/     198 :                     lanch2:
     485/     198 : 03 20               	dw	BASIC_WST
     486/     19A : 32 2E 20 42 41 53   	DB	"2. BASIC4.7b Warm Start",CR,LF,00H
              1A0 : 49 43 34 2E 37 62 
              1A6 : 20 57 61 72 6D 20 
              1AC : 53 74 61 72 74 0D 
              1B2 : 0A 00             
     487/     1B4 :                     
     488/     1B4 :                     lanch3:
     489/     1B4 :                     lanch4:
     490/     1B4 :                     lanch5:
     491/     1B4 :                     lanch6:
     492/     1B4 :                     lanch7:
     493/     1B4 :                     lanch8:
     494/     1B4 :                     lanch9:
     495/     1B4 :                     lanch10:
     496/     1B4 :                     lanch11:
     497/     1B4 :                     lanch12:
     498/     1B4 :                     lanch13:
     499/     1B4 :                     lanch14:
     500/     1B4 :                     lanch15:
     501/     1B4 :                     lanch16:
     502/     1B4 : 00 00               	dw	0
     503/     1B6 :                     
     504/     1B6 :                     	; get number
     505/     1B6 :                     	; input HL : string buffer
     506/     1B6 :                     	;
     507/     1B6 :                     	; Return
     508/     1B6 :                     	; CF =1 : Error
     509/     1B6 :                     	; BC: Calculation result
     510/     1B6 :                     
     511/     1B6 :                     GET_NUM:
     512/     1B6 : AF                  	XOR	A		; Initialize C
     513/     1B7 : 47                  	LD	B, A
     514/     1B8 : 4F                  	LD	C, A		; clear BC
     515/     1B9 :                     	
     516/     1B9 :                     GET_NUM0:
     517/     1B9 : CD 02 18            	CALL	SKIPSP		; A <- next char
     518/     1BC :                     ;	CALL	UPPER
     519/     1BC : B7                  	OR	A
     520/     1BD : C8                  	RET	Z		; ZF=1, ok! buffer end
     521/     1BE :                     
     522/     1BE : CD D4 01            	CALL	GET_BI
     523/     1C1 : D8                  	RET	C
     524/     1C2 :                     
     525/     1C2 : F5                  	push	af
     526/     1C3 : 08                  	EX	AF, AF'		;'AF <> AF: save A
     527/     1C4 : F1                  	pop	af
     528/     1C5 : CD E3 01            	CALL	MUL_10		; BC = BC * 10
     529/     1C8 : D8                  	RET	C		; overflow error
     530/     1C9 : 08                  	EX	AF, AF'		;'AF <> AF: restor A
     531/     1CA :                     
     532/     1CA : 16 00               	ld	d, 0
     533/     1CC : 5F                  	ld	e, a
     534/     1CD : CD FA 01            	CALL	BC_PLUS_DE	; BC = BC + A
     535/     1D0 : D8                  	RET	C		; overflow error
     536/     1D1 :                     				; result: BC = BC * 10 + A
     537/     1D1 : 23                  	INC	HL
     538/     1D2 : 18 E5               	JR	GET_NUM0
     539/     1D4 :                     ;
     540/     1D4 :                     ; Make binary to A
     541/     1D4 :                     ; ERROR if CF=1
     542/     1D4 :                     ;
     543/     1D4 :                     GET_BI:
     544/     1D4 : B7                  	OR	A
     545/     1D5 : 28 0A               	JR	Z, UP_BI
     546/     1D7 : FE 30               	CP	'0'
     547/     1D9 : D8                  	RET	C
     548/     1DA :                     	
     549/     1DA : FE 3A               	CP	'9'+1	; ASCII':'
     550/     1DC : 30 03               	JR	NC, UP_BI
     551/     1DE : D6 30               	SUB	'0'	; Make binary to A
     552/     1E0 : C9                  	RET
     553/     1E1 :                     
     554/     1E1 :                     UP_BI:
     555/     1E1 : 37                  	SCF		; Set CF
     556/     1E2 : C9                  	RET
     557/     1E3 :                     
     558/     1E3 :                     ;
     559/     1E3 :                     ; multiply by 10
     560/     1E3 :                     ; BC = BC * 10
     561/     1E3 :                     MUL_10:
     562/     1E3 : C5                  	push	bc
     563/     1E4 : CB 21               	SLA	C
     564/     1E6 : CB 10               	RL	B		; 2BC
     565/     1E8 : CB 21               	SLA	C
     566/     1EA : CB 10               	RL	B		; 4BC
     567/     1EC : CB 21               	SLA	C
     568/     1EE : CB 10               	RL	B		; 8BC
     569/     1F0 : D1                  	pop	de		; de = bc
     570/     1F1 : D8                  	ret	c
     571/     1F2 : CD FA 01            	CALL	BC_PLUS_DE	; 9BC
     572/     1F5 : D8                  	ret	c
     573/     1F6 : CD FA 01            	CALL	BC_PLUS_DE	; 10BC
     574/     1F9 : C9                  	RET			; result : BC = BC * 10
     575/     1FA :                     ;
     576/     1FA :                     ; BC = BC + DE
     577/     1FA :                     BC_PLUS_DE:
     578/     1FA : E5                  	push	hl
     579/     1FB :                     
     580/     1FB : D5                  	push	de
     581/     1FC : E1                  	pop	hl
     582/     1FD :                     
     583/     1FD : 09                  	add	hl, bc
     584/     1FE :                     
     585/     1FE : E5                  	push	hl
     586/     1FF : C1                  	pop	bc
     587/     200 :                     
     588/     200 : E1                  	pop	hl
     589/     201 : C9                  	RET
     590/     202 :                     
     591/     202 :                     ;
     592/     202 :                     ; list break point
     593/     202 :                     ;
     594/     202 :                     b_list:
     595/     202 : 3A 65 EF            	ld	a, (bpt1_f)
     596/     205 : B7                  	or	a
     597/     206 : 28 08               	jr	z, b_list1
     598/     208 :                     
     599/     208 : 2A 67 EF            	ld	hl, (bpt1_adr)
     600/     20B : 3E 31               	ld	a, '1'
     601/     20D : CD BD 02            	call	b_msg_out
     602/     210 :                     
     603/     210 :                     b_list1:
     604/     210 : 3A 69 EF            	ld	a, (bpt2_f)
     605/     213 : B7                  	or	a
     606/     214 : CA BE 00            	jp	z, WSTART
     607/     217 :                     
     608/     217 : 2A 6B EF            	ld	hl, (bpt2_adr)
     609/     21A : 3E 32               	ld	a, '2'
     610/     21C : CD BD 02            	call	b_msg_out
     611/     21F : C3 BE 00            	JP	WSTART
     612/     222 :                     
     613/     222 :                     
     614/     222 :                     ;;; 
     615/     222 :                     ;;; break point command
     616/     222 :                     ;;; 
     617/     222 :                     brk_cmd:
     618/     222 : 23                  	INC	HL
     619/     223 : CD 02 18            	CALL	SKIPSP		; A <- next char
     620/     226 :                     ;	CALL	UPPER
     621/     226 : B7                  	OR	A
     622/     227 : 28 D9               	JR	Z,b_list	; only type "B"
     623/     229 :                     
     624/     229 : 01 65 EF            	ld	bc, bpt1_f
     625/     22C : FE 31               	cp	'1'
     626/     22E : 28 0E               	jr	z, set_bp1
     627/     230 :                     
     628/     230 : 01 69 EF            	ld	bc, bpt2_f
     629/     233 : FE 32               	cp	'2'
     630/     235 : 28 07               	jr	z, set_bp1
     631/     237 :                     
     632/     237 : FE 43               	cp	'C'	;clear?
     633/     239 : 28 3E               	jr	z, bp_clr
     634/     23B : C3 FE 00            	jp	ERR
     635/     23E :                     
     636/     23E :                     set_bp1:
     637/     23E : 08                  	EX	AF, AF'
     638/     23F :                     
     639/     23F : 23                  	INC	HL
     640/     240 : CD 02 18            	CALL	SKIPSP		; A <- next char
     641/     243 :                     ;	CALL	UPPER
     642/     243 : B7                  	OR	A
     643/     244 : 28 5A               	JR	Z, bp_LOT 	;; No address input -> list out
     644/     246 : FE 2C               	cp	','
     645/     248 : C2 FE 00            	jp	nz, ERR
     646/     24B :                     
     647/     24B : 23                  	INC	HL
     648/     24C : CD 02 18            	CALL	SKIPSP
     649/     24F : C5                  	push	bc
     650/     250 : CD 12 18            	CALL	RDHEX		; 1st arg.
     651/     253 : E1                  	pop	hl		; hl <- bc
     652/     254 : DA FE 00            	jp	c, ERR
     653/     257 :                     
     654/     257 : CD 60 02            	call	setbpadr
     655/     25A : DA FE 00            	jp	c, ERR
     656/     25D : C3 BE 00            	JP	WSTART
     657/     260 :                     
     658/     260 :                     
     659/     260 :                     ; hl : point of bp flag( bpt1_f or bpt2_f)
     660/     260 :                     ; de : break point address
     661/     260 :                     
     662/     260 :                     ; check ram area, and set berak point
     663/     260 :                     ; 
     664/     260 :                     setbpadr:
     665/     260 : 7A                  	ld	a, d
     666/     261 : FE C0               	cp	RAM_B >> 8	; a - 0C0H
     667/     263 : DA 77 02            	jp	c, chkERR	; ROM area
     668/     266 : FE F0               	cp	IO_B >> 8	; a - 0F0H
     669/     268 : D2 77 02            	jp	nc, chkERR	; I/O area
     670/     26B : 3E 01               	ld	a,1
     671/     26D : 77                  	ld	(hl), a	; set flag
     672/     26E : 23                  	inc	hl
     673/     26F : 1A                  	ld	a, (de)		; get opcode
     674/     270 : 77                  	ld	(hl), a		; save opcode
     675/     271 : 23                  	inc	hl
     676/     272 : 73                  	ld	(hl), e ; set break point low address
     677/     273 : 23                  	inc	hl
     678/     274 : 72                  	ld	(hl), d ; set break point high address
     679/     275 : B7                  	or	a	; reset carry
     680/     276 : C9                  	ret
     681/     277 :                     
     682/     277 :                     chkERR:
     683/     277 : 37                  	scf	;set carry
     684/     278 : C9                  	ret
     685/     279 :                     
     686/     279 :                     ; clear break point
     687/     279 :                     
     688/     279 :                     bp_clr:
     689/     279 : 23                  	INC	HL
     690/     27A : CD 02 18            	CALL	SKIPSP		; A <- next char
     691/     27D :                     ;	CALL	UPPER
     692/     27D : B7                  	OR	A
     693/     27E : 28 14               	JR	Z,b_aclr	; all clear
     694/     280 :                     
     695/     280 : 01 65 EF            	ld	bc, bpt1_f
     696/     283 : FE 31               	cp	'1'
     697/     285 : 28 08               	jr	z, bp_clr1
     698/     287 :                     
     699/     287 : 01 69 EF            	ld	bc, bpt2_f
     700/     28A : FE 32               	cp	'2'
     701/     28C : C2 FE 00            	jp	nz, ERR
     702/     28F :                     
     703/     28F :                     bp_clr1:
     704/     28F : AF                  	xor	a
     705/     290 : 02                  	ld	(bc), a
     706/     291 : C3 BE 00            	JP	WSTART
     707/     294 :                     
     708/     294 :                     b_aclr:
     709/     294 : AF                  	xor	a
     710/     295 : 01 65 EF            	ld	bc, bpt1_f
     711/     298 : 02                  	ld	(bc), a
     712/     299 : 01 69 EF            	ld	bc, bpt2_f
     713/     29C : 02                  	ld	(bc), a
     714/     29D : C3 BE 00            	JP	WSTART
     715/     2A0 :                     
     716/     2A0 :                     ; when no address input. list out BP
     717/     2A0 :                     ;
     718/     2A0 :                     ; bc : break pointer buffer offset
     719/     2A0 :                     bp_LOT:
     720/     2A0 : 0A                  	ld	a, (bc)		; set break point?
     721/     2A1 : B7                  	or	a
     722/     2A2 : CA BE 00            	jp	z, WSTART	; no break point setting
     723/     2A5 :                     
     724/     2A5 : 08                  	EX	AF, AF'
     725/     2A6 : 2A 67 EF            	ld	hl, (bpt1_adr)
     726/     2A9 : FE 31               	cp	'1'
     727/     2AB : 28 03               	jr	z, l_b2
     728/     2AD : 2A 6B EF            	ld	hl, (bpt2_adr)
     729/     2B0 :                     l_b2:
     730/     2B0 : CD BD 02            	call	b_msg_out
     731/     2B3 : C3 BE 00            	JP	WSTART
     732/     2B6 :                     
     733/     2B6 : 42 50 28 00         bp_msg1:	db	"BP(",00H
     734/     2BA : 29 3A 00            bp_msg2:	db	"):",00H
     735/     2BD :                     
     736/     2BD :                     b_msg_out:
     737/     2BD : E5                  	push	hl
     738/     2BE : F5                  	push	af
     739/     2BF : 21 B6 02            	ld	hl, bp_msg1
     740/     2C2 : CD 48 17            	call	STROUT
     741/     2C5 : F1                  	pop	af
     742/     2C6 : CD B8 1F            	call	CONOUT
     743/     2C9 : 21 BA 02            	ld	hl, bp_msg2
     744/     2CC : CD 48 17            	call	STROUT
     745/     2CF : E1                  	pop	hl
     746/     2D0 : CD 51 17            	call	HEXOUT4
     747/     2D3 : CD 91 17            	call	CRLF	
     748/     2D6 : C9                  	ret
     749/     2D7 :                     
     750/     2D7 :                     ;;; 
     751/     2D7 :                     ;;; trace command
     752/     2D7 :                     ;;; 
     753/     2D7 :                     trace_cmd:
     754/     2D7 :                     
     755/     2D7 :                     ; T[address][,step数]
     756/     2D7 :                     ; TP[ON | OFF]
     757/     2D7 :                     ; TM[I | S]
     758/     2D7 :                     
     759/     2D7 :                     ; init steps
     760/     2D7 : E5                  	push	hl
     761/     2D8 : 2E 00               	ld	l, 0
     762/     2DA : 26 00               	ld	h, 0
     763/     2DC : 22 58 EF            	ld	(TC_cnt), hl	; clear trace step counter to 0
     764/     2DF : 2A 42 EF            	ld	hl,(REGPC)
     765/     2E2 : 22 5A EF            	ld	(tmpT), hl	; init temp address
     766/     2E5 : AF                  	xor	a
     767/     2E6 : 32 5C EF            	ld	(fever_t), a	; clear flag trace forever
     768/     2E9 :                     
     769/     2E9 : E1                  	pop	hl
     770/     2EA : 23                  	inc	hl
     771/     2EB : CD 02 18            	CALL	SKIPSP
     772/     2EE : CD 12 18            	CALL	RDHEX		; 1st arg.
     773/     2F1 : D2 9D 03            	jp	nc, tadr_chk
     774/     2F4 : CD 02 18            	CALL	SKIPSP
     775/     2F7 : 7E                  	ld	a, (hl)
     776/     2F8 : B7                  	or	a
     777/     2F9 : CA C6 03            	Jp	z, t_op1	; only 1 step trace, check opcode
     778/     2FC : FE 2C               	cp	','
     779/     2FE : CA AE 03            	jp	z, stp_chk	; steps check
     780/     301 :                     
     781/     301 :                     ;	CALL	UPPER
     782/     301 : FE 50               	cp	'P'
     783/     303 : 28 4E               	jr	z, tp_cmd
     784/     305 : FE 4D               	cp	'M'
     785/     307 : C2 FE 00            	jp	nz, ERR
     786/     30A :                     	
     787/     30A :                     	; tm_cmd
     788/     30A :                     	
     789/     30A : 23                  	inc	hl
     790/     30B : CD 02 18            	CALL	SKIPSP		; A <- next char
     791/     30E :                     ;	CALL	UPPER
     792/     30E :                     dip_TM:
     793/     30E : 21 45 03            	ld	hl, tm_msg_i
     794/     311 : FE 49               	cp	'I'
     795/     313 : 28 10               	jr	z, set_TM
     796/     315 : 21 4B 03            	ld	hl, tm_msg_s
     797/     318 : FE 53               	cp	'S'
     798/     31A : 28 09               	jr	z, set_TM
     799/     31C : B7                  	or	a
     800/     31D : C2 FE 00            	jp	nz, ERR
     801/     320 :                     
     802/     320 :                     ;display T mode
     803/     320 : 3A 57 EF            	ld	a, (TM_mode)
     804/     323 : 18 E9               	jr	dip_TM
     805/     325 :                     
     806/     325 :                     ;set TM mode and display
     807/     325 :                     set_TM:
     808/     325 : 32 57 EF            	ld	(TM_mode),a
     809/     328 : E5                  	push	hl
     810/     329 : 21 36 03            	ld	hl, tm_msg_0
     811/     32C : CD 48 17            	call	STROUT
     812/     32F : E1                  	pop	hl
     813/     330 : CD 48 17            	call	STROUT
     814/     333 : C3 BE 00            	jp	WSTART
     815/     336 :                     
     816/     336 :                     tm_msg_0:
     817/     336 : 54 4D 20 6D 6F 64   	db	"TM mode:<CALL ", 00h
              33C : 65 3A 3C 43 41 4C 
              342 : 4C 20 00          
     818/     345 :                     tm_msg_i:
     819/     345 : 49 4E 3E 0D 0A 00   	db	"IN>", CR, LF, 00h
     820/     34B :                     tm_msg_s:
     821/     34B : 53 4B 49 50 3E 0D   	db	"SKIP>", CR, LF, 00h
              351 : 0A 00             
     822/     353 :                     	
     823/     353 :                     	
     824/     353 :                     	; tp_cmd
     825/     353 :                     tp_cmd:	
     826/     353 : 23                  	inc	hl
     827/     354 : CD 02 18            	CALL	SKIPSP		; A <- next char
     828/     357 :                     ;	CALL	UPPER
     829/     357 : B7                  	or	a
     830/     358 : 20 05               	jr	nz, tp_n1
     831/     35A : 3A 56 EF            	ld	a, (TP_mode)
     832/     35D : 18 09               	jr	tp_n2
     833/     35F :                     	
     834/     35F :                     tp_n1:
     835/     35F : FE 4F               	cp	'O'
     836/     361 : C2 FE 00            	jp	nz, ERR
     837/     364 : 23                  	inc	hl
     838/     365 : CD 02 18            	CALL	SKIPSP		; A <- next char
     839/     368 :                     ;	CALL	UPPER
     840/     368 :                     
     841/     368 :                     tp_n2:
     842/     368 : 21 92 03            	ld	hl, tp_msg_on
     843/     36B : FE 4E               	cp	'N'
     844/     36D : 28 08               	jr	z, tp_md_on
     845/     36F :                     
     846/     36F : 21 97 03            	ld	hl, tp_msg_off
     847/     372 : FE 46               	cp	'F'
     848/     374 : C2 FE 00            	jp	nz, ERR
     849/     377 :                     
     850/     377 :                     tp_md_on:
     851/     377 :                     	; set trace mode and display mode
     852/     377 : 32 56 EF            	ld	(TP_mode), a
     853/     37A : E5                  	push	hl
     854/     37B : 21 88 03            	ld	hl, tp_msg_0
     855/     37E : CD 48 17            	call	STROUT
     856/     381 : E1                  	pop	hl
     857/     382 : CD 48 17            	call	STROUT
     858/     385 : C3 BE 00            	jp	WSTART
     859/     388 :                     	
     860/     388 :                     tp_msg_0:
     861/     388 : 54 50 20 6D 6F 64   	db	"TP mode: ", 00h
              38E : 65 3A 20 00       
     862/     392 :                     tp_msg_on:
     863/     392 : 4F 4E 0D 0A 00      	db	"ON", CR, LF, 00h
     864/     397 :                     tp_msg_off:
     865/     397 : 4F 46 46 0D 0A 00   	db	"OFF", CR, LF, 00h
     866/     39D :                     
     867/     39D :                     tadr_chk:
     868/     39D : ED 53 5A EF         	ld	(tmpT), de	; set start address
     869/     3A1 : CD 02 18            	CALL	SKIPSP		; A <- next char
     870/     3A4 : B7                  	or	a
     871/     3A5 : 28 1F               	jr	z, t_op1	; 1step trace
     872/     3A7 : FE 2C               	cp	','
     873/     3A9 : 28 03               	jr	z, stp_chk
     874/     3AB : C3 FE 00            	jp	ERR
     875/     3AE :                     
     876/     3AE :                     stp_chk:
     877/     3AE : 23                  	inc	hl
     878/     3AF : CD 02 18            	CALL	SKIPSP		; A <- next char
     879/     3B2 : B7                  	or	a
     880/     3B3 : CA FE 00            	jp	z, ERR
     881/     3B6 : FE 2D               	cp	'-'
     882/     3B8 : 28 11               	jr	z, chk_fevre
     883/     3BA :                     
     884/     3BA :                     ; check steps
     885/     3BA :                     
     886/     3BA : CD B6 01            	call	GET_NUM		; get steps to BC
     887/     3BD : DA FE 00            	JP	C, ERR		; number error
     888/     3C0 :                     
     889/     3C0 :                     t_op11:
     890/     3C0 : ED 43 58 EF         	ld	(TC_cnt), bc	; set trace step counter
     891/     3C4 : 18 1B               	jr	t_op_chk
     892/     3C6 :                     
     893/     3C6 :                     t_op1:
     894/     3C6 : 01 01 00            	ld	bc, 1
     895/     3C9 : 18 F5               	jr	t_op11
     896/     3CB :                     
     897/     3CB :                     chk_fevre:
     898/     3CB : 23                  	inc	hl
     899/     3CC : CD 02 18            	CALL	SKIPSP		; A <- next char
     900/     3CF : FE 31               	cp	'1'
     901/     3D1 : C2 FE 00            	jp	nz, ERR
     902/     3D4 : 23                  	inc	hl
     903/     3D5 : CD 02 18            	CALL	SKIPSP		; A <- next char
     904/     3D8 : B7                  	or	a
     905/     3D9 : C2 FE 00            	jp	nz, ERR		; not "-1" then error
     906/     3DC : 3E 01               	ld	a, 1
     907/     3DE : 32 5C EF            	ld	(fever_t), a	; set flag trace forever
     908/     3E1 :                     
     909/     3E1 :                     t_op_chk:
     910/     3E1 : 2A 5A EF            	ld	hl, (tmpT)	; get PC address
     911/     3E4 : 7E                  	ld	a, (hl)		; get opcode
     912/     3E5 :                     	
     913/     3E5 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     914/     3E5 :                     ;;;
     915/     3E5 :                     ;;; branch opecode check
     916/     3E5 :                     ;;;
     917/     3E5 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     918/     3E5 :                     
     919/     3E5 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     920/     3E5 :                     ; 2 insertion Trace code(TC) 
     921/     3E5 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     922/     3E5 :                     INSTC2:
     923/     3E5 :                     	; check 1 byte machine code: branch (RET CC)
     924/     3E5 :                     
     925/     3E5 : 01 08 00            	ld	bc, RETCC_TBLE - RETCC_TBLS
     926/     3E8 : 21 7E 05            	ld	hl, RETCC_TBLS
     927/     3EB : ED B1               	cpir
     928/     3ED : 20 13               	jr	nz, next_bc1	; not RET CC
     929/     3EF :                     
     930/     3EF :                     	; RET CC
     931/     3EF :                     	; trace operation:
     932/     3EF :                     	;   1. ea = *REGSP; *ea = TC;
     933/     3EF :                     	;   2. ea = *REGPC; *(ea+1) = TC;
     934/     3EF :                     
     935/     3EF :                     	; 1
     936/     3EF : 0E 01               	ld	c, 1		; first TC point
     937/     3F1 : CD 47 05            	call	insBRK_sp
     938/     3F4 : DA 06 05            	jp	c, err_trace_seq
     939/     3F7 :                     	
     940/     3F7 :                     	; 2
     941/     3F7 : 0E 02               	ld	c, 2		; second TC point
     942/     3F9 : CD 27 05            	call	insBRK_1op
     943/     3FC : DA 06 05            	jp	c, err_trace_seq
     944/     3FF :                     
     945/     3FF : C3 03 05            	jp	END_INS_TC
     946/     402 :                     
     947/     402 :                     	; check 2 byte machine code: branch (JR CC, Relative Value)
     948/     402 :                     next_bc1:
     949/     402 :                     
     950/     402 : 01 05 00            	ld	bc, JRCC_TBLE - JRCC_TBLS
     951/     405 : 21 86 05            	ld	hl, JRCC_TBLS
     952/     408 : ED B1               	cpir
     953/     40A : 20 19               	jr	nz, next_bc2	; not JR CC
     954/     40C :                     
     955/     40C :                     	; JR CC, nn
     956/     40C :                     	; trace operation:
     957/     40C :                     	;   1. ea = *REGPC; *(ea + 2 + *(ea+1)) = TC;
     958/     40C :                     	;   2. ea = *REGPC; *(ea+2) = TC;
     959/     40C :                     
     960/     40C :                     	; 1
     961/     40C : 0E 01               	ld	c, 1		; first TC point
     962/     40E : 2A 5A EF            	ld	hl, (tmpT)
     963/     411 : CD 1A 05            	call	Rel_adr_c
     964/     414 : CD 54 05            	call	inadr_chk_and_wrt
     965/     417 : DA 06 05            	jp	c, err_trace_seq
     966/     41A :                     
     967/     41A :                     	; 2
     968/     41A : 0E 02               	ld	c, 2		; second TC point
     969/     41C : CD 2C 05            	call	insBRK_2op
     970/     41F : DA 06 05            	jp	c, err_trace_seq
     971/     422 :                     
     972/     422 : C3 03 05            	jp	END_INS_TC
     973/     425 :                     
     974/     425 :                     	; check 3 byte machine code: branch JP CC, nnnn 16bit literal)
     975/     425 :                     
     976/     425 :                     next_bc2:
     977/     425 : 01 08 00            	ld	bc, JPCC_TBLE - JPCC_TBLS
     978/     428 : 21 8B 05            	ld	hl, JPCC_TBLS
     979/     42B : ED B1               	cpir
     980/     42D : 20 04               	jr	nz, next_bc21		; not JP CCC
     981/     42F :                     
     982/     42F :                     	; JP CC, nnnn
     983/     42F :                     	; trace operation:
     984/     42F :                     	;   1. ea = *REGPC; *((short *)(ea+1)) = TC;
     985/     42F :                     	;   2. ea = *REGPC; *(ea+3) = TC;
     986/     42F :                     
     987/     42F : 0E 01               	ld	c, 1		; first TC point
     988/     431 : 18 13               	jr	next_bc222
     989/     433 :                     
     990/     433 :                     	; check 3 byte machine code: branch (CALL CC, nnnn 16bit literal)
     991/     433 :                     
     992/     433 :                     next_bc21:
     993/     433 : 01 08 00            	ld	bc, CLCC_TBLE - CLCC_TBLS
     994/     436 : 21 93 05            	ld	hl, CLCC_TBLS
     995/     439 : ED B1               	cpir
     996/     43B : 20 1A               	jr	nz, INSTC1		; not CALL CCC
     997/     43D :                     
     998/     43D :                     	; CALL CC, nnnn
     999/     43D :                     	; trace operation:
    1000/     43D :                     	; TM_mode = 'I'
    1001/     43D :                     	;   1. ea = *REGPC; *((short *)(ea+1)) = TC;
    1002/     43D :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1003/     43D :                     	;
    1004/     43D :                     	; TM_mode = 'S'
    1005/     43D :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1006/     43D :                     
    1007/     43D : 0E 01               	ld	c, 1		; first TC point
    1008/     43F : 3A 57 EF            	ld	a, (TM_mode)
    1009/     442 : FE 53               	cp	'S'
    1010/     444 : 28 08               	jr	z, next_bc22	; skip insertion 1.
    1011/     446 :                     
    1012/     446 :                     next_bc222:
    1013/     446 :                     	; 1. ea = *REGPC; *((char *)(ea+1)) = TC;
    1014/     446 : CD 3B 05            	call	insBRK_brp
    1015/     449 : DA 06 05            	jp	c, err_trace_seq
    1016/     44C :                     	
    1017/     44C :                     next_bc221:
    1018/     44C :                     	; 2. ea = *REGPC; *(ea+3) = TC;
    1019/     44C : 0E 02               	ld	c, 2		; second TC point
    1020/     44E :                     next_bc22:
    1021/     44E : CD 31 05            	call	insBRK_3op
    1022/     451 : DA 06 05            	jp	c, err_trace_seq
    1023/     454 :                     
    1024/     454 : C3 03 05            	jp	END_INS_TC
    1025/     457 :                     
    1026/     457 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1027/     457 :                     ; 1 insertion Trace code(TC) 
    1028/     457 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1029/     457 :                     INSTC1:
    1030/     457 :                     	; check 1 byte machine code: branch (return)
    1031/     457 : FE C9               	cp	0C9H		; RET ?
    1032/     459 : 20 0B               	jr	nz, next_bc3	; not RET
    1033/     45B :                     
    1034/     45B :                     	; RET
    1035/     45B :                     	; trace operation:
    1036/     45B :                     	;   ea = *REGSP; *ea = TC;
    1037/     45B : 0E 01               	ld	c, 1		; first TC point
    1038/     45D : CD 47 05            	call	insBRK_sp
    1039/     460 : DA 06 05            	jp	c, err_trace_seq
    1040/     463 : C3 03 05            	jp	END_INS_TC
    1041/     466 :                     
    1042/     466 :                     	; check RST p
    1043/     466 :                     next_bc3:
    1044/     466 : 01 08 00            	ld	bc, RST_TBLE - RST_TBLS
    1045/     469 : 21 9B 05            	ld	hl, RST_TBLS
    1046/     46C : ED B1               	cpir
    1047/     46E : 20 0B               	jr	nz, next_bc4		; not RST p
    1048/     470 :                     
    1049/     470 :                     	; RST p
    1050/     470 :                     	; can't trace: skip trace
    1051/     470 :                     	; trace operation:
    1052/     470 :                     	;   ea = *REGPC; *(ea+1) = TC;
    1053/     470 :                     ;	ld	hl, RST_DMSG
    1054/     470 :                     ;	call	STROUT		; message out "DETECT RST OPCODE"
    1055/     470 : 0E 01               	ld	c, 1		; first TC point
    1056/     472 : CD 27 05            	call	insBRK_1op
    1057/     475 : DA 06 05            	jp	c, err_trace_seq
    1058/     478 :                     	
    1059/     478 : C3 03 05            	jp	END_INS_TC
    1060/     47B :                     
    1061/     47B :                     ;RST_DMSG:
    1062/     47B :                     ;	db	"(RST nn) WILL BE SKIPPED. AND TRACE NEXT OPCODE", CR, LF,00
    1063/     47B :                     
    1064/     47B :                     	; check code 0EDH
    1065/     47B :                     next_bc4:
    1066/     47B : FE ED               	cp	0EDH		; CODE 0EDH ?
    1067/     47D : 20 13               	jr	nz, next_bc5	; not 0EDH
    1068/     47F :                     
    1069/     47F : 23                  	inc	hl
    1070/     480 : 7E                  	ld	a, (hl)
    1071/     481 : FE 45               	cp	45H		; RETN?
    1072/     483 : 28 04               	jr	z, next_bc6	; yes, RETN
    1073/     485 : FE 4D               	cp	4DH		; RETI?
    1074/     487 : 20 09               	jr	nz, next_bc5	; not RETN
    1075/     489 :                     
    1076/     489 :                     	; trace operation:
    1077/     489 :                     	;   ea = *REGSP; *ea = TC;
    1078/     489 :                     next_bc6:
    1079/     489 : 0E 01               	ld	c, 1		; first TC point
    1080/     48B : CD 47 05            	call	insBRK_sp
    1081/     48E : 38 76               	jr	c, err_trace_seq
    1082/     490 : 18 71               	jr	END_INS_TC
    1083/     492 :                     
    1084/     492 :                     	; check JP (HL)
    1085/     492 :                     next_bc5:
    1086/     492 : 2A 5A EF            	ld	hl, (tmpT)
    1087/     495 : 7E                  	ld	a, (hl)
    1088/     496 :                     
    1089/     496 : FE E9               	cp	0E9H		; JP (HL) ?
    1090/     498 : 20 0C               	jr	nz, next_bc7	; not JP (HL)
    1091/     49A :                     
    1092/     49A :                     	; JP (HL)
    1093/     49A :                     	; trace operation:
    1094/     49A :                     	;   ea = *REGHL; *ea = TC;
    1095/     49A : 2A 32 EF            	ld	hl, (REGHL)
    1096/     49D :                     jphl:
    1097/     49D : 0E 01               	ld	c, 1		; first TC point
    1098/     49F : CD 54 05            	call	inadr_chk_and_wrt
    1099/     4A2 : 38 62               	jr	c, err_trace_seq
    1100/     4A4 : 18 5D               	jr	END_INS_TC
    1101/     4A6 :                     
    1102/     4A6 :                     	; check JP (IX)
    1103/     4A6 :                     next_bc7:
    1104/     4A6 : FE DD               	cp	0DDH		; 1st OPOCDE 0DDH ?
    1105/     4A8 : 20 0B               	jr	nz, next_bc8	; no 0DDH
    1106/     4AA : 23                  	inc	hl
    1107/     4AB : 7E                  	ld	a, (hl)
    1108/     4AC : FE E9               	cp	0E9H		; JP (IX) ?
    1109/     4AE : 20 05               	jr	nz, next_bc8	; not JP (IX)
    1110/     4B0 :                     
    1111/     4B0 :                     	; JP (IX)
    1112/     4B0 :                     	; trace operation:
    1113/     4B0 :                     	;   ea = *REGIX; *ea = TC;
    1114/     4B0 : 2A 3C EF            	ld	hl, (REGIX)
    1115/     4B3 : 18 E8               	jr	jphl
    1116/     4B5 :                     
    1117/     4B5 :                     	; check JP (IY)
    1118/     4B5 :                     next_bc8:
    1119/     4B5 : 2A 5A EF            	ld	hl, (tmpT)
    1120/     4B8 : 7E                  	ld	a, (hl)
    1121/     4B9 :                     
    1122/     4B9 : FE FD               	cp	0FDH		; 1st OPOCDE 0FDH ?
    1123/     4BB : 20 0B               	jr	nz, next_bc9	; no 0FDH
    1124/     4BD : 23                  	inc	hl
    1125/     4BE : 7E                  	ld	a, (hl)
    1126/     4BF : FE E9               	cp	0E9H		; JP (IX) ?
    1127/     4C1 : 20 05               	jr	nz, next_bc9	; not JP (IX)
    1128/     4C3 :                     
    1129/     4C3 :                     	; JP (IY)
    1130/     4C3 :                     	; trace operation:
    1131/     4C3 :                     	;   ea = *REGIY; *ea = TC;
    1132/     4C3 : 2A 3E EF            	ld	hl, (REGIY)
    1133/     4C6 : 18 D5               	jr	jphl
    1134/     4C8 :                     
    1135/     4C8 :                     	; check JR relative
    1136/     4C8 :                     next_bc9:
    1137/     4C8 : 2A 5A EF            	ld	hl, (tmpT)
    1138/     4CB : 7E                  	ld	a, (hl)
    1139/     4CC : FE 18               	cp	18H		; JR relative ?
    1140/     4CE : 20 0C               	jr	nz, next_bc10	; not JR relative
    1141/     4D0 :                     
    1142/     4D0 :                     	; JR Relative
    1143/     4D0 :                     	; trace operation:
    1144/     4D0 :                     	;   ea = *REGPC; *(ea + 2 + *(ea+1)) = TC;
    1145/     4D0 : 0E 01               	ld	c, 1		; first TC point
    1146/     4D2 : CD 1A 05            	call	Rel_adr_c
    1147/     4D5 : CD 54 05            	call	inadr_chk_and_wrt
    1148/     4D8 : 38 2C               	jr	c, err_trace_seq
    1149/     4DA : 18 27               	jr	END_INS_TC
    1150/     4DC :                     
    1151/     4DC :                     	; check JP literal
    1152/     4DC :                     next_bc10:
    1153/     4DC : FE C3               	cp	0C3H		; JP literal ?
    1154/     4DE : 20 09               	jr	nz, next_bc11	; not JP literal
    1155/     4E0 :                     
    1156/     4E0 :                     	; JP literal
    1157/     4E0 :                     	; trace operation:
    1158/     4E0 :                     	; ea = *REGPC; *((char *)(ea+1)) = TC;
    1159/     4E0 : 0E 01               	ld	c, 1		; first TC point
    1160/     4E2 : CD 3B 05            	call	insBRK_brp
    1161/     4E5 : 38 1F               	jr	c, err_trace_seq
    1162/     4E7 : 18 1A               	jr	END_INS_TC
    1163/     4E9 :                     
    1164/     4E9 :                     	; check call literal
    1165/     4E9 :                     next_bc11:
    1166/     4E9 : FE CD               	cp	0CDH		; CALL literal ?
    1167/     4EB : C2 A3 05            	jp	nz, INS2	; no, check not branch opcode 
    1168/     4EE :                     
    1169/     4EE :                     	; CALL literal
    1170/     4EE :                     	; trace operation:
    1171/     4EE :                     	; TM_mode = 'I'
    1172/     4EE :                     	;   ea = *REGPC; *((short *)(ea+1)) = TC;
    1173/     4EE :                     	; TM_mode = 'S'
    1174/     4EE :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1175/     4EE :                     
    1176/     4EE : 0E 01               	ld	c, 1		; first TC point
    1177/     4F0 : 3A 57 EF            	ld	a, (TM_mode)
    1178/     4F3 : FE 53               	cp	'S'
    1179/     4F5 : 28 07               	jr	z, next_bc111	; yes, TM_mode='S'
    1180/     4F7 :                     
    1181/     4F7 :                     	; TM_mode = 'I'
    1182/     4F7 :                     	; ea = *REGPC; *((char *)(ea+1)) = TC;
    1183/     4F7 : CD 3B 05            	call	insBRK_brp
    1184/     4FA : 38 0A               	jr	c, err_trace_seq
    1185/     4FC : 18 05               	jr	END_INS_TC
    1186/     4FE :                     
    1187/     4FE :                     	; TM_mode = 'S'
    1188/     4FE :                     	; ea = *REGPC; *(ea+3) = TC;
    1189/     4FE :                     next_bc111:
    1190/     4FE : CD 31 05            	call	insBRK_3op
    1191/     501 : 38 03               	jr	c, err_trace_seq
    1192/     503 :                     
    1193/     503 :                     END_INS_TC:
    1194/     503 : C3 8A 13            	jp	G0	; go, trace operation
    1195/     506 :                     
    1196/     506 :                     err_trace_seq:
    1197/     506 : 21 10 05            	ld	hl, terr_msg
    1198/     509 : CD 48 17            	call	STROUT
    1199/     50C : C3 BE 00            	JP	WSTART
    1200/     50F : FF                  	rst	38h
    1201/     510 :                     ;	
    1202/     510 : 41 64 72 20 45 52   terr_msg:	db	"Adr ERR", CR, LF, 00H
              516 : 52 0D 0A 00       
    1203/     51A :                     
    1204/     51A :                     ;--------------------------------------
    1205/     51A :                     ; 2 byte machine code branch
    1206/     51A :                     ; - 2nd byte is Relative address
    1207/     51A :                     ; - input hl : opecode address
    1208/     51A :                     ; - output hl : target address
    1209/     51A :                     ;--------------------------------------
    1210/     51A :                     Rel_adr_c:
    1211/     51A : 23                  	inc	hl
    1212/     51B : 5E                  	ld	e, (hl)		; e = 2nd operand
    1213/     51C : 23                  	inc	hl		; hl = PC + 2
    1214/     51D : 16 FF               	ld	d, 0ffh
    1215/     51F : CB 7B               	bit	7, e		; test msb bit
    1216/     521 : 20 02               	jr	nz, exp_msb	; 
    1217/     523 : 16 00               	ld	d, 0
    1218/     525 :                     exp_msb:
    1219/     525 : 19                  	add	hl, de
    1220/     526 : C9                  	ret
    1221/     527 :                     
    1222/     527 :                     ;--------------------------------------
    1223/     527 :                     ; 1 byte op code, insert TC
    1224/     527 :                     ; ea = *REGPC; *(ea+1) = TC
    1225/     527 :                     ;--------------------------------------
    1226/     527 :                     insBRK_1op:
    1227/     527 :                     ;	ld	hl, (REGPC)
    1228/     527 : 2A 5A EF            	ld	hl, (tmpT)
    1229/     52A : 18 0A               	jr	ib1
    1230/     52C :                     	
    1231/     52C :                     ;--------------------------------------
    1232/     52C :                     ; 2 byte op code, insert TC
    1233/     52C :                     ; ea = *REGPC; *(ea+2) = TC
    1234/     52C :                     ;--------------------------------------
    1235/     52C :                     insBRK_2op:
    1236/     52C :                     ;	ld	hl, (REGPC)
    1237/     52C : 2A 5A EF            	ld	hl, (tmpT)
    1238/     52F : 18 04               	jr	ib2
    1239/     531 :                     	
    1240/     531 :                     ;--------------------------------------
    1241/     531 :                     ; 3 byte op code, insert TC
    1242/     531 :                     ; ea = *REGPC; *(ea+3) = TC;
    1243/     531 :                     ;--------------------------------------
    1244/     531 :                     insBRK_3op:
    1245/     531 :                     ;	ld	hl, (REGPC)
    1246/     531 : 2A 5A EF            	ld	hl, (tmpT)
    1247/     534 :                     ib3:
    1248/     534 : 23                  	inc	hl
    1249/     535 :                     ib2:
    1250/     535 : 23                  	inc	hl
    1251/     536 :                     ib1:
    1252/     536 : 23                  	inc	hl
    1253/     537 : CD 54 05            	call	inadr_chk_and_wrt
    1254/     53A : C9                  	ret
    1255/     53B :                     
    1256/     53B :                     ;--------------------------------------
    1257/     53B :                     ; 3 byte op code, insert TC in branch point
    1258/     53B :                     ; ea = *REGPC; *((char *)(ea+1)) = TC;
    1259/     53B :                     ;--------------------------------------
    1260/     53B :                     insBRK_brp:
    1261/     53B :                     ;	ld	hl, (REGPC)
    1262/     53B : 2A 5A EF            	ld	hl, (tmpT)
    1263/     53E : 23                  	inc	hl
    1264/     53F : 5E                  	ld	e, (hl)
    1265/     540 : 23                  	inc	hl
    1266/     541 : 56                  	ld	d, (hl)
    1267/     542 : EB                  	ex	de,  hl
    1268/     543 : CD 54 05            	call	inadr_chk_and_wrt
    1269/     546 : C9                  	ret
    1270/     547 :                     
    1271/     547 :                     ;--------------------------------------
    1272/     547 :                     ; insert TC at SP
    1273/     547 :                     ; ea = *REGSP; *ea = TC;
    1274/     547 :                     ;--------------------------------------
    1275/     547 :                     insBRK_sp:
    1276/     547 : ED 5B 40 EF         	ld	de, (REGSP)
    1277/     54B : 1A                  	ld	a, (de)
    1278/     54C : 6F                  	ld	l, a
    1279/     54D : 13                  	inc	de
    1280/     54E : 1A                  	ld	a, (de)
    1281/     54F : 67                  	ld	h, a		; hl = *sp
    1282/     550 : CD 54 05            	call	inadr_chk_and_wrt
    1283/     553 : C9                  	ret
    1284/     554 :                     
    1285/     554 :                     ;--------------------------------------
    1286/     554 :                     ; check (HL) is RAM AREA
    1287/     554 :                     ; insert Trace code at (HL)
    1288/     554 :                     ;--------------------------------------
    1289/     554 :                     inadr_chk_and_wrt:
    1290/     554 : 7C                  	ld	a, h
    1291/     555 :                     
    1292/     555 : =>TRUE               	IF	RAM12K
    1293/     555 : FE C0               	cp	RAM_B >> 8	; a & 0c0h
    1294/     557 : 38 23               	jr	c, NO_RAM_AREA
    1295/     559 : FE F0               	cp	IO_B >> 8
    1296/     55B : 30 1F               	jr	nc, NO_RAM_AREA
    1297/     55D : [1292]               	ENDIF
    1298/     55D :                     
    1299/     55D : =>FALSE              	IF	RAM8K
    1300/     55D :                     	cp	RAM_B >> 8		; 80H
    1301/     55D :                     	jr	c, NO_RAM_AREA
    1302/     55D :                     	cp	RAM_E >> 8		; 9FH
    1303/     55D :                     	jr	nc, NO_RAM_AREA
    1304/     55D : [1299]               	ENDIF
    1305/     55D :                     
    1306/     55D : =>FALSE              	IF	RAM4K
    1307/     55D :                     	cp	RAM_B >> 8		; 80H
    1308/     55D :                     	jr	c, NO_RAM_AREA
    1309/     55D :                     	cp	RAM_E >> 8		; 8FH
    1310/     55D :                     	jr	nc, NO_RAM_AREA
    1311/     55D : [1306]               	ENDIF
    1312/     55D :                     
    1313/     55D : 79                  	ld	a, c
    1314/     55E : FE 01               	cp	1		;first save?
    1315/     560 : 20 0D               	jr	nz, icka1
    1316/     562 : 11 5D EF            	ld	de, tpt1_f
    1317/     565 : 12                  	ld	(de), a		; set trace ON
    1318/     566 : 22 5F EF            	ld	(tpt1_adr), hl
    1319/     569 : 7E                  	ld	a, (hl)		; get opcode
    1320/     56A : 32 5E EF            	ld	(tpt1_op), a	; save opcode
    1321/     56D : 18 0B               	jr	icka_end
    1322/     56F :                     icka1:
    1323/     56F : 11 61 EF            	ld	de, tpt2_f
    1324/     572 : 12                  	ld	(de), a		; set trace ON
    1325/     573 : 22 63 EF            	ld	(tpt2_adr), hl
    1326/     576 : 7E                  	ld	a, (hl)		; get opcode
    1327/     577 : 32 62 EF            	ld	(tpt2_op), a	; save opcode
    1328/     57A :                     icka_end:
    1329/     57A : AF                  	xor	a
    1330/     57B : C9                  	ret
    1331/     57C :                     
    1332/     57C :                     NO_RAM_AREA:
    1333/     57C : 37                  	SCF
    1334/     57D : C9                  	ret
    1335/     57E :                     	
    1336/     57E :                     
    1337/     57E :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1338/     57E :                     ; 2 insertion TC TABLE
    1339/     57E :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1340/     57E :                     ;
    1341/     57E :                     ; 1 byte machine code: branch (RET CC)
    1342/     57E :                     RETCC_TBLS:
    1343/     57E : C0                  	DB	0C0H	; RET	NZ
    1344/     57F : C8                  	DB	0C8H	; RET	Z
    1345/     580 : D0                  	DB	0D0H	; RET	NC
    1346/     581 : D8                  	DB	0D8H	; RET	C
    1347/     582 : E0                  	DB	0E0H	; RET	PO
    1348/     583 : E8                  	DB	0E8H	; RET	PE
    1349/     584 : F0                  	DB	0F0H	; RET	P
    1350/     585 : F8                  	DB	0F8H	; RET	M
    1351/     586 :                     RETCC_TBLE:
    1352/     586 :                     
    1353/     586 :                     ; 2 byte machine code: branch (JR CC, Relative)
    1354/     586 :                     JRCC_TBLS:
    1355/     586 : 10                  	DB	10H	; DJNZ	$
    1356/     587 :                     JRCC_TBLS1:
    1357/     587 : 20                  	DB	20H	; JR	NZ,$
    1358/     588 : 28                  	DB	28H	; JR	Z,$
    1359/     589 : 30                  	DB	30H	; JR	NC,$
    1360/     58A : 38                  	DB	38H	; JR	C,$
    1361/     58B :                     JRCC_TBLE:
    1362/     58B :                     
    1363/     58B :                     ; 3 byte machine code: branch (JP CC, 16bit literal)
    1364/     58B :                     JPCC_TBLS:
    1365/     58B : C2                  	DB	0C2H	; JP	NZ,1234H
    1366/     58C : CA                  	DB	0CAH	; JP	Z,1234H
    1367/     58D : D2                  	DB	0D2H	; JP	NC,1234H
    1368/     58E : DA                  	DB	0DAH	; JP	C,1234H
    1369/     58F : E2                  	DB	0E2H	; JP	PO,1234H
    1370/     590 : EA                  	DB	0EAH	; JP	PE,1234H
    1371/     591 : F2                  	DB	0F2H	; JP	P,1234H
    1372/     592 : FA                  	DB	0FAH	; JP	M,1234H
    1373/     593 :                     JPCC_TBLE:
    1374/     593 :                     
    1375/     593 :                     ; (call 16bit literal)
    1376/     593 :                     CLCC_TBLS:
    1377/     593 : C4                  	DB	0C4H	; CALL	NZ,1234H
    1378/     594 : CC                  	DB	0CCH	; CALL	Z,1234H
    1379/     595 : D4                  	DB	0D4H	; CALL	NC,1234H
    1380/     596 : DC                  	DB	0DCH	; CALL	C,1234H
    1381/     597 : E4                  	DB	0E4H	; CALL	PO,1234H
    1382/     598 : EC                  	DB	0ECH	; CALL	PE,1234H
    1383/     599 : F4                  	DB	0F4H	; CALL	P,1234H
    1384/     59A : FC                  	DB	0FCH	; CALL	M,1234H
    1385/     59B :                     CLCC_TBLE:
    1386/     59B :                     
    1387/     59B :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1388/     59B :                     ; 1 insertion TC TABLE
    1389/     59B :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1390/     59B :                     
    1391/     59B :                     ; restart
    1392/     59B :                     RST_TBLS:
    1393/     59B : C7                  	DB	0C7H	; RST	00H
    1394/     59C : CF                  	DB	0CFH	; RST	08H
    1395/     59D : D7                  	DB	0D7H	; RST	10H
    1396/     59E : DF                  	DB	0DFH	; RST	18H
    1397/     59F : E7                  	DB	0E7H	; RST	20H
    1398/     5A0 : EF                  	DB	0EFH	; RST	28H
    1399/     5A1 : F7                  	DB	0F7H	; RST	30H
    1400/     5A2 : FF                  	DB	0FFH	; RST	38H
    1401/     5A3 :                     RST_TBLE:
    1402/     5A3 :                     
    1403/     5A3 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1404/     5A3 :                     ;;;
    1405/     5A3 :                     ;;; machine code check(except branch)
    1406/     5A3 :                     ;;;
    1407/     5A3 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1408/     5A3 :                     INS2:
    1409/     5A3 :                     
    1410/     5A3 :                     	; 2byte machine code search
    1411/     5A3 : 01 12 00            	ld	bc, TWO_OPTBL_E - TWO_OPTBL
    1412/     5A6 : 21 3C 06            	ld	hl, TWO_OPTBL
    1413/     5A9 : ED B1               	cpir
    1414/     5AB : CA 17 06            	jp	z, meet_op2
    1415/     5AE :                     
    1416/     5AE :                     	; 3byte machine code search
    1417/     5AE : 01 08 00            	ld	bc, THREE_OPTBL_E - THREE_OPTBL
    1418/     5B1 : 21 4E 06            	ld	hl, THREE_OPTBL
    1419/     5B4 : ED B1               	cpir
    1420/     5B6 : CA 22 06            	jp	z, meet_op3
    1421/     5B9 :                     
    1422/     5B9 :                     	; check 0CBH
    1423/     5B9 :                     	
    1424/     5B9 :                     	; readjust hl
    1425/     5B9 : 2A 5A EF            	ld	hl, (tmpT)
    1426/     5BC :                     
    1427/     5BC : FE CB               	cp	0CBH		; opecode 0CBH?
    1428/     5BE : 28 57               	jr	z, meet_op2
    1429/     5C0 :                     	
    1430/     5C0 :                     	; check 0DDH
    1431/     5C0 : FE DD               	cp	0ddh		; opecode 0DDH?
    1432/     5C2 : 28 0A               	jr	z, meet_dd
    1433/     5C4 :                     	
    1434/     5C4 :                     	; check 0EDH
    1435/     5C4 : FE ED               	cp	0edh		; opecode 0EDH?
    1436/     5C6 : 28 28               	jr	z, meet_ed
    1437/     5C8 :                     
    1438/     5C8 :                     	; check 0FDH
    1439/     5C8 : FE FD               	cp	0fdh		; opecode 0FDH?
    1440/     5CA : 28 02               	jr	z, meet_dd
    1441/     5CC :                     
    1442/     5CC :                     	; 1byte machine code
    1443/     5CC : 18 3E               	jr	meet_op1
    1444/     5CE :                     
    1445/     5CE :                     	; opecode 0DDh
    1446/     5CE :                     meet_dd:
    1447/     5CE : 23                  	inc	hl
    1448/     5CF : 7E                  	ld	a, (hl)	
    1449/     5D0 : FE CB               	cp	0cbh		; 2nd 0CBH?
    1450/     5D2 : 28 59               	jr	z, meet_op4
    1451/     5D4 : FE 21               	cp	21h		; 2nd 21H?
    1452/     5D6 : 28 55               	jr	z, meet_op4
    1453/     5D8 : FE 22               	cp	22h		; 2nd 22H?
    1454/     5DA : 28 51               	jr	z, meet_op4
    1455/     5DC : FE 2A               	cp	2ah		; 2nd 2AH?
    1456/     5DE : 28 4D               	jr	z, meet_op4
    1457/     5E0 : FE 36               	cp	36h		; 2nd 36H?
    1458/     5E2 : 28 49               	jr	z, meet_op4
    1459/     5E4 :                     
    1460/     5E4 :                     	; 2nd code search
    1461/     5E4 : 01 0A 00            	ld	bc, DD_2NDTBL_E - DD_2NDTBL
    1462/     5E7 : 21 56 06            	ld	hl, DD_2NDTBL
    1463/     5EA : ED B1               	cpir
    1464/     5EC : 28 29               	jr	z, meet_op2
    1465/     5EE : 18 32               	jr	meet_op3
    1466/     5F0 :                     
    1467/     5F0 :                     meet_ed:
    1468/     5F0 : 23                  	inc	hl
    1469/     5F1 : 7E                  	ld	a, (hl)	
    1470/     5F2 : FE 43               	cp	43h		; 2nd 43H?
    1471/     5F4 : 28 37               	jr	z, meet_op4
    1472/     5F6 : FE 4B               	cp	4bh		; 2nd 4BH?
    1473/     5F8 : 28 33               	jr	z, meet_op4
    1474/     5FA : FE 53               	cp	53h		; 2nd 53H?
    1475/     5FC : 28 2F               	jr	z, meet_op4
    1476/     5FE : FE 5B               	cp	5bh		; 2nd 5BH?
    1477/     600 : 28 2B               	jr	z, meet_op4
    1478/     602 : FE 73               	cp	73h		; 2nd 73H?
    1479/     604 : 28 27               	jr	z, meet_op4
    1480/     606 : FE 7B               	cp	7bh		; 2nd 7BH?
    1481/     608 : 28 23               	jr	z, meet_op4
    1482/     60A : 18 0B               	jr	meet_op2
    1483/     60C :                     
    1484/     60C :                     ; 1 machine code
    1485/     60C :                     meet_op1:
    1486/     60C : 0E 01               	ld	c, 1
    1487/     60E : CD 27 05            	call	insBRK_1op
    1488/     611 : DA 06 05            	jp	c, err_trace_seq
    1489/     614 : C3 03 05            	jp	END_INS_TC
    1490/     617 :                     
    1491/     617 :                     ; 2 machine code
    1492/     617 :                     meet_op2:
    1493/     617 : 0E 01               	ld	c, 1
    1494/     619 : CD 2C 05            	call	insBRK_2op
    1495/     61C : DA 06 05            	jp	c, err_trace_seq
    1496/     61F : C3 03 05            	jp	END_INS_TC
    1497/     622 :                     ; 3 machine code
    1498/     622 :                     meet_op3:
    1499/     622 : 0E 01               	ld	c, 1
    1500/     624 : CD 31 05            	call	insBRK_3op
    1501/     627 : DA 06 05            	jp	c, err_trace_seq
    1502/     62A : C3 03 05            	jp	END_INS_TC
    1503/     62D :                     
    1504/     62D :                     ; 4 machine codee
    1505/     62D :                     meet_op4:
    1506/     62D : 0E 01               	ld	c, 1
    1507/     62F :                     ;	ld	hl, (REGPC)
    1508/     62F : 2A 5A EF            	ld	hl, (tmpT)
    1509/     632 : 23                  	inc	hl
    1510/     633 : CD 34 05            	call	ib3
    1511/     636 : DA 06 05            	jp	c, err_trace_seq
    1512/     639 : C3 03 05            	jp	END_INS_TC
    1513/     63C :                     
    1514/     63C :                     TWO_OPTBL:	; second byte is 8bitliteral[nn]
    1515/     63C :                     ld_r_nn_s:
    1516/     63C : 06                  	DB	06h	; LD	B,nn
    1517/     63D : 0E                  	DB	0Eh	; LD	C,nn
    1518/     63E : 16                  	DB	16h	; LD	D,nn
    1519/     63F : 1E                  	DB	1Eh	; LD	E,nn
    1520/     640 : 26                  	DB	26h	; LD	H,nn
    1521/     641 : 2E                  	DB	2Eh	; LD	L,nn
    1522/     642 : 36                  	DB	36h	; LD	(HL),nn
    1523/     643 : 3E                  	DB	3Eh	; LD	A,nn
    1524/     644 :                     ld_r_nn_e:
    1525/     644 :                     
    1526/     644 :                     log_op_s:
    1527/     644 : C6                  	DB	0C6h	; ADD	A,nn
    1528/     645 : CE                  	DB	0CEh	; ADC	A,nn
    1529/     646 : DE                  	DB	0DEh	; SBC	A,nn
    1530/     647 : D6                  	DB	0D6h	; SUB	nn
    1531/     648 : E6                  	DB	0E6h	; AND	nn
    1532/     649 : EE                  	DB	0EEh	; XOR	nn
    1533/     64A : F6                  	DB	0F6h	; OR	nn
    1534/     64B : FE                  	DB	0FEh	; CP	nn
    1535/     64C : DB                  	DB	0DBh	; IN	A,(nn)
    1536/     64D : D3                  	DB	0D3h	; OUT	(nn),A
    1537/     64E :                     log_op_e:
    1538/     64E :                     TWO_OPTBL_E:
    1539/     64E :                     
    1540/     64E :                     THREE_OPTBL:	; 2nd, 3rd byte is 16bitliteral[nnnn]
    1541/     64E : 01                  	DB	01h	; LD	BC,nnnn
    1542/     64F : 11                  	DB	11h	; LD	DE,nnnn
    1543/     650 : 21                  	DB	21h	; LD	HL,nnnn
    1544/     651 : 31                  	DB	31h	; LD	SP,nnnn
    1545/     652 :                     THREE_OPTBLe
    1546/     652 : 22                  	DB	22h	; LD	(nnnn),HL
    1547/     653 : 32                  	DB	32h	; LD	(nnnn),A
    1548/     654 :                     
    1549/     654 : 2A                  	DB	2Ah	; LD	HL,(nnnn)
    1550/     655 : 3A                  	DB	3Ah	; LD	A,(nnnn)
    1551/     656 :                     THREE_OPTBL_E:
    1552/     656 :                     
    1553/     656 :                     DD_2NDTBL:
    1554/     656 : 09                  	DB	09h	; ADD	IX,BC
    1555/     657 : 19                  	DB	19h	; ADD	IX,DE
    1556/     658 : 29                  	DB	29h	; ADD	IX,IX
    1557/     659 : 39                  	DB	39h	; ADD	IX,SP
    1558/     65A :                     DD_2NDTBL1:
    1559/     65A : 23                  	DB	23h	; INC	IX
    1560/     65B : 2B                  	DB	2Bh	; DEC	IX
    1561/     65C : E5                  	DB	0E5h	; PUSH	IX
    1562/     65D : E1                  	DB	0E1h	; POP	IX
    1563/     65E :                     DD_2NDTBL2:
    1564/     65E : E3                  	DB	0E3h	; EX	(SP),IX
    1565/     65F : F9                  	DB	0F9h	; LD	SP,IX
    1566/     660 :                     DD_2NDTBL_E:
    1567/     660 :                     
    1568/     660 :                     ;;; 
    1569/     660 :                     ;;; Dump memory
    1570/     660 :                     ;;; 
    1571/     660 :                     
    1572/     660 :                     DUMP:
    1573/     660 : 23                  	INC	HL
    1574/     661 : 7E                  	LD	A,(HL)
    1575/     662 : FE 49               	cp	'I'
    1576/     664 : CA 68 07            	JP	Z,disassemble
    1577/     667 : CD 02 18            	CALL	SKIPSP
    1578/     66A : CD 12 18            	CALL	RDHEX		; 1st arg.
    1579/     66D : 38 06               	jr	c, DP0
    1580/     66F :                     	;; 1st arg. found
    1581/     66F : ED 53 20 EF         	LD	(DSADDR),DE
    1582/     673 : 18 10               	jr	dp00
    1583/     675 :                     
    1584/     675 :                     DP0:	;; No arg. chk
    1585/     675 :                     
    1586/     675 : E5                  	push	hl
    1587/     676 : 2A 20 EF            	LD	HL,(DSADDR)
    1588/     679 : 01 80 00            	LD	BC,128
    1589/     67C : 09                  	ADD	HL,BC
    1590/     67D : 22 22 EF            	LD	(DEADDR),HL
    1591/     680 : E1                  	pop	hl
    1592/     681 : 7E                  	LD	A,(HL)
    1593/     682 : B7                  	OR	A
    1594/     683 : 28 2B               	JR	z, DPM		; no arg.
    1595/     685 :                     
    1596/     685 :                     dp00:
    1597/     685 : CD 02 18            	CALL	SKIPSP
    1598/     688 : 7E                  	LD	A,(HL)
    1599/     689 : FE 2C               	CP	','
    1600/     68B : 28 0D               	JR	Z,DP1
    1601/     68D : B7                  	OR	A
    1602/     68E : C2 FE 00            	JP	NZ,ERR
    1603/     691 :                     	;; No 2nd arg.
    1604/     691 : 21 80 00            	LD	HL,128
    1605/     694 : 19                  	ADD	HL,DE
    1606/     695 : 22 22 EF            	LD	(DEADDR),HL
    1607/     698 : 18 16               	JR	DPM
    1608/     69A :                     DP1:
    1609/     69A : 23                  	INC	HL
    1610/     69B : CD 02 18            	CALL	SKIPSP
    1611/     69E : CD 12 18            	CALL	RDHEX
    1612/     6A1 : DA FE 00            	jp	c, ERR
    1613/     6A4 : CD 02 18            	CALL	SKIPSP
    1614/     6A7 : B7                  	OR	A
    1615/     6A8 : C2 FE 00            	jp	nz, ERR
    1616/     6AB : 13                  	INC	DE
    1617/     6AC : ED 53 22 EF         	LD	(DEADDR),DE
    1618/     6B0 :                     DPM:
    1619/     6B0 :                     	;; DUMP main
    1620/     6B0 : 2A 20 EF            	LD	HL,(DSADDR)
    1621/     6B3 : 3E F0               	LD	A,0F0H
    1622/     6B5 : A5                  	AND	L
    1623/     6B6 : 6F                  	LD	L,A
    1624/     6B7 : AF                  	XOR	A
    1625/     6B8 : 32 24 EF            	LD	(DSTATE),A
    1626/     6BB :                     DPM0:
    1627/     6BB : E5                  	PUSH	HL
    1628/     6BC : CD E2 06            	CALL	DPL
    1629/     6BF : E1                  	POP	HL
    1630/     6C0 : 01 10 00            	LD	BC,16
    1631/     6C3 : 09                  	ADD	HL,BC
    1632/     6C4 : CD B2 1F            	CALL	CONST
    1633/     6C7 : 20 10               	JR	NZ,DPM1
    1634/     6C9 : 3A 24 EF            	LD	A,(DSTATE)
    1635/     6CC : FE 02               	CP	2
    1636/     6CE : 38 EB               	JR	C,DPM0
    1637/     6D0 : 2A 22 EF            	LD	HL,(DEADDR)
    1638/     6D3 : 22 20 EF            	LD	(DSADDR),HL
    1639/     6D6 : C3 BE 00            	JP	WSTART
    1640/     6D9 :                     DPM1:
    1641/     6D9 : 22 20 EF            	LD	(DSADDR),HL
    1642/     6DC : CD A7 1F            	CALL	CONIN
    1643/     6DF : C3 BE 00            	JP	WSTART
    1644/     6E2 :                     
    1645/     6E2 :                     DPL:
    1646/     6E2 :                     	;; DUMP line
    1647/     6E2 : CD 51 17            	CALL	HEXOUT4
    1648/     6E5 : E5                  	PUSH	HL
    1649/     6E6 : 21 74 1D            	LD	HL,DSEP0
    1650/     6E9 : CD 48 17            	CALL	STROUT
    1651/     6EC : E1                  	POP	HL
    1652/     6ED : DD 21 00 EF         	LD	IX,INBUF
    1653/     6F1 : 06 10               	LD	B,16
    1654/     6F3 :                     DPL0:
    1655/     6F3 : CD 1C 07            	CALL	DPB
    1656/     6F6 : 10 FB               	DJNZ	DPL0
    1657/     6F8 :                     
    1658/     6F8 : 21 77 1D            	LD	HL,DSEP1
    1659/     6FB : CD 48 17            	CALL	STROUT
    1660/     6FE :                     
    1661/     6FE : 21 00 EF            	LD	HL,INBUF
    1662/     701 : 06 10               	LD	B,16
    1663/     703 :                     DPL1:
    1664/     703 : 7E                  	LD	A,(HL)
    1665/     704 : 23                  	INC	HL
    1666/     705 : FE 20               	CP	' '
    1667/     707 : 38 09               	JR	C,DPL2
    1668/     709 : FE 7F               	CP	7FH
    1669/     70B : 30 05               	JR	NC,DPL2
    1670/     70D : CD B8 1F            	CALL	CONOUT
    1671/     710 : 18 05               	JR	DPL3
    1672/     712 :                     DPL2:
    1673/     712 : 3E 2E               	LD	A,'.'
    1674/     714 : CD B8 1F            	CALL	CONOUT
    1675/     717 :                     DPL3:
    1676/     717 : 10 EA               	DJNZ	DPL1
    1677/     719 : C3 91 17            	JP	CRLF
    1678/     71C :                     
    1679/     71C :                     DPB:	; Dump byte
    1680/     71C : 3E 20               	LD	A,' '
    1681/     71E : CD B8 1F            	CALL	CONOUT
    1682/     721 : 3A 24 EF            	LD	A,(DSTATE)
    1683/     724 : B7                  	OR	A
    1684/     725 : 20 20               	JR	NZ,DPB2
    1685/     727 :                     	; Dump state 0
    1686/     727 : 3A 20 EF            	LD	A,(DSADDR)	; Low byte
    1687/     72A : BD                  	CP	L
    1688/     72B : 20 06               	JR	NZ,DPB0
    1689/     72D : 3A 21 EF            	LD	A,(DSADDR+1)	; High byte
    1690/     730 : BC                  	CP	H
    1691/     731 : 28 0F               	JR	Z,DPB1
    1692/     733 :                     DPB0:	; Still 0 or 2
    1693/     733 : 3E 20               	LD	A,' '
    1694/     735 : CD B8 1F            	CALL	CONOUT
    1695/     738 : CD B8 1F            	CALL	CONOUT
    1696/     73B : DD 77 00            	LD	(IX),A
    1697/     73E : 23                  	INC	HL
    1698/     73F : DD 23               	INC	IX
    1699/     741 : C9                  	RET
    1700/     742 :                     DPB1:	; Found start address
    1701/     742 : 3E 01               	LD	A,1
    1702/     744 : 32 24 EF            	LD	(DSTATE),A
    1703/     747 :                     DPB2:
    1704/     747 : 3A 24 EF            	LD	A,(DSTATE)
    1705/     74A : FE 01               	CP	1
    1706/     74C : 20 E5               	JR	NZ,DPB0
    1707/     74E :                     	; Dump state 1
    1708/     74E : 7E                  	LD	A,(HL)
    1709/     74F : DD 77 00            	LD	(IX),A
    1710/     752 : CD 56 17            	CALL	HEXOUT2
    1711/     755 : 23                  	INC	HL
    1712/     756 : DD 23               	INC	IX
    1713/     758 : 3A 22 EF            	LD	A,(DEADDR)	; Low byte
    1714/     75B : BD                  	CP	L
    1715/     75C : C0                  	RET	NZ
    1716/     75D : 3A 23 EF            	LD	A,(DEADDR+1)	; High byte
    1717/     760 : BC                  	CP	H
    1718/     761 : C0                  	RET	NZ
    1719/     762 :                     	; Found end address
    1720/     762 : 3E 02               	LD	A,2
    1721/     764 : 32 24 EF            	LD	(DSTATE),A
    1722/     767 : C9                  	RET
    1723/     768 :                     
    1724/     768 :                     ;;;
    1725/     768 :                     ;;; Disassemble
    1726/     768 :                     ;;; 
    1727/     768 :                     
    1728/     768 :                     
    1729/     768 :                     ; DI[<address>][,s<steps>|<end address>]
    1730/     768 :                     
    1731/     768 :                     disassemble:
    1732/     768 : 23                  	INC	HL
    1733/     769 : CD 02 18            	CALL	SKIPSP
    1734/     76C : CD 12 18            	CALL	RDHEX		; 1st arg.
    1735/     76F : 30 14               	jr	nc, get_DI1
    1736/     771 :                     
    1737/     771 :                     di_nxt:
    1738/     771 :                     	;; No arg. chk
    1739/     771 : CD 02 18            	CALL	SKIPSP
    1740/     774 : 7E                  	LD	A,(HL)
    1741/     775 : B7                  	OR	A
    1742/     776 : 20 13               	jr	NZ, chk_DI1	; ',' check
    1743/     778 :                     
    1744/     778 :                     ; No arg
    1745/     778 : 26 00               	ld	h, 0
    1746/     77A : 2E 0A               	ld	l, 10
    1747/     77C : 7D                  	ld	a, l
    1748/     77D : 32 7C EF            	ld	(dasm_stpf), a	; set step flag
    1749/     780 : 22 7A EF            	ld	(dasm_ed), hl	; set 10 steps
    1750/     783 : 18 33               	jr	DISASM_go
    1751/     785 :                     
    1752/     785 :                     ; 1st arg
    1753/     785 :                     get_DI1:
    1754/     785 : ED 53 7D EF         	ld	(dasm_adr), de	; save start address
    1755/     789 :                     ;	INC	HL
    1756/     789 : 18 E6               	jr	di_nxt
    1757/     78B :                     
    1758/     78B :                     chk_DI1:
    1759/     78B : FE 2C               	cp	','
    1760/     78D : C2 FE 00            	jp	nz, ERR
    1761/     790 :                     
    1762/     790 :                     ; check 2nd arg
    1763/     790 :                     
    1764/     790 : 23                  	INC	HL
    1765/     791 : CD 02 18            	CALL	SKIPSP
    1766/     794 :                     ;	call	UPPER
    1767/     794 : FE 53               	cp	'S'
    1768/     796 : 20 12               	jr	nz, chk_stpDI
    1769/     798 :                     
    1770/     798 :                     ; step arg
    1771/     798 : 3E 01               	ld	a, 1
    1772/     79A : 32 7C EF            	ld	(dasm_stpf), a	; set step flag
    1773/     79D : 23                  	inc	hl
    1774/     79E : CD B6 01            	call	GET_NUM		; get decimal number to binary
    1775/     7A1 : DA FE 00            	jp	c, ERR
    1776/     7A4 : ED 43 7A EF         	ld	(dasm_ed), bc	; set steps
    1777/     7A8 : 18 0E               	jr	DISASM_go
    1778/     7AA :                     
    1779/     7AA :                     chk_stpDI:
    1780/     7AA : CD 12 18            	CALL	RDHEX		; 2nd arg.
    1781/     7AD : DA FE 00            	jp	c, ERR
    1782/     7B0 : ED 53 7A EF         	ld	(dasm_ed), de	; set end address
    1783/     7B4 : AF                  	xor	a
    1784/     7B5 : 32 7C EF            	ld	(dasm_stpf), a	; clear step flag
    1785/     7B8 :                     
    1786/     7B8 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1787/     7B8 :                     ; operation Disassemble
    1788/     7B8 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1789/     7B8 :                     
    1790/     7B8 :                     DISASM_go:
    1791/     7B8 : CD B2 1F            	call	CONST
    1792/     7BB : 28 06               	jr	z, dis_go1
    1793/     7BD : CD A7 1F            	call	CONIN		;discard key
    1794/     7C0 : C3 BE 00            	jp	WSTART		; exit disasm command
    1795/     7C3 :                     
    1796/     7C3 :                     dis_go1:
    1797/     7C3 :                     	; get opcode
    1798/     7C3 : CD 47 08            	call	dis_analysis
    1799/     7C6 : CD 0C 08            	call	mk_adr_str	; conout address and machine code
    1800/     7C9 :                     				; *dasm_adr is next opcode address
    1801/     7C9 : 21 84 EF            	ld	hl, adr_mc_buf
    1802/     7CC : CD 48 17            	call	STROUT		; conout disassemble strings
    1803/     7CF :                     
    1804/     7CF : 3A 7C EF            	ld	a, (dasm_stpf)
    1805/     7D2 : B7                  	or	a
    1806/     7D3 : 20 0E               	jr	nz, calc_dis_step
    1807/     7D5 :                     	
    1808/     7D5 :                     	; *dasm_adr > *dasm_ed ?, yes, finish
    1809/     7D5 : 2A 7A EF            	ld	hl, (dasm_ed)
    1810/     7D8 : ED 4B 7D EF         	ld	bc, (dasm_adr)
    1811/     7DC : ED 42               	sbc	hl, bc
    1812/     7DE : 30 D8               	jr	nc, DISASM_go
    1813/     7E0 : C3 BE 00            	jp	WSTART
    1814/     7E3 :                     
    1815/     7E3 :                     calc_dis_step:
    1816/     7E3 : 2A 7A EF            	ld	hl, (dasm_ed)
    1817/     7E6 : 2B                  	dec	hl
    1818/     7E7 : 22 7A EF            	ld	(dasm_ed), hl
    1819/     7EA : 7C                  	ld	a, h
    1820/     7EB : B5                  	or	l
    1821/     7EC : 20 CA               	jr	nz, DISASM_go
    1822/     7EE : C3 BE 00            	jp	WSTART
    1823/     7F1 :                     
    1824/     7F1 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1825/     7F1 :                     ; Disassemble and maked strings to user buffer
    1826/     7F1 :                     ; input de : user buffer
    1827/     7F1 :                     ;       hl : disassemble address
    1828/     7F1 :                     ; output de : next MC address
    1829/     7F1 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1830/     7F1 :                     get_disasm_st:
    1831/     7F1 : 22 7D EF            	ld	(dasm_adr), hl
    1832/     7F4 : D5                  	push	de
    1833/     7F5 : CD 47 08            	call	dis_analysis
    1834/     7F8 : CD 0C 08            	call	mk_adr_str	; conout address and machine code
    1835/     7FB : D1                  	pop	de
    1836/     7FC : 21 84 EF            	ld	hl, adr_mc_buf
    1837/     7FF : 01 2A 00            	ld	bc, dasm_be - dasm_bs
    1838/     802 : ED B0               	ldir
    1839/     804 : ED 5B 7D EF         	ld	de, (dasm_adr)
    1840/     808 : 3A 83 EF            	ld	a, (mc_Size)
    1841/     80B : C9                  	ret
    1842/     80C :                     
    1843/     80C :                     ;-------------------------------------------------
    1844/     80C :                     ; Make address and machine code at adr_mc_buf
    1845/     80C :                     ; "XXXX XX XX XX XX " (17bytes)
    1846/     80C :                     ;-------------------------------------------------
    1847/     80C :                     mk_adr_str:
    1848/     80C : 21 84 EF            	ld	hl, adr_mc_buf
    1849/     80F : ED 5B 7D EF         	ld	de, (dasm_adr)
    1850/     813 : CD E7 0F            	call	hex4str		; address XXXX
    1851/     816 : CD 77 10            	call	ins_spcR
    1852/     819 : CD 77 10            	call	ins_spcR
    1853/     81C :                     
    1854/     81C : 06 04               	ld	b, 4
    1855/     81E : 3A 83 EF            	ld	a, (mc_Size)
    1856/     821 : 4F                  	ld	c, a
    1857/     822 :                     mas_1:
    1858/     822 : 1A                  	ld	a, (de)
    1859/     823 : 13                  	inc	de
    1860/     824 :                     
    1861/     824 : D5                  	push	de
    1862/     825 : 5F                  	ld	e, a
    1863/     826 : CD EF 0F            	call	hex2str		; MC XX
    1864/     829 : CD 77 10            	call	ins_spcR
    1865/     82C : D1                  	pop	de
    1866/     82D :                     
    1867/     82D : 05                  	dec	b
    1868/     82E : 28 0F               	jr	z, mas_3	; end
    1869/     830 : 0D                  	dec	c
    1870/     831 : 20 EF               	jr	nz, mas_1
    1871/     833 :                     
    1872/     833 :                     mas_2:	
    1873/     833 : CD 77 10            	call	ins_spcR
    1874/     836 : CD 77 10            	call	ins_spcR
    1875/     839 : CD 77 10            	call	ins_spcR
    1876/     83C : 05                  	dec	b
    1877/     83D : 20 F4               	jr	nz, mas_2
    1878/     83F :                     mas_3:
    1879/     83F : CD 77 10            	call	ins_spcR
    1880/     842 : ED 53 7D EF         	ld	(dasm_adr), de	; set next analysis address
    1881/     846 : C9                  	ret
    1882/     847 :                     
    1883/     847 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1884/     847 :                     ; dis assemble analysis
    1885/     847 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1886/     847 :                     
    1887/     847 :                     dis_analysis:
    1888/     847 :                     
    1889/     847 :                     	; pre init string buffer
    1890/     847 :                     
    1891/     847 : 3E 01               	ld	a, 1
    1892/     849 : 32 83 EF            	ld	(mc_Size), a
    1893/     84C :                     
    1894/     84C : 11 46 11            	ld	de, LDstr	; insert LD string
    1895/     84F : CD 0B 10            	call	mkopcstr
    1896/     852 :                     
    1897/     852 : 21 9F EF            	ld	hl, dasm_OprStr
    1898/     855 : CD 37 10            	call	insPostStr	; CR, LF, 00h
    1899/     858 :                     
    1900/     858 : 2A 7D EF            	ld	hl, (dasm_adr)
    1901/     85B : 7E                  	ld	a, (hl)		; get opcode
    1902/     85C :                     
    1903/     85C :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1904/     85C :                     	; analysys 1 byte MC
    1905/     85C :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1906/     85C :                     
    1907/     85C :                     ;  check no operand
    1908/     85C :                     
    1909/     85C : 01 0D 00            	ld	bc, oth_1op_e - oth_1op_s
    1910/     85F : 21 8A 10            	ld	hl, oth_1op_s
    1911/     862 : ED B1               	cpir
    1912/     864 : 20 12               	jr	nz, chk_ld
    1913/     866 :                     
    1914/     866 :                     ;  no operand
    1915/     866 :                     
    1916/     866 : 21 99 12            	ld	hl, oth_1op_tbl
    1917/     869 : CD 8D 0F            	call	get_strBufpoint
    1918/     86C : C3 0B 10            	jp	mkopcstr
    1919/     86F :                     
    1920/     86F :                     get_r_num:
    1921/     86F : E6 38               	and	38H
    1922/     871 : 0F                  	rrca
    1923/     872 : 0F                  	rrca
    1924/     873 : 0F                  	rrca
    1925/     874 : 4F                  	ld	c, a
    1926/     875 : 06 00               	ld	b, 0		; bc ; register No.
    1927/     877 : C9                  	ret
    1928/     878 :                     ;
    1929/     878 :                     ; LD opecode
    1930/     878 :                     ;
    1931/     878 :                     
    1932/     878 :                     ; check LD "A,(BC)", "A,(DE)", "(BC),A", "(DE),A", "SP,HL"
    1933/     878 :                     
    1934/     878 :                     chk_ld:
    1935/     878 : FE 0A               	cp	0AH	; LD	A,(BC)
    1936/     87A : 28 19               	jr	z, ld_a_kbck
    1937/     87C : FE 1A               	cp	1AH	; LD	A,(DE)
    1938/     87E : 28 23               	jr	z, ld_a_kdek
    1939/     880 : FE 02               	cp	02H	; LD	(BC),A
    1940/     882 : 28 24               	jr	z, ld_kbck_a
    1941/     884 : FE 12               	cp	12H	; LD	(DE),A
    1942/     886 : 28 29               	jr	z, ld_kdek_a
    1943/     888 : FE F9               	cp	0F9H	; LD	SP,HL
    1944/     88A : 20 2A               	jr	nz, chk_ld1
    1945/     88C :                     
    1946/     88C :                     ; LD SP, HL
    1947/     88C : 11 9C 1F            	ld	de, RNSP
    1948/     88F : CD 5E 10            	call	mk_rcs		; "SP, "
    1949/     892 : C3 31 10            	jp	hl_crlf
    1950/     895 :                     	
    1951/     895 :                     ; LD A, (BC)
    1952/     895 :                     ld_a_kbck:
    1953/     895 : 11 5B 1F            	ld	de, RNBC
    1954/     898 :                     ld_a_kxxk:
    1955/     898 : D5                  	push	de
    1956/     899 : CD 5B 10            	call	a_colon_sp	; "A, "
    1957/     89C : D1                  	pop	de
    1958/     89D : CD 45 10            	call	mk_krk		; "(BC)", "(DE)"
    1959/     8A0 : C3 37 10            	jp	insPostStr	; CR, LF, 00h
    1960/     8A3 :                     
    1961/     8A3 :                     ; LD A, (DE)
    1962/     8A3 :                     ld_a_kdek:
    1963/     8A3 : 11 62 1F            	ld	de, RNDE
    1964/     8A6 : 18 F0               	jr	ld_a_kxxk
    1965/     8A8 :                     
    1966/     8A8 :                     ; LD (BC), A
    1967/     8A8 :                     ld_kbck_a:
    1968/     8A8 : 11 5B 1F            	ld	de, RNBC
    1969/     8AB :                     
    1970/     8AB :                     ld_kxxk_a:
    1971/     8AB : CD 4D 10            	call	mk_krkcs	; "(BC), ", "(DE), "
    1972/     8AE : C3 26 10            	jp	a_crlf		; "A",CR,LF
    1973/     8B1 :                     
    1974/     8B1 :                     ; LD (DE), A
    1975/     8B1 :                     ld_kdek_a:
    1976/     8B1 : 11 62 1F            	ld	de, RNDE
    1977/     8B4 : 18 F5               	jr	ld_kxxk_a
    1978/     8B6 :                     
    1979/     8B6 :                     ; check other 1byte LD MC
    1980/     8B6 :                     
    1981/     8B6 :                     chk_ld1:
    1982/     8B6 : FE 40               	cp	40h
    1983/     8B8 : DA 4E 09            	jp	c, chk_inc
    1984/     8BB : FE 80               	cp	80h
    1985/     8BD : 30 28               	jr	nc, chk_add
    1986/     8BF : FE 76               	cp	76h	; HALT?
    1987/     8C1 : 20 06               	jr	nz, LD1op
    1988/     8C3 :                     
    1989/     8C3 : 11 49 11            	ld	de, HLTstr	; HALT string
    1990/     8C6 : C3 0B 10            	jp	mkopcstr	; de : next string buffer addr
    1991/     8C9 :                     
    1992/     8C9 :                     ; LD
    1993/     8C9 :                     
    1994/     8C9 :                     LD1op:
    1995/     8C9 : CD 6F 08            	call	get_r_num
    1996/     8CC : CD 8A 0F            	call	get_rstg_off
    1997/     8CF : 21 9F EF            	ld	hl, dasm_OprStr
    1998/     8D2 : CD 5E 10            	call	mk_rcs		; "REG, "
    1999/     8D5 :                     
    2000/     8D5 :                     mk_2ndopr:
    2001/     8D5 : ED 5B 7D EF         	ld	de, (dasm_adr)
    2002/     8D9 : 1A                  	ld	a, (de)		; get opcode
    2003/     8DA : E6 07               	and	07h
    2004/     8DC : 4F                  	ld	c, a
    2005/     8DD : 06 00               	ld	b, 0
    2006/     8DF :                     
    2007/     8DF :                     mk_2ndopr1:
    2008/     8DF : E5                  	push	hl		; save copy buffer
    2009/     8E0 : CD 8A 0F            	call	get_rstg_off
    2010/     8E3 : E1                  	pop	hl		; copy buffer
    2011/     8E4 : C3 34 10            	jp	cpstr_crlf	; "REG",CR,LF
    2012/     8E7 :                     
    2013/     8E7 :                     ; ADD 80H - 87H
    2014/     8E7 :                     ; check ADD code
    2015/     8E7 :                     
    2016/     8E7 :                     chk_add:
    2017/     8E7 : FE 88               	cp	88h
    2018/     8E9 : 30 08               	jr	nc, chk_adc
    2019/     8EB :                     
    2020/     8EB :                     ; ADD
    2021/     8EB : CD 08 10            	call	add_opstr
    2022/     8EE : CD 5B 10            	call	a_colon_sp
    2023/     8F1 : 18 E2               	jr	mk_2ndopr
    2024/     8F3 :                     
    2025/     8F3 :                     ; ADC 88H - 8FH
    2026/     8F3 :                     ; check ADC code
    2027/     8F3 :                     
    2028/     8F3 :                     chk_adc:
    2029/     8F3 : FE 90               	cp	90h
    2030/     8F5 : 30 0B               	jr	nc, chk_sub
    2031/     8F7 :                     
    2032/     8F7 :                     ; ADC
    2033/     8F7 : 11 52 11            	ld	de, ADCstr
    2034/     8FA : CD 0B 10            	call	mkopcstr
    2035/     8FD : CD 5B 10            	call	a_colon_sp
    2036/     900 : 18 D3               	jr	mk_2ndopr
    2037/     902 :                     
    2038/     902 :                     ; SUB 90H - 97H
    2039/     902 :                     ; check SUB code
    2040/     902 :                     
    2041/     902 :                     chk_sub:
    2042/     902 : FE 98               	cp	98h
    2043/     904 : 30 08               	jr	nc, chk_sbc
    2044/     906 :                     
    2045/     906 :                     ; SUB
    2046/     906 : 11 56 11            	ld	de, SUBstr
    2047/     909 : CD 0B 10            	call	mkopcstr
    2048/     90C : 18 C7               	jr	mk_2ndopr
    2049/     90E :                     
    2050/     90E :                     ; SBC 98H - 9FH
    2051/     90E :                     ; check SBC code
    2052/     90E :                     
    2053/     90E :                     chk_sbc:
    2054/     90E : FE A0               	cp	0A0h
    2055/     910 : 30 0B               	jr	nc, chk_and
    2056/     912 :                     
    2057/     912 :                     ; SBC
    2058/     912 : 11 5A 11            	ld	de, SBCstr
    2059/     915 : CD 0B 10            	call	mkopcstr
    2060/     918 : CD 5B 10            	call	a_colon_sp
    2061/     91B : 18 B8               	jr	mk_2ndopr
    2062/     91D :                     
    2063/     91D :                     ; AND 0A0H - 0A7H
    2064/     91D :                     ; check AND code
    2065/     91D :                     
    2066/     91D :                     chk_and:
    2067/     91D : FE A8               	cp	0A8h
    2068/     91F : 30 08               	jr	nc, chk_xor
    2069/     921 :                     
    2070/     921 :                     ; AND
    2071/     921 : 11 5E 11            	ld	de, ANDstr
    2072/     924 : CD 0B 10            	call	mkopcstr
    2073/     927 : 18 AC               	jr	mk_2ndopr
    2074/     929 :                     
    2075/     929 :                     ; XOR 0A8H - 0AFH
    2076/     929 :                     ; check XOR code
    2077/     929 :                     
    2078/     929 :                     chk_xor:
    2079/     929 :                     
    2080/     929 : FE B0               	cp	0B0h
    2081/     92B : 30 08               	jr	nc, chk_or
    2082/     92D :                     
    2083/     92D :                     ; XOR
    2084/     92D : 11 62 11            	ld	de, XORstr
    2085/     930 : CD 0B 10            	call	mkopcstr
    2086/     933 : 18 A0               	jr	mk_2ndopr
    2087/     935 :                     
    2088/     935 :                     ; OR 0B0H - 0B7H
    2089/     935 :                     ; check OR code
    2090/     935 :                     
    2091/     935 :                     chk_or:
    2092/     935 : FE B8               	cp	0B8h
    2093/     937 : 30 08               	jr	nc, chk_cp
    2094/     939 :                     
    2095/     939 :                     ; OR
    2096/     939 : 11 66 11            	ld	de, ORstr
    2097/     93C : CD 0B 10            	call	mkopcstr
    2098/     93F : 18 94               	jr	mk_2ndopr
    2099/     941 :                     
    2100/     941 :                     ; CP 0B8H - 0BFH
    2101/     941 :                     ; check CP code
    2102/     941 :                     
    2103/     941 :                     chk_cp:
    2104/     941 : FE C0               	cp	0C0h
    2105/     943 : D2 CA 09            	jp	nc, chk_pop_rp
    2106/     946 :                     
    2107/     946 :                     ; CP
    2108/     946 : 11 69 11            	ld	de, CPstr
    2109/     949 : CD 0B 10            	call	mkopcstr
    2110/     94C : 18 87               	jr	mk_2ndopr
    2111/     94E :                     
    2112/     94E :                     ;check INC
    2113/     94E :                     
    2114/     94E :                     chk_inc:
    2115/     94E : 01 08 00            	ld	bc, INC_OPCDTBLE - INC_OPCDTBLS
    2116/     951 : 21 97 10            	ld	hl, INC_OPCDTBLS
    2117/     954 : ED B1               	cpir
    2118/     956 : 20 0E               	jr	nz, chk_dec
    2119/     958 :                     
    2120/     958 :                     ; INC
    2121/     958 : F5                  	push	af
    2122/     959 : 11 6C 11            	ld	de, INCstr
    2123/     95C : CD 0B 10            	call	mkopcstr
    2124/     95F : F1                  	pop	af
    2125/     960 :                     
    2126/     960 :                     inc_dec:
    2127/     960 : CD 6F 08            	call	get_r_num
    2128/     963 : C3 DF 08            	jp	mk_2ndopr1
    2129/     966 :                     
    2130/     966 :                     ;check dec
    2131/     966 :                     
    2132/     966 :                     chk_dec:
    2133/     966 : 01 08 00            	ld	bc, DEC_OPCDTBLE - DEC_OPCDTBLS
    2134/     969 : 21 9F 10            	ld	hl, DEC_OPCDTBLS
    2135/     96C : ED B1               	cpir
    2136/     96E : 20 0A               	jr	nz, chk_inc_rp
    2137/     970 :                     
    2138/     970 :                     ; DEC
    2139/     970 : F5                  	push	af
    2140/     971 : 11 70 11            	ld	de, DECstr
    2141/     974 : CD 0B 10            	call	mkopcstr
    2142/     977 : F1                  	pop	af
    2143/     978 : 18 E6               	jr	inc_dec
    2144/     97A :                     
    2145/     97A :                     ; check inc rp
    2146/     97A :                     
    2147/     97A :                     chk_inc_rp:
    2148/     97A : 01 04 00            	ld	bc, inc_rp_e - inc_rp_s
    2149/     97D : 21 A7 10            	ld	hl, inc_rp_s
    2150/     980 : ED B1               	cpir
    2151/     982 : 20 0F               	jr	nz, chk_dec_rp
    2152/     984 :                     
    2153/     984 :                     ; INC rp
    2154/     984 : 11 6C 11            	ld	de, INCstr
    2155/     987 : CD 0B 10            	call	mkopcstr
    2156/     98A :                     
    2157/     98A : 21 89 12            	ld	hl, INC_DEC_ADDrp
    2158/     98D : CD 81 0F            	call	mk_str
    2159/     990 : C3 37 10            	jp	insPostStr	; CR, LF, 00h
    2160/     993 :                     
    2161/     993 :                     ; check dec rp
    2162/     993 :                     
    2163/     993 :                     chk_dec_rp:
    2164/     993 : 01 04 00            	ld	bc, dec_rp_e - dec_rp_s
    2165/     996 : 21 AB 10            	ld	hl, dec_rp_s
    2166/     999 : ED B1               	cpir
    2167/     99B : 20 0F               	jr	nz, chk_add_rp
    2168/     99D :                     
    2169/     99D :                     ; dec rp
    2170/     99D : 11 70 11            	ld	de, DECstr
    2171/     9A0 : CD 0B 10            	call	mkopcstr
    2172/     9A3 :                     
    2173/     9A3 : 21 89 12            	ld	hl, INC_DEC_ADDrp
    2174/     9A6 : CD 81 0F            	call	mk_str
    2175/     9A9 : C3 37 10            	jp	insPostStr	; CR, LF, 00h
    2176/     9AC :                     
    2177/     9AC :                     ;check ADD HL, rp
    2178/     9AC :                     
    2179/     9AC :                     chk_add_rp:
    2180/     9AC : 01 04 00            	ld	bc, add_rp_e - add_rp_s
    2181/     9AF : 21 AF 10            	ld	hl, add_rp_s
    2182/     9B2 : ED B1               	cpir
    2183/     9B4 : 20 46               	jr	nz, chk_ex
    2184/     9B6 :                     
    2185/     9B6 :                     ; add hl, rp
    2186/     9B6 :                     
    2187/     9B6 : CD 08 10            	call	add_opstr
    2188/     9B9 :                     
    2189/     9B9 : 11 69 1F            	ld	de, RNHL
    2190/     9BC : CD 5E 10            	call	mk_rcs		; "HL, "
    2191/     9BF :                     
    2192/     9BF : E5                  	push	hl
    2193/     9C0 : 21 89 12            	ld	hl, INC_DEC_ADDrp
    2194/     9C3 : CD 8D 0F            	call	get_strBufpoint
    2195/     9C6 : E1                  	pop	hl
    2196/     9C7 : C3 34 10            	jp	cpstr_crlf	; CR, LF, 00h
    2197/     9CA :                     
    2198/     9CA :                     ; check POP rp
    2199/     9CA :                     
    2200/     9CA :                     chk_pop_rp:
    2201/     9CA : 01 04 00            	ld	bc, pop_rp_e - pop_rp_s
    2202/     9CD : 21 B3 10            	ld	hl, pop_rp_s
    2203/     9D0 : ED B1               	cpir
    2204/     9D2 : 20 0F               	jr	nz, chk_push_rp
    2205/     9D4 :                     
    2206/     9D4 :                     ; POP RP
    2207/     9D4 :                     
    2208/     9D4 : 11 74 11            	ld	de, POPstr
    2209/     9D7 : CD 0B 10            	call	mkopcstr
    2210/     9DA :                     
    2211/     9DA : 21 91 12            	ld	hl, POP_PUSHrp
    2212/     9DD : CD 81 0F            	call	mk_str
    2213/     9E0 : C3 37 10            	jp	insPostStr	; CR, LF, 00h
    2214/     9E3 :                     
    2215/     9E3 :                     ; check PUSH rp
    2216/     9E3 :                     
    2217/     9E3 :                     chk_push_rp:
    2218/     9E3 : 01 04 00            	ld	bc, push_rp_e - push_rp_s
    2219/     9E6 : 21 B7 10            	ld	hl, push_rp_s
    2220/     9E9 : ED B1               	cpir
    2221/     9EB : 20 0F               	jr	nz, chk_ex
    2222/     9ED :                     
    2223/     9ED :                     ; PUSH RP
    2224/     9ED :                     
    2225/     9ED : 11 78 11            	ld	de, PUSHstr
    2226/     9F0 : CD 0B 10            	call	mkopcstr
    2227/     9F3 :                     
    2228/     9F3 : 21 91 12            	ld	hl, POP_PUSHrp
    2229/     9F6 : CD 81 0F            	call	mk_str
    2230/     9F9 : C3 37 10            	jp	insPostStr	; CR, LF, 00h
    2231/     9FC :                     
    2232/     9FC :                     ; check EX XX, XX
    2233/     9FC :                     
    2234/     9FC :                     chk_ex:
    2235/     9FC : FE 08               	cp	08H		; EX	AF,AF'
    2236/     9FE : 28 17               	jr	z, ex_af_af
    2237/     A00 : FE E3               	cp	0E3H		; EX	(SP),HL
    2238/     A02 : 28 21               	jr	z, ex_sp_hl
    2239/     A04 : FE EB               	cp	0EBH		; EX	DE,HL
    2240/     A06 : 20 25               	jr	nz, chk_1mc_bnh
    2241/     A08 :                     
    2242/     A08 :                     ; EX DE, HL
    2243/     A08 : 11 62 1F            	ld	de, RNDE
    2244/     A0B : CD 5E 10            	call	mk_rcs
    2245/     A0E :                     
    2246/     A0E :                     ins_hl_opr:
    2247/     A0E : CD 31 10            	call	hl_crlf
    2248/     A11 :                     
    2249/     A11 :                     ins_ex_opc:
    2250/     A11 : 11 7D 11            	ld	de, EXstr
    2251/     A14 : C3 0B 10            	jp	mkopcstr
    2252/     A17 :                     
    2253/     A17 :                     ; EX AF,AF'
    2254/     A17 :                     ex_af_af:
    2255/     A17 : 11 27 11            	ld	de, RNAF
    2256/     A1A : CD 5E 10            	call	mk_rcs
    2257/     A1D : 11 2A 11            	ld	de, RNAFX
    2258/     A20 : CD 34 10            	call	cpstr_crlf
    2259/     A23 : 18 EC               	jr ins_ex_opc
    2260/     A25 :                     
    2261/     A25 :                     ; EX (SP),HL
    2262/     A25 :                     ex_sp_hl:
    2263/     A25 : 11 9C 1F            	ld	de, RNSP
    2264/     A28 : CD 4D 10            	call	mk_krkcs
    2265/     A2B : 18 E1               	jr	ins_hl_opr
    2266/     A2D :                     
    2267/     A2D :                     ; check other one MC code
    2268/     A2D :                     
    2269/     A2D :                     chk_1mc_bnh:
    2270/     A2D :                     
    2271/     A2D :                     ; check JP (HL)
    2272/     A2D :                     
    2273/     A2D : FE E9               	cp	0E9H		; JP (HL) ?
    2274/     A2F : 20 0F               	jr	nz, chk_ret
    2275/     A31 :                     
    2276/     A31 :                     ; JP (HL)
    2277/     A31 : 11 32 11            	ld	de, JPstr
    2278/     A34 : CD 0B 10            	call	mkopcstr	; "JP "
    2279/     A37 :                     
    2280/     A37 : 11 69 1F            	ld	de, RNHL
    2281/     A3A : CD 42 10            	call	mk_krk_1
    2282/     A3D : C3 37 10            	jp	insPostStr
    2283/     A40 :                     
    2284/     A40 :                     ; check RET CC
    2285/     A40 :                     chk_ret:
    2286/     A40 : 01 08 00            	ld	bc, RETCC_TBLE - RETCC_TBLS
    2287/     A43 : 21 7E 05            	ld	hl, RETCC_TBLS
    2288/     A46 : ED B1               	cpir
    2289/     A48 : 20 0F               	jr	nz, chk_rst
    2290/     A4A :                     
    2291/     A4A :                     ; RET CC
    2292/     A4A :                     ; BC : 7 >= BC >= 0
    2293/     A4A :                     
    2294/     A4A :                     	; make opcode string
    2295/     A4A : 11 2E 11            	ld	de, RETstr
    2296/     A4D : CD 0B 10            	call	mkopcstr
    2297/     A50 :                     
    2298/     A50 :                     	; make operand string
    2299/     A50 :                     
    2300/     A50 : 21 71 12            	ld	hl, CC_opr	; string base
    2301/     A53 : CD 81 0F            	call	mk_str
    2302/     A56 : C3 37 10            	jp	insPostStr	; CR, LF, 00h
    2303/     A59 :                     
    2304/     A59 :                     ; check RST p
    2305/     A59 :                     
    2306/     A59 :                     chk_rst:
    2307/     A59 : 01 08 00            	ld	bc, RST_TBLE - RST_TBLS
    2308/     A5C : 21 9B 05            	ld	hl, RST_TBLS
    2309/     A5F : ED B1               	cpir
    2310/     A61 : 20 17               	jr	nz, chk_2MC		; 2bytes MC
    2311/     A63 :                     
    2312/     A63 :                     ; RST p
    2313/     A63 :                     
    2314/     A63 : 11 42 11            	ld	de, RSTstr
    2315/     A66 : CD 0B 10            	call	mkopcstr	; de : next string buffer addr
    2316/     A69 :                     
    2317/     A69 :                     ; 0 <= BC <= 7
    2318/     A69 :                     ; 7: 00H  (0000 0 111 : 00 000 000)
    2319/     A69 :                     ; 6: 08H  (0000 0 110 : 00 001 000)
    2320/     A69 :                     ; 5: 10H  (0000 0 101 : 00 010 000)
    2321/     A69 :                     ; 4: 18H  (0000 0 100 : 00 011 000)
    2322/     A69 :                     ; 3: 20H  (0000 0 011 : 00 100 000)
    2323/     A69 :                     ; 2: 28H  (0000 0 010 : 00 101 000)
    2324/     A69 :                     ; 1: 30H  (0000 0 001 : 00 110 000)
    2325/     A69 :                     ; 0: 38H  (0000 0 000 : 00 111 000)
    2326/     A69 :                     ;
    2327/     A69 : 79                  	ld	a, c
    2328/     A6A : 2F                  	cpl		; not a
    2329/     A6B : CB 27               	sla	a
    2330/     A6D : CB 27               	sla	a
    2331/     A6F : CB 27               	sla	a
    2332/     A71 : E6 38               	and	38H	; a = RST No.
    2333/     A73 :                     
    2334/     A73 : 5F                  	ld	e, a
    2335/     A74 : 21 9F EF            	ld	hl, dasm_OprStr
    2336/     A77 : C3 96 0F            	jp	mk_n2crlf	; "nnH", CR, LF
    2337/     A7A :                     
    2338/     A7A :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2339/     A7A :                     	; analysys 2 byte MC
    2340/     A7A :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2341/     A7A :                     
    2342/     A7A :                     chk_2MC:
    2343/     A7A :                     
    2344/     A7A : F5                  	push	af
    2345/     A7B : 3E 02               	ld	a, 2
    2346/     A7D : 32 83 EF            	ld	(mc_Size), a
    2347/     A80 : F1                  	pop	af
    2348/     A81 :                     
    2349/     A81 :                     ; check LD r, nn
    2350/     A81 :                     
    2351/     A81 : 01 08 00            	ld	bc, ld_r_nn_e - ld_r_nn_s
    2352/     A84 : 21 3C 06            	ld	hl, ld_r_nn_s
    2353/     A87 : ED B1               	cpir
    2354/     A89 : 20 16               	jr	nz, chk_logop2
    2355/     A8B :                     
    2356/     A8B :                     ; LD r, nn
    2357/     A8B :                     
    2358/     A8B : CD 6F 08            	call	get_r_num
    2359/     A8E : CD 8A 0F            	call	get_rstg_off
    2360/     A91 : CD 5E 10            	call	mk_rcs		; "REG, "
    2361/     A94 :                     
    2362/     A94 : ED 5B 7D EF         	ld	de, (dasm_adr)
    2363/     A98 : 13                  	inc	de
    2364/     A99 : 1A                  	ld	a, (de)		; get nn
    2365/     A9A : 5F                  	ld	e, a
    2366/     A9B : CD D9 0F            	call	hex2str_asm	; "nnH"
    2367/     A9E : C3 37 10            	jp	insPostStr	; CR, LF, 00h
    2368/     AA1 :                     
    2369/     AA1 :                     ; check logical operation with 8 bit literal
    2370/     AA1 :                     
    2371/     AA1 :                     chk_logop2:
    2372/     AA1 :                     
    2373/     AA1 : 01 0A 00            	ld	bc, log_op_e - log_op_s
    2374/     AA4 : 21 44 06            	ld	hl, log_op_s
    2375/     AA7 : ED B1               	cpir
    2376/     AA9 : C2 F5 0A            	jp	nz, chk_djnz
    2377/     AAC :                     
    2378/     AAC :                     ; logical operation with 8 bit literal
    2379/     AAC :                     
    2380/     AAC :                     
    2381/     AAC : C5                  	push	bc
    2382/     AAD : 21 B3 12            	ld	hl, logop2str
    2383/     AB0 : CD 8D 0F            	call	get_strBufpoint
    2384/     AB3 : CD 0B 10            	call	mkopcstr		; make op code string
    2385/     AB6 : C1                  	pop	bc
    2386/     AB7 : 79                  	ld	a, c
    2387/     AB8 :                     
    2388/     AB8 : FE 01               	cp	1
    2389/     ABA : 28 14               	jr	z, acs_kn2k	; insert "A, (nn)"
    2390/     ABC : B7                  	or	a
    2391/     ABD : 28 1A               	jr	z, ins_kn2k	; insert "(nn), A"
    2392/     ABF : FE 07               	cp	7
    2393/     AC1 : 38 03               	jr	c, ins_n2crlf	; insert  "nnH"
    2394/     AC3 :                     
    2395/     AC3 :                     ; insert "A, "
    2396/     AC3 :                     
    2397/     AC3 : CD 5B 10            	call	a_colon_sp
    2398/     AC6 :                     
    2399/     AC6 :                     ; "nn"
    2400/     AC6 :                     ins_n2crlf:
    2401/     AC6 : ED 5B 7D EF         	ld	de, (dasm_adr)
    2402/     ACA : 13                  	inc	de
    2403/     ACB : 1A                  	ld	a, (de)
    2404/     ACC : 5F                  	ld	e, a		; get nn
    2405/     ACD : C3 96 0F            	jp	mk_n2crlf	; "nnH", CR, LF
    2406/     AD0 :                     
    2407/     AD0 :                     acs_kn2k:
    2408/     AD0 : CD 5B 10            	call	a_colon_sp	; "A, "
    2409/     AD3 : CD E5 0A            	call	kn2k		; "(nnH)"
    2410/     AD6 : C3 37 10            	jp	insPostStr	; CR, LF, 00h
    2411/     AD9 :                     
    2412/     AD9 :                     ; "(nn), A"
    2413/     AD9 :                     ins_kn2k:
    2414/     AD9 : 21 9F EF            	ld	hl, dasm_OprStr	;operand str buffer
    2415/     ADC : CD E5 0A            	call	kn2k		; "(nnH)"
    2416/     ADF : CD 83 10            	call	ins_kmR		; " ,"
    2417/     AE2 : C3 26 10            	jp	a_crlf		; "A", CR, LF, 00h
    2418/     AE5 :                     
    2419/     AE5 :                     ; "(nnH)"
    2420/     AE5 :                     kn2k:
    2421/     AE5 : CD 6E 10            	call	ins_kakkoL	; "("
    2422/     AE8 : ED 5B 7D EF         	ld	de, (dasm_adr)
    2423/     AEC : 13                  	inc	de
    2424/     AED : 1A                  	ld	a, (de)		; get nn
    2425/     AEE : 5F                  	ld	e, a		; e: nn
    2426/     AEF : CD D9 0F            	call	hex2str_asm	; hex strings
    2427/     AF2 : C3 72 10            	jp	ins_kakkoR	; ")"
    2428/     AF5 :                     
    2429/     AF5 :                     
    2430/     AF5 :                     ; check DJNZ nn
    2431/     AF5 :                     chk_djnz:
    2432/     AF5 : FE 10               	cp	10H
    2433/     AF7 : 20 05               	jr	nz, chk_jrnn
    2434/     AF9 :                     
    2435/     AF9 :                     ; check DJNZ nn
    2436/     AF9 : 11 38 11            	ld	de, DJNZstr
    2437/     AFC : 18 07               	jr	jr_n4crlf
    2438/     AFE :                     
    2439/     AFE :                     ; check jr nn
    2440/     AFE :                     chk_jrnn:
    2441/     AFE : FE 18               	cp	18H
    2442/     B00 : 20 0C               	jr	nz, chk_jrcc	; not JR relative
    2443/     B02 :                     
    2444/     B02 :                     ; JR Relative
    2445/     B02 : 11 35 11            	ld	de, JRstr
    2446/     B05 :                     jr_n4crlf:
    2447/     B05 : CD 0B 10            	call	mkopcstr	; de : next string buffer addr
    2448/     B08 : 21 9F EF            	ld	hl, dasm_OprStr
    2449/     B0B : C3 BA 0F            	jp	mkRel_str	; "nnnnH",cr,lf : nnnn : branch address
    2450/     B0E :                     
    2451/     B0E :                     ; JR CC, nn
    2452/     B0E :                     
    2453/     B0E :                     chk_jrcc:
    2454/     B0E : 01 04 00            	ld	bc, JRCC_TBLE - JRCC_TBLS1
    2455/     B11 : 21 87 05            	ld	hl, JRCC_TBLS1
    2456/     B14 : ED B1               	cpir
    2457/     B16 : 20 12               	jr	nz, chk_3MC	; no, check 3 bnytes MC
    2458/     B18 :                     
    2459/     B18 :                     ; JR CC, nn(Relative Value)
    2460/     B18 :                     
    2461/     B18 : 11 35 11            	ld	de, JRstr
    2462/     B1B : CD 0B 10            	call	mkopcstr
    2463/     B1E : 21 81 12            	ld	hl, JRCC_opr1	; string base
    2464/     B21 : CD 81 0F            	call	mk_str		; "NZ", "Z", "NC", "C"
    2465/     B24 : CD 83 10            	call	ins_kmR		; ", "
    2466/     B27 : C3 BA 0F            	jp	mkRel_str	; "nnnnH", cr, lf
    2467/     B2A :                     
    2468/     B2A :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2469/     B2A :                     	; analysys 3 byte MC
    2470/     B2A :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2471/     B2A :                     
    2472/     B2A :                     chk_3MC:
    2473/     B2A : F5                  	push	af
    2474/     B2B : 3E 03               	ld	a, 3
    2475/     B2D : 32 83 EF            	ld	(mc_Size), a
    2476/     B30 : F1                  	pop	af
    2477/     B31 :                     
    2478/     B31 : 01 04 00            	ld	bc, THREE_OPTBLe - THREE_OPTBL
    2479/     B34 : 21 4E 06            	ld	hl, THREE_OPTBL
    2480/     B37 : ED B1               	cpir
    2481/     B39 : C2 4B 0B            	jp	nz, chk_ld16
    2482/     B3C :                     
    2483/     B3C :                     ; LD rp, nnnn
    2484/     B3C :                     
    2485/     B3C : 21 C7 12            	ld	hl, logop3str
    2486/     B3F : CD 8D 0F            	call	get_strBufpoint
    2487/     B42 : CD 5E 10            	call	mk_rcs		; "Reg, "
    2488/     B45 :                     
    2489/     B45 :                     get_n4crlf:
    2490/     B45 : CD 73 0B            	call	get_n4
    2491/     B48 : C3 9C 0F            	jp	mk_n4crlf	; "nnnnH", CR, LF, 00h
    2492/     B4B :                     
    2493/     B4B :                     ; LD 16bit literal
    2494/     B4B :                     chk_ld16:
    2495/     B4B : FE 22               	cp	22h
    2496/     B4D : 28 12               	jr	z, ins_kkhl	; "(nnnnH), HL"
    2497/     B4F : FE 32               	cp	32h
    2498/     B51 : 28 14               	jr	z, ins_kka	; "(nnnnH), A"
    2499/     B53 : FE 2A               	cp	2ah
    2500/     B55 : 28 26               	jr	z, ins_hlkk	; "HL, (nnnnH)"
    2501/     B57 : FE 3A               	cp	3ah
    2502/     B59 : C2 8C 0B            	jp	nz, chk_jpn4	; check jp n4
    2503/     B5C :                     
    2504/     B5C :                     ; "A, (nnnnH)"
    2505/     B5C : CD 5B 10            	call	a_colon_sp	; "A, "
    2506/     B5F : 18 22               	jr	kn4kcrlf
    2507/     B61 :                     
    2508/     B61 :                     ; "(nnnnH), HL"
    2509/     B61 :                     ins_kkhl:
    2510/     B61 : CD 6D 0B            	call	kn4hk
    2511/     B64 : C3 31 10            	jp	hl_crlf		; "HL",cr,lf
    2512/     B67 :                     
    2513/     B67 :                     ; "(nnnnH), A"
    2514/     B67 :                     ins_kka:
    2515/     B67 : CD 6D 0B            	call	kn4hk
    2516/     B6A : C3 26 10            	jp	a_crlf		; "A",cr,lf
    2517/     B6D :                     
    2518/     B6D :                     kn4hk:
    2519/     B6D : CD 73 0B            	call	get_n4
    2520/     B70 : C3 A2 0F            	jp	ins_kn4kcs	; "(nnnnH), "
    2521/     B73 :                     
    2522/     B73 :                     get_n4:
    2523/     B73 : E5                  	push	hl
    2524/     B74 : 2A 7D EF            	ld	hl, (dasm_adr)
    2525/     B77 : 23                  	inc	hl
    2526/     B78 : 5E                  	ld	e, (hl)
    2527/     B79 : 23                  	inc	hl
    2528/     B7A : 56                  	ld	d, (hl)
    2529/     B7B : E1                  	pop	hl
    2530/     B7C : C9                  	ret
    2531/     B7D :                     
    2532/     B7D :                     ; "HL, (nnnnH)"
    2533/     B7D :                     ins_hlkk:
    2534/     B7D : 11 69 1F            	ld	de, RNHL
    2535/     B80 : CD 5E 10            	call	mk_rcs		; "HL ,"
    2536/     B83 :                     
    2537/     B83 :                     kn4kcrlf:
    2538/     B83 : CD 73 0B            	call	get_n4
    2539/     B86 : CD B1 0F            	call	mk_kn4k		; "(nnnnH)"
    2540/     B89 : C3 37 10            	jp	insPostStr	; cr, lf
    2541/     B8C :                     
    2542/     B8C :                     ; check JP literal
    2543/     B8C :                     
    2544/     B8C :                     chk_jpn4:
    2545/     B8C : FE C3               	cp	0C3H		; JP literal ?
    2546/     B8E : 20 08               	jr	nz, chk_calln4	; not JP literal
    2547/     B90 :                     
    2548/     B90 :                     ; "JP nnnnH"
    2549/     B90 :                     
    2550/     B90 : 11 32 11            	ld	de, JPstr
    2551/     B93 : CD 0B 10            	call	mkopcstr	; de : next string buffer addr
    2552/     B96 : 18 AD               	jr	get_n4crlf
    2553/     B98 :                     
    2554/     B98 :                     ; check call literal
    2555/     B98 :                     
    2556/     B98 :                     chk_calln4:
    2557/     B98 : FE CD               	cp	0CDH		; CALL literal ?
    2558/     B9A : 20 08               	jr	nz, chk_jpcc
    2559/     B9C :                     
    2560/     B9C :                     ; "CALL nnnnH",cr,lf
    2561/     B9C :                     
    2562/     B9C : 11 3D 11            	ld	de, CALLstr
    2563/     B9F : CD 0B 10            	call	mkopcstr	; de : next string buffer addr
    2564/     BA2 : 18 A1               	jr	get_n4crlf
    2565/     BA4 :                     
    2566/     BA4 :                     
    2567/     BA4 :                     ; check 3 byte machine code: branch JP CC, nnnn
    2568/     BA4 :                     
    2569/     BA4 :                     chk_jpcc:
    2570/     BA4 : 01 08 00            	ld	bc, JPCC_TBLE - JPCC_TBLS
    2571/     BA7 : 21 8B 05            	ld	hl, JPCC_TBLS
    2572/     BAA : ED B1               	cpir
    2573/     BAC : 20 11               	jr	nz, chk_calcc
    2574/     BAE :                     
    2575/     BAE :                     ; JP CC, nnnn
    2576/     BAE :                     ; BC : 7 >= BC >= 0
    2577/     BAE :                     
    2578/     BAE : 11 32 11            	ld	de, JPstr
    2579/     BB1 :                     
    2580/     BB1 :                     CC_NNNN:
    2581/     BB1 : CD 0B 10            	call	mkopcstr	; de : next string buffer addr
    2582/     BB4 :                     
    2583/     BB4 : 21 71 12            	ld	hl, CC_opr	; string base
    2584/     BB7 : CD 81 0F            	call	mk_str		; de: point (string end) + 1
    2585/     BBA : CD 83 10            	call	ins_kmR		; " ,"
    2586/     BBD : 18 86               	jr	get_n4crlf	; "nnnnh", cr,lf
    2587/     BBF :                     
    2588/     BBF :                     
    2589/     BBF :                     ; check 3 byte machine code: branch (CALL CC, nnnn 16bit literal)
    2590/     BBF :                     
    2591/     BBF :                     chk_calcc:
    2592/     BBF : 01 08 00            	ld	bc, CLCC_TBLE - CLCC_TBLS
    2593/     BC2 : 21 93 05            	ld	hl, CLCC_TBLS
    2594/     BC5 : ED B1               	cpir
    2595/     BC7 : 20 05               	jr	nz, chk_0CBH
    2596/     BC9 :                     
    2597/     BC9 :                     ; CALL CC, nnnn
    2598/     BC9 :                     ; BC : 7 >= BC >= 0 CALLstr
    2599/     BC9 :                     
    2600/     BC9 : 11 3D 11            	ld	de, CALLstr
    2601/     BCC : 18 E3               	jr	CC_NNNN
    2602/     BCE :                     
    2603/     BCE :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2604/     BCE :                     	; OPECODE 0CBH check
    2605/     BCE :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2606/     BCE :                     
    2607/     BCE :                     chk_0CBH:
    2608/     BCE : 2A 7D EF            	ld	hl, (dasm_adr)
    2609/     BD1 : 23                  	inc	hl		; 2nd opecode address
    2610/     BD2 :                     
    2611/     BD2 : F5                  	push	af
    2612/     BD3 : 3E 02               	ld	a, 2
    2613/     BD5 : 32 83 EF            	ld	(mc_Size), a	; set 2bytes MC
    2614/     BD8 : F1                  	pop	af
    2615/     BD9 :                     
    2616/     BD9 : FE CB               	cp	0cbh
    2617/     BDB : C2 94 0C            	jp	nz, chk_0DDH
    2618/     BDE :                     
    2619/     BDE : 7E                  	ld	a, (hl)		; a : 2nd opecode
    2620/     BDF : 21 9F EF            	ld	hl, dasm_OprStr ; set operand string buffer
    2621/     BE2 :                     
    2622/     BE2 : FE 08               	cp	08h
    2623/     BE4 : DA 1D 0C            	jp	c, mk_rlcr
    2624/     BE7 : FE 10               	cp	10h
    2625/     BE9 : DA 26 0C            	jp	c, mk_rrcr
    2626/     BEC : FE 18               	cp	18h
    2627/     BEE : DA 2F 0C            	jp	c, mk_rlr
    2628/     BF1 : FE 20               	cp	20h
    2629/     BF3 : DA 38 0C            	jp	c, mk_rrr
    2630/     BF6 : FE 28               	cp	28h
    2631/     BF8 : DA 41 0C            	jp	c, mk_slar
    2632/     BFB : FE 30               	cp	30h
    2633/     BFD : DA 4A 0C            	jp	c, mk_srar
    2634/     C00 : FE 38               	cp	38h
    2635/     C02 : DA 6E 0C            	jp	c, op_err
    2636/     C05 : FE 40               	cp	40h
    2637/     C07 : DA 53 0C            	jp	c, mk_srlr
    2638/     C0A : FE 80               	cp	80h
    2639/     C0C : DA 5C 0C            	jp	c, mk_bitr
    2640/     C0F : FE C0               	cp	0c0h
    2641/     C11 : DA 65 0C            	jp	c, mk_resr
    2642/     C14 :                     
    2643/     C14 :                     ; make SET n, r, SET n, (HL)
    2644/     C14 :                     
    2645/     C14 : CD 74 0C            	call	mk_bitr_str
    2646/     C17 : 11 3C 12            	ld	de, SETstr
    2647/     C1A : C3 0B 10            	jp	mkopcstr
    2648/     C1D :                     
    2649/     C1D :                     
    2650/     C1D :                     ; make RLC r, RLC (HL)
    2651/     C1D :                     mk_rlcr:
    2652/     C1D : CD 79 0C            	call	ins_rstg
    2653/     C20 : 11 B7 11            	ld	de, RLCstr
    2654/     C23 : C3 0B 10            	jp	mkopcstr
    2655/     C26 :                     
    2656/     C26 :                     ; make RRC r, RRC (HL)
    2657/     C26 :                     mk_rrcr:
    2658/     C26 : CD 79 0C            	call	ins_rstg
    2659/     C29 : 11 BB 11            	ld	de, RRCstr
    2660/     C2C : C3 0B 10            	jp	mkopcstr
    2661/     C2F :                     
    2662/     C2F :                     ; make RL r, RL (HL)
    2663/     C2F :                     mk_rlr:
    2664/     C2F : CD 79 0C            	call	ins_rstg
    2665/     C32 : 11 BF 11            	ld	de, RLstr
    2666/     C35 : C3 0B 10            	jp	mkopcstr
    2667/     C38 :                     
    2668/     C38 :                     ; make RR r, RR (HL)
    2669/     C38 :                     mk_rrr:
    2670/     C38 : CD 79 0C            	call	ins_rstg
    2671/     C3B : 11 C2 11            	ld	de, RRstr
    2672/     C3E : C3 0B 10            	jp	mkopcstr
    2673/     C41 :                     
    2674/     C41 :                     ; make SLA r, SLA (HL)
    2675/     C41 :                     mk_slar:
    2676/     C41 : CD 79 0C            	call	ins_rstg
    2677/     C44 : 11 C5 11            	ld	de, SLAstr
    2678/     C47 : C3 0B 10            	jp	mkopcstr
    2679/     C4A :                     
    2680/     C4A :                     ; make SRA r, SRA (HL)
    2681/     C4A :                     mk_srar:
    2682/     C4A : CD 79 0C            	call	ins_rstg
    2683/     C4D : 11 3C 12            	ld	de, SETstr
    2684/     C50 : C3 0B 10            	jp	mkopcstr
    2685/     C53 :                     
    2686/     C53 :                     ; make SRL r, SRL (HL)
    2687/     C53 :                     mk_srlr:
    2688/     C53 : CD 79 0C            	call	ins_rstg
    2689/     C56 : 11 CD 11            	ld	de, SRLstr
    2690/     C59 : C3 0B 10            	jp	mkopcstr
    2691/     C5C :                     
    2692/     C5C :                     ; make BIT n, r, BIT n, (HL)
    2693/     C5C :                     mk_bitr:
    2694/     C5C : CD 74 0C            	call	mk_bitr_str
    2695/     C5F : 11 D1 11            	ld	de, BITstr
    2696/     C62 : C3 0B 10            	jp	mkopcstr
    2697/     C65 :                     
    2698/     C65 :                     ; make RES n, r, RES n, (HL)
    2699/     C65 :                     mk_resr:
    2700/     C65 : CD 74 0C            	call	mk_bitr_str
    2701/     C68 : 11 D5 11            	ld	de, RESstr
    2702/     C6B : C3 0B 10            	jp	mkopcstr
    2703/     C6E :                     
    2704/     C6E :                     op_err:
    2705/     C6E : 11 40 12            	ld	de, ER_OPMSG
    2706/     C71 : C3 0B 10            	jp	mkopcstr
    2707/     C74 :                     
    2708/     C74 :                     ;-------------------------------------------
    2709/     C74 :                     ; input a : 2nd opecode
    2710/     C74 :                     ;	hl : make string buffer
    2711/     C74 :                     ; make "bit No, r" string to *hl
    2712/     C74 :                     ; (ex) *hl = "1, B"
    2713/     C74 :                     ;-------------------------------------------
    2714/     C74 :                     mk_bitr_str:
    2715/     C74 : F5                  	push	af
    2716/     C75 : CD 86 0C            	call	set_bitno
    2717/     C78 : F1                  	pop	af
    2718/     C79 :                     
    2719/     C79 :                     ins_rstg:
    2720/     C79 : E6 07               	and	07h
    2721/     C7B : 4F                  	ld	c, a	; table offset
    2722/     C7C : 06 00               	ld	b, 0		; bc : string offset
    2723/     C7E : E5                  	push	hl
    2724/     C7F : CD 8A 0F            	call	get_rstg_off	; get string address to de
    2725/     C82 : E1                  	pop	hl
    2726/     C83 : C3 34 10            	jp	cpstr_crlf	; "REG", CR, LF, 00h
    2727/     C86 :                     ;
    2728/     C86 :                     ; input hl : make string buffer
    2729/     C86 :                     ;
    2730/     C86 :                     set_bitno:
    2731/     C86 : E6 38               	and	38h
    2732/     C88 : 0F                  	rrca
    2733/     C89 : 0F                  	rrca
    2734/     C8A : 0F                  	rrca
    2735/     C8B : 47                  	ld	b, a	; bit number
    2736/     C8C :                     
    2737/     C8C : 3E 30               	ld	a, 30h
    2738/     C8E : B0                  	or	b		; a : bit string "0" - "7"
    2739/     C8F : 77                  	ld	(hl), a
    2740/     C90 : 23                  	inc	hl
    2741/     C91 : C3 83 10            	jp	ins_kmR
    2742/     C94 :                     
    2743/     C94 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2744/     C94 :                     	; OPECODE 0DDH check
    2745/     C94 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2746/     C94 :                     
    2747/     C94 :                     chk_0DDH:
    2748/     C94 : FE DD               	cp	0ddh
    2749/     C96 : C2 3A 0E            	jp	nz, chk_0EDH
    2750/     C99 :                     
    2751/     C99 : 11 96 1F            	ld	de, RNIX
    2752/     C9C : ED 53 7F EF         	ld	(reg_xy), de	; save index reg string
    2753/     CA0 : 11 E3 12            	ld	de, addixrp_tbl
    2754/     CA3 : ED 53 81 EF         	ld	(xy_srtp), de
    2755/     CA7 :                     
    2756/     CA7 :                     chk_0DDH_1:
    2757/     CA7 :                     
    2758/     CA7 : 7E                  	ld	a, (hl)		; get 2nd opcode
    2759/     CA8 :                     
    2760/     CA8 : FE E3               	cp	0E3h	; EX (SP),IX
    2761/     CAA : CA EE 0C            	jp	z, ins_kspkix
    2762/     CAD : FE E9               	cp	0E9h	; JP (IX)
    2763/     CAF : CA DC 0C            	jp	z, ins_jpix
    2764/     CB2 : FE F9               	cp	0F9h	; LD SP, IX
    2765/     CB4 : CA FD 0C            	jp	z, ins_spix
    2766/     CB7 :                     
    2767/     CB7 : 01 04 00            	ld	bc, DD_2NDTBL1 - DD_2NDTBL
    2768/     CBA : 21 56 06            	ld	hl, DD_2NDTBL
    2769/     CBD : ED B1               	cpir
    2770/     CBF : CA 06 0D            	jp	z, ins_ixrp
    2771/     CC2 :                     
    2772/     CC2 : 01 04 00            	ld	bc, DD_2NDTBL2 - DD_2NDTBL1
    2773/     CC5 : 21 5A 06            	ld	hl, DD_2NDTBL1
    2774/     CC8 : ED B1               	cpir
    2775/     CCA : C2 1B 0D            	jp	nz, chk_0DD3op
    2776/     CCD :                     
    2777/     CCD :                     ; INC	IX
    2778/     CCD :                     ; DEC	IX
    2779/     CCD :                     ; PUSH	IX
    2780/     CCD :                     ; POP	IX
    2781/     CCD : 21 DB 12            	ld	hl, dd_2opt
    2782/     CD0 : CD 8D 0F            	call	get_strBufpoint
    2783/     CD3 : CD 0B 10            	call	mkopcstr		; inseert OPCODE strings to dasm_OpcStr
    2784/     CD6 :                     
    2785/     CD6 : 21 9F EF            	ld	hl, dasm_OprStr
    2786/     CD9 : C3 2B 10            	jp	ix_crlf			; "IX", CR, LF, 00h
    2787/     CDC :                     
    2788/     CDC :                     ; JP	(IX)
    2789/     CDC :                     ins_jpix:
    2790/     CDC : ED 5B 7F EF         	ld	de, (reg_xy)
    2791/     CE0 :                     ins_jpix1:
    2792/     CE0 : D5                  	push	de
    2793/     CE1 : 11 32 11            	ld	de, JPstr
    2794/     CE4 : CD 0B 10            	call	mkopcstr	; de : next string buffer addr
    2795/     CE7 :                     
    2796/     CE7 : D1                  	pop	de
    2797/     CE8 : CD 42 10            	call	mk_krk_1
    2798/     CEB : C3 37 10            	jp	insPostStr	; CR, LF, 00h
    2799/     CEE :                     
    2800/     CEE :                     ; EX	(SP),IX
    2801/     CEE :                     ins_kspkix:
    2802/     CEE : 11 7D 11            	ld	de, EXstr
    2803/     CF1 : CD 0B 10            	call	mkopcstr	; de : next string buffer addr
    2804/     CF4 : 11 9C 1F            	ld	de, RNSP
    2805/     CF7 : CD 4D 10            	call	mk_krkcs	; "(SP), "
    2806/     CFA : C3 2B 10            	jp	ix_crlf		; "IX",cr,lf
    2807/     CFD :                     
    2808/     CFD :                     ; LD	SP,IX
    2809/     CFD :                     ins_spix:
    2810/     CFD : 11 9C 1F            	ld	de, RNSP
    2811/     D00 : CD 5E 10            	call	mk_rcs		; "SP, "
    2812/     D03 : C3 2B 10            	jp	ix_crlf		; "IX",cr,lf
    2813/     D06 :                     
    2814/     D06 :                     ; ADD	IX,BC
    2815/     D06 :                     ; ADD	IX,DE
    2816/     D06 :                     ; ADD	IX,IX
    2817/     D06 :                     ; ADD	IX,SP
    2818/     D06 :                     ins_ixrp:
    2819/     D06 : CD 08 10            	call	add_opstr	; de : next string buffer addr
    2820/     D09 :                     
    2821/     D09 : ED 5B 7F EF         	ld	de, (reg_xy)
    2822/     D0D : CD 5E 10            	call	mk_rcs		; "IX, "
    2823/     D10 :                     
    2824/     D10 : E5                  	push	hl
    2825/     D11 : 2A 81 EF            	ld	hl, (xy_srtp)
    2826/     D14 : CD 8D 0F            	call	get_strBufpoint
    2827/     D17 : E1                  	pop	hl
    2828/     D18 : C3 34 10            	jp	cpstr_crlf	; "REG",cr,lf
    2829/     D1B :                     
    2830/     D1B :                     ;
    2831/     D1B :                     ; check 0DD 3bytes MC
    2832/     D1B :                     ;
    2833/     D1B :                     chk_0DD3op:
    2834/     D1B : F5                  	push	af
    2835/     D1C : 3E 03               	ld	a, 3
    2836/     D1E : 32 83 EF            	ld	(mc_Size), a	; 2byte machine code
    2837/     D21 : F1                  	pop	af
    2838/     D22 :                     
    2839/     D22 : 01 0E 00            	ld	bc, dd_ld_tble - dd_ld_tbl
    2840/     D25 : 21 BB 10            	ld	hl, dd_ld_tbl
    2841/     D28 : ED B1               	cpir
    2842/     D2A : CA 5A 0D            	jp	z, dd_ld
    2843/     D2D :                     
    2844/     D2D : FE 86               	cp	86h
    2845/     D2F : CA 85 0D            	jp	z, dd_mix
    2846/     D32 : FE 8E               	cp	8eh
    2847/     D34 : CA 90 0D            	jp	z, dd_mix1
    2848/     D37 : FE 9E               	cp	9eh
    2849/     D39 : CA 95 0D            	jp	z, dd_mix2
    2850/     D3C :                     
    2851/     D3C : 01 07 00            	ld	bc, dd_log_tble - dd_log_tbl
    2852/     D3F : 21 C9 10            	ld	hl, dd_log_tbl
    2853/     D42 : ED B1               	cpir
    2854/     D44 : C2 9A 0D            	jp	nz, chk_0DD4op
    2855/     D47 :                     
    2856/     D47 :                     ;
    2857/     D47 :                     ; make "SUB (IX+nn)", "AND (IX+nn)", "XOR (IX+nn)"
    2858/     D47 :                     ;       "OR (IX+nn)",  "CP (IX+nn)"
    2859/     D47 :                     ;      "INC (IX+nn)", "DEC (IX+nn)"
    2860/     D47 :                     ;
    2861/     D47 : 21 F3 12            	ld	hl, ddlogtbl
    2862/     D4A : CD 8D 0F            	call	get_strBufpoint
    2863/     D4D : CD 0B 10            	call	mkopcstr
    2864/     D50 :                     
    2865/     D50 :                     mk_kixpnk:
    2866/     D50 : ED 5B 7F EF         	ld	de, (reg_xy)
    2867/     D54 :                     
    2868/     D54 :                     mk_kiypnk:
    2869/     D54 : 21 9F EF            	ld	hl, dasm_OprStr
    2870/     D57 : C3 51 0F            	jp	kixypnk_crlf		; "(IX+nnH)",cr,lf
    2871/     D5A :                     
    2872/     D5A :                     ;
    2873/     D5A :                     ; make "LD (IX+nn), r" or "LD r, (IX+nn)"
    2874/     D5A :                     ;
    2875/     D5A :                     dd_ld:
    2876/     D5A : 79                  	ld	a, c
    2877/     D5B : FE 07               	cp	7
    2878/     D5D : D2 72 0D            	jp	nc, dd_ld1
    2879/     D60 :                     	
    2880/     D60 :                     ; LD (IX+nn), r
    2881/     D60 : ED 5B 7F EF         	ld	de, (reg_xy)
    2882/     D64 : CD 48 0F            	call	kixypnk_cs	; make "(IX+nn), "
    2883/     D67 :                     
    2884/     D67 : E5                  	push	hl
    2885/     D68 : 21 01 13            	ld	hl, dd_ldtbl
    2886/     D6B : CD 8D 0F            	call	get_strBufpoint
    2887/     D6E : E1                  	pop	hl
    2888/     D6F : C3 34 10            	jp	cpstr_crlf	; "A", "L", "H", "E", D", "C", "B"
    2889/     D72 :                     				; CR, LF, 00h
    2890/     D72 :                     	
    2891/     D72 :                     ; LD r, (IX+nn)
    2892/     D72 :                     dd_ld1:
    2893/     D72 : D6 07               	sub	7
    2894/     D74 : 4F                  	ld	c, a
    2895/     D75 : 21 01 13            	ld	hl, dd_ldtbl
    2896/     D78 : CD 8D 0F            	call	get_strBufpoint
    2897/     D7B :                     
    2898/     D7B : CD 5E 10            	call	mk_rcs		; "REG, "
    2899/     D7E :                     dd_mix4:
    2900/     D7E : ED 5B 7F EF         	ld	de, (reg_xy)
    2901/     D82 : C3 51 0F            	jp	kixypnk_crlf	; "(IX+nn)", CR, LF, 00h
    2902/     D85 :                     
    2903/     D85 :                     
    2904/     D85 :                     ; "ADD A,(IX+nn)"
    2905/     D85 :                     dd_mix:
    2906/     D85 : 11 4E 11            	ld	de, ADDstr
    2907/     D88 :                     dd_mix3:
    2908/     D88 : CD 0B 10            	call	mkopcstr	; "ADD"
    2909/     D8B : CD 5B 10            	call	a_colon_sp	; "A, "
    2910/     D8E : 18 EE               	jr	dd_mix4		; "(IX+nn)",cr,lf
    2911/     D90 :                     
    2912/     D90 :                     ;"ADC A,(IX+nn)"
    2913/     D90 :                     dd_mix1:
    2914/     D90 : 11 52 11            	ld	de, ADCstr
    2915/     D93 : 18 F3               	jr	dd_mix3
    2916/     D95 :                     
    2917/     D95 :                     ;"SBC A,(IX+nn)"
    2918/     D95 :                     dd_mix2:
    2919/     D95 : 11 5A 11            	ld	de, SBCstr
    2920/     D98 : 18 EE               	jr	dd_mix3
    2921/     D9A :                     
    2922/     D9A :                     ;
    2923/     D9A :                     ; check 0DD 4bytes MC
    2924/     D9A :                     ;
    2925/     D9A :                     chk_0DD4op:
    2926/     D9A : F5                  	push	af
    2927/     D9B : 3E 04               	ld	a, 4
    2928/     D9D : 32 83 EF            	ld	(mc_Size), a	; 2byte machine code
    2929/     DA0 : F1                  	pop	af
    2930/     DA1 :                     
    2931/     DA1 : FE 21               	cp	21h
    2932/     DA3 : CA C0 0D            	jp	z, DD_21
    2933/     DA6 : FE 22               	cp	22h
    2934/     DA8 : CA CD 0D            	jp	z, DD_22
    2935/     DAB : FE 2A               	cp	2ah
    2936/     DAD : CA D6 0D            	jp	z, DD_2a
    2937/     DB0 : FE 36               	cp	36h
    2938/     DB2 : C2 E6 0D            	jp	nz, chk_DD_CB
    2939/     DB5 :                     ; DD 36
    2940/     DB5 :                     ; "LD (IX+xx), yy"
    2941/     DB5 :                     
    2942/     DB5 : ED 5B 7F EF         	ld	de, (reg_xy)
    2943/     DB9 : CD 48 0F            	call	kixypnk_cs	; "(IX+xx), "
    2944/     DBC : 5A                  	ld	e, d		; e: yy
    2945/     DBD : C3 96 0F            	jp	mk_n2crlf	; "0yyH",cr,lf
    2946/     DC0 :                     
    2947/     DC0 :                     
    2948/     DC0 :                     ; "LD IX, nnnn"
    2949/     DC0 :                     DD_21:
    2950/     DC0 : ED 5B 7F EF         	ld	de, (reg_xy)
    2951/     DC4 : CD 5E 10            	call	mk_rcs		; "IX, "
    2952/     DC7 : CD 76 0F            	call	get_nnnn
    2953/     DCA : C3 9C 0F            	jp	mk_n4crlf	; "nnnnH",cr,lf
    2954/     DCD :                     
    2955/     DCD :                     ; "LD (nnnn), IX"
    2956/     DCD :                     DD_22:
    2957/     DCD : CD 76 0F            	call	get_nnnn
    2958/     DD0 : CD A2 0F            	call	ins_kn4kcs	; "(nnnnH), "
    2959/     DD3 : C3 2B 10            	jp	ix_crlf		; "IX",cr,lf
    2960/     DD6 :                     
    2961/     DD6 :                     ; "LD IX, (nnnn)"
    2962/     DD6 :                     DD_2a:
    2963/     DD6 : ED 5B 7F EF         	ld	de, (reg_xy)
    2964/     DDA :                     DD_2a1:
    2965/     DDA : CD 5E 10            	call	mk_rcs		; "IX, "
    2966/     DDD : CD 76 0F            	call	get_nnnn
    2967/     DE0 : CD B1 0F            	call	mk_kn4k		; "(nnnnH)"
    2968/     DE3 : C3 37 10            	jp	insPostStr	; cr,lf
    2969/     DE6 :                     
    2970/     DE6 :                     chk_DD_CB
    2971/     DE6 : FE CB               	cp	0CBH
    2972/     DE8 : C2 6E 0C            	jp	nz, op_err
    2973/     DEB :                     
    2974/     DEB : CD 76 0F            	call	get_nnnn	; d: 3rd OP, e:nn
    2975/     DEE : 7A                  	ld	a, d
    2976/     DEF :                     
    2977/     DEF : 01 07 00            	ld	bc, dd_rt_tble - dd_rt_tbles
    2978/     DF2 : 21 D0 10            	ld	hl, dd_rt_tbles
    2979/     DF5 : ED B1               	cpir
    2980/     DF7 : C2 06 0E            	jp	nz, DD_CB_nn_XX
    2981/     DFA :                     
    2982/     DFA : 21 39 13            	ld	hl, dd_rt_str
    2983/     DFD : CD 8D 0F            	call	get_strBufpoint
    2984/     E00 : CD 0B 10            	call	mkopcstr	; RLC, RRC, RL, RR, SLA, SRA, SRL
    2985/     E03 : C3 50 0D            	jp	mk_kixpnk	; "(IX+nnH)",cr,lf
    2986/     E06 :                     
    2987/     E06 :                     ; check BIT, RES, SET
    2988/     E06 :                     DD_CB_nn_XX:
    2989/     E06 :                     
    2990/     E06 :                     	; check undefine MC
    2991/     E06 : 01 18 00            	ld	bc, dd_bit_opTble - dd_bit_opTbl
    2992/     E09 : 21 D7 10            	ld	hl, dd_bit_opTbl
    2993/     E0C : ED B1               	cpir
    2994/     E0E : C2 6E 0C            	jp	nz, op_err
    2995/     E11 :                     
    2996/     E11 : FE 80               	cp	80h
    2997/     E13 : DA 2A 0E            	jp	c, dd_bit
    2998/     E16 : FE C0               	cp	0c0h
    2999/     E18 : DA 32 0E            	jp	c, dd_res
    3000/     E1B :                     
    3001/     E1B :                     ; DD_SET
    3002/     E1B :                     ; "SET i, (IX+nn)"
    3003/     E1B :                     
    3004/     E1B : 11 3C 12            	ld	de, SETstr
    3005/     E1E : CD 0B 10            	call	mkopcstr
    3006/     E21 :                     
    3007/     E21 :                     DD_BSR:
    3008/     E21 :                     
    3009/     E21 : 21 9F EF            	ld	hl, dasm_OprStr ; set operand string buffer
    3010/     E24 : CD 86 0C            	call	set_bitno	; "i, "
    3011/     E27 : C3 7E 0D            	jp	dd_mix4		; "(IX+nn)", cr,lf
    3012/     E2A :                     
    3013/     E2A :                     ; DD_BIT
    3014/     E2A :                     ; "BIT i, (IX+nn)"
    3015/     E2A :                     dd_bit:
    3016/     E2A : 11 D1 11            	ld	de, BITstr
    3017/     E2D : CD 0B 10            	call	mkopcstr
    3018/     E30 : 18 EF               	jr	DD_BSR
    3019/     E32 :                     
    3020/     E32 :                     ; DD_RES
    3021/     E32 :                     ; "RES i, (IX+nn)"
    3022/     E32 :                     dd_res:
    3023/     E32 : 11 D5 11            	ld	de, RESstr
    3024/     E35 : CD 0B 10            	call	mkopcstr
    3025/     E38 : 18 E7               	jr	DD_BSR
    3026/     E3A :                     
    3027/     E3A :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3028/     E3A :                     	; OPECODE 0EDH check
    3029/     E3A :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3030/     E3A :                     
    3031/     E3A :                     chk_0EDH:
    3032/     E3A : FE ED               	cp	0edh
    3033/     E3C : C2 37 0F            	jp	nz, chk_0FDH
    3034/     E3F :                     
    3035/     E3F : 7E                  	ld	a, (hl)		; get 2nd opcode
    3036/     E40 :                     
    3037/     E40 :                     	; check undefine MC
    3038/     E40 : 01 38 00            	ld	bc, ed_op_tble - ed_op_tbl
    3039/     E43 : 21 EF 10            	ld	hl, ed_op_tbl
    3040/     E46 : ED B1               	cpir
    3041/     E48 : C2 6E 0C            	jp	nz, op_err
    3042/     E4B :                     
    3043/     E4B : 79                  	ld	a, c
    3044/     E4C : FE 06               	cp	6
    3045/     E4E : DA 18 0F            	jp	c, ed_4mc
    3046/     E51 : FE 1B               	cp	27
    3047/     E53 : DA 0A 0F            	jp	c, ed_no_opr
    3048/     E56 : FE 1E               	cp	30
    3049/     E58 : DA F7 0E            	jp	c, ed_im
    3050/     E5B : CA D7 0E            	jp	z, ed_ld_ar
    3051/     E5E : FE 1F               	cp	31
    3052/     E60 : CA E0 0E            	jp	z, ed_ld_ai
    3053/     E63 : FE 20               	cp	32
    3054/     E65 : CA E9 0E            	jp	z, ed_ld_ra
    3055/     E68 : FE 21               	cp	33
    3056/     E6A : CA F2 0E            	jp	z, ed_ld_ia
    3057/     E6D : FE 26               	cp	38
    3058/     E6F : DA C6 0E            	jp	c, ed_adc
    3059/     E72 : FE 2A               	cp	42
    3060/     E74 : DA B0 0E            	jp	c, ed_sbc
    3061/     E77 : FE 31               	cp	49
    3062/     E79 : DA 95 0E            	jp	c, ed_out
    3063/     E7C :                     
    3064/     E7C :                     ; c: 49 - 55 : IN r,(C) (r:B,C,D,E,H,L,A)
    3065/     E7C :                     
    3066/     E7C : 11 B4 11            	ld	de, INstr
    3067/     E7F : CD 0B 10            	call	mkopcstr
    3068/     E82 :                     
    3069/     E82 : 79                  	ld	a, c
    3070/     E83 : D6 31               	sub	49
    3071/     E85 : 4F                  	ld	c, a
    3072/     E86 : 21 01 13            	ld	hl, dd_ldtbl
    3073/     E89 : CD 8D 0F            	call	get_strBufpoint	; get strung buffer
    3074/     E8C : CD 5E 10            	call	mk_rcs		; "REG, "
    3075/     E8F : 11 44 12            	ld	de, KCKstr
    3076/     E92 : C3 34 10            	jp	cpstr_crlf	; "(C)",cr,lf
    3077/     E95 :                     
    3078/     E95 :                     ; c: 42 - 48 : OUT (C),r(r:B,C,D,E,H,L,A)
    3079/     E95 :                     ed_out:
    3080/     E95 : 11 B0 11            	ld	de, OUTstr
    3081/     E98 : CD 0B 10            	call	mkopcstr
    3082/     E9B :                     
    3083/     E9B : 11 44 12            	ld	de, KCKstr
    3084/     E9E : CD 5E 10            	call	mk_rcs		; "(C), "
    3085/     EA1 :                     
    3086/     EA1 : 79                  	ld	a, c
    3087/     EA2 : D6 2A               	sub	42
    3088/     EA4 : 4F                  	ld	c, a
    3089/     EA5 : E5                  	push	hl
    3090/     EA6 : 21 01 13            	ld	hl, dd_ldtbl
    3091/     EA9 :                     
    3092/     EA9 :                     ed_out1:
    3093/     EA9 : CD 8D 0F            	call	get_strBufpoint	; get strung buffer
    3094/     EAC : E1                  	pop	hl
    3095/     EAD : C3 34 10            	jp	cpstr_crlf	; "REG",cr,lf
    3096/     EB0 :                     
    3097/     EB0 :                     ; c: 38 - 41 : SBC HL,rr(rr:BC,DE,HL,SP)
    3098/     EB0 :                     ed_sbc:
    3099/     EB0 : 11 5A 11            	ld	de, SBCstr
    3100/     EB3 : CD 0B 10            	call	mkopcstr
    3101/     EB6 :                     
    3102/     EB6 : 11 69 1F            	ld	de, RNHL
    3103/     EB9 : CD 5E 10            	call	mk_rcs		; "HL, "
    3104/     EBC :                     
    3105/     EBC : 79                  	ld	a, c
    3106/     EBD : D6 26               	sub	38
    3107/     EBF :                     ed_sbc1:
    3108/     EBF : 4F                  	ld	c, a
    3109/     EC0 : E5                  	push	hl
    3110/     EC1 : 21 89 12            	ld	hl, INC_DEC_ADDrp
    3111/     EC4 : 18 E3               	jr	ed_out1
    3112/     EC6 :                     
    3113/     EC6 :                     ; c: 34 - 37 : ADC HL,rr(rr:BC,DE,HL,SP)
    3114/     EC6 :                     ed_adc:
    3115/     EC6 : 11 52 11            	ld	de, ADCstr
    3116/     EC9 : CD 0B 10            	call	mkopcstr
    3117/     ECC :                     
    3118/     ECC : 11 69 1F            	ld	de, RNHL
    3119/     ECF : CD 5E 10            	call	mk_rcs		; "HL, "
    3120/     ED2 :                     
    3121/     ED2 : 79                  	ld	a, c
    3122/     ED3 : D6 22               	sub	34
    3123/     ED5 : 18 E8               	jr	ed_sbc1
    3124/     ED7 :                     
    3125/     ED7 :                     ; c: 30, 31 : LD A,R ; LD A,I
    3126/     ED7 :                     ed_ld_ar:
    3127/     ED7 : CD 5B 10            	call	a_colon_sp	; "A, "
    3128/     EDA : 11 A4 1F            	ld	de, RNR
    3129/     EDD : C3 34 10            	jp	cpstr_crlf	; "R",cr,lf
    3130/     EE0 :                     	
    3131/     EE0 :                     ed_ld_ai:
    3132/     EE0 : CD 5B 10            	call	a_colon_sp	; "A, "
    3133/     EE3 : 11 A2 1F            	ld	de, RNI
    3134/     EE6 : C3 34 10            	jp	cpstr_crlf	; "I",cr,lf
    3135/     EE9 :                     	
    3136/     EE9 :                     ; c: 32, 33 : LD R,A ; LD I,A
    3137/     EE9 :                     ed_ld_ra:
    3138/     EE9 : 11 A4 1F            	ld	de, RNR
    3139/     EEC :                     ed_ld_ra1:
    3140/     EEC : CD 5E 10            	call	mk_rcs		; "R, "
    3141/     EEF : C3 26 10            	jp	a_crlf		; "A",cr,lf
    3142/     EF2 :                     
    3143/     EF2 :                     ed_ld_ia:
    3144/     EF2 : 11 A2 1F            	ld	de, RNI
    3145/     EF5 : 18 F5               	jr	ed_ld_ra1
    3146/     EF7 :                     	
    3147/     EF7 :                     ; c: 27, 28, 29 : IM 2, IM 1, IM 0
    3148/     EF7 :                     ed_im:
    3149/     EF7 : 11 DD 11            	ld	de, IMstr
    3150/     EFA : CD 0B 10            	call	mkopcstr
    3151/     EFD :                     
    3152/     EFD : 3E 1D               	ld	a, 29
    3153/     EFF : 91                  	sub	c
    3154/     F00 : C6 30               	add	a, '0'		; '0', '1', '2'
    3155/     F02 : 21 9F EF            	ld	hl, dasm_OprStr
    3156/     F05 : 77                  	ld	(hl), a
    3157/     F06 : 23                  	inc	hl
    3158/     F07 : C3 37 10            	jp	insPostStr
    3159/     F0A :                     
    3160/     F0A :                     ; c: 6 - 26 ed_noopr
    3161/     F0A :                     ed_no_opr:
    3162/     F0A : D6 06               	sub	6
    3163/     F0C : 4F                  	ld	c, a
    3164/     F0D : 06 00               	ld	b, 0
    3165/     F0F : 21 0F 13            	ld	hl, ed_noopr
    3166/     F12 : CD 8D 0F            	call	get_strBufpoint		; de : string buffer
    3167/     F15 : C3 0B 10            	jp	mkopcstr
    3168/     F18 :                     ;
    3169/     F18 :                     ; check ED 4 byte MC
    3170/     F18 :                     ;
    3171/     F18 :                     ed_4mc:
    3172/     F18 : 3E 04               	ld	a, 4
    3173/     F1A : 32 83 EF            	ld	(mc_Size), a	; 4byte machine code
    3174/     F1D :                     
    3175/     F1D : C5                  	push	bc
    3176/     F1E : 79                  	ld	a, c
    3177/     F1F : 21 CF 12            	ld	hl, ed_rp_str
    3178/     F22 : CD 8D 0F            	call	get_strBufpoint		; de : string buffer
    3179/     F25 : C1                  	pop	bc
    3180/     F26 : 79                  	ld	a, c
    3181/     F27 : FE 03               	cp	3
    3182/     F29 : DA DA 0D            	jp	c, DD_2a1		; "rr, (nnnnH)",cr,lf
    3183/     F2C :                     					; rr: BC, DE, SP
    3184/     F2C :                     ; "(nnnnH), rr" rr: BC, DE, SP
    3185/     F2C :                     
    3186/     F2C : D5                  	push	de
    3187/     F2D : CD 76 0F            	call	get_nnnn
    3188/     F30 : CD A2 0F            	call	ins_kn4kcs	; "(nnnnH), "
    3189/     F33 : D1                  	pop	de
    3190/     F34 : C3 34 10            	jp	cpstr_crlf	; "REG",cr,lf
    3191/     F37 :                     
    3192/     F37 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3193/     F37 :                     	; OPECODE 0FDH check
    3194/     F37 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3195/     F37 :                     
    3196/     F37 :                     chk_0FDH:
    3197/     F37 :                     
    3198/     F37 : 11 99 1F            	ld	de, RNIY
    3199/     F3A : ED 53 7F EF         	ld	(reg_xy), de	; save index reg string
    3200/     F3E : 11 EB 12            	ld	de, addiyrp_tbl
    3201/     F41 : ED 53 81 EF         	ld	(xy_srtp), de
    3202/     F45 :                     
    3203/     F45 : C3 A7 0C            	jp	chk_0DDH_1
    3204/     F48 :                     
    3205/     F48 :                     ;-----------------------------------
    3206/     F48 :                     ; make "(REG+nn), " at dasm_OprStr
    3207/     F48 :                     ;	REG : IX or IY
    3208/     F48 :                     ; input de: RNIX, or RNIY
    3209/     F48 :                     ;-----------------------------------
    3210/     F48 :                     kixypnk_cs:
    3211/     F48 : 21 9F EF            	ld	hl, dasm_OprStr
    3212/     F4B : CD 57 0F            	call	mk_kixypnk
    3213/     F4E : C3 83 10            	jp	ins_kmR
    3214/     F51 :                     
    3215/     F51 :                     ;-----------------------------------
    3216/     F51 :                     ; make "(REG+nn)",cr,lf 
    3217/     F51 :                     ;	REG : IX or IY
    3218/     F51 :                     ; input de: RNIX, or RNIY
    3219/     F51 :                     ;       hl: string buffer
    3220/     F51 :                     ;-----------------------------------
    3221/     F51 :                     kixypnk_crlf:
    3222/     F51 : CD 57 0F            	call	mk_kixypnk
    3223/     F54 : C3 37 10            	jp	insPostStr	; CR, LF, 00h
    3224/     F57 :                     
    3225/     F57 :                     ;-----------------------------------
    3226/     F57 :                     ; make "(IX+nn)", "(IY+nn)" string
    3227/     F57 :                     ; input de: RNIX, or RNIY
    3228/     F57 :                     ;       hl: string buffer
    3229/     F57 :                     ;-----------------------------------
    3230/     F57 :                     mk_kixypnk:
    3231/     F57 : CD 6E 10            	call	ins_kakkoL	; "("
    3232/     F5A : CD 66 10            	call	st_copy	; IX
    3233/     F5D : CD 76 0F            	call	get_nnnn
    3234/     F60 : 7B                  	ld	a, e		;get number
    3235/     F61 : FE 80               	cp	80h
    3236/     F63 : 38 0C               	jr	c, numPlus	; number plus
    3237/     F65 : ED 44               	neg			; a = not a + 1
    3238/     F67 : 5F                  	ld	e, a
    3239/     F68 : CD 7F 10            	call	ins_misR	; -
    3240/     F6B :                     sv_nnkr:
    3241/     F6B : CD D9 0F            	call	hex2str_asm	; nnh
    3242/     F6E : C3 72 10            	jp	ins_kakkoR	; ")"
    3243/     F71 :                     	
    3244/     F71 :                     numPlus:
    3245/     F71 : CD 7B 10            	call	ins_plsR	; +
    3246/     F74 : 18 F5               	jr	sv_nnkr
    3247/     F76 :                     
    3248/     F76 :                     ; de : nnnn , or d:yy, e:xx
    3249/     F76 :                     get_nnnn:
    3250/     F76 : E5                  	push	hl
    3251/     F77 : 2A 7D EF            	ld	hl, (dasm_adr)
    3252/     F7A : 23                  	inc	hl		; 2nd opecode address
    3253/     F7B : 23                  	inc	hl		; operand address
    3254/     F7C : 5E                  	ld	e, (hl)		; get nn
    3255/     F7D : 23                  	inc	hl
    3256/     F7E : 56                  	ld	d, (hl)		; d:yy use for "LD (IX+xx), yy"
    3257/     F7F :                     				; d:OP use for 4bytes MC like "DD CB xx OP"
    3258/     F7F :                     				; de : YYXX : ED OP XX YY
    3259/     F7F : E1                  	pop	hl
    3260/     F80 : C9                  	ret
    3261/     F81 :                     
    3262/     F81 :                     ;-------------------------------------------------
    3263/     F81 :                     ; hl: massage table
    3264/     F81 :                     ; bc: found operand point
    3265/     F81 :                     ;
    3266/     F81 :                     ; output: copy strings to dasm_OprStr buffer
    3267/     F81 :                     ;         hl = end point of copied string buffer
    3268/     F81 :                     ;-------------------------------------------------
    3269/     F81 :                     mk_str:
    3270/     F81 : CD 8D 0F            	call	get_strBufpoint
    3271/     F84 : 21 9F EF            	ld	hl, dasm_OprStr
    3272/     F87 : C3 66 10            	jp	st_copy
    3273/     F8A :                     
    3274/     F8A :                     ;------------------------------------------------
    3275/     F8A :                     ; get register strings address
    3276/     F8A :                     ; input bc: string buffer offset
    3277/     F8A :                     ; output de: register strings address
    3278/     F8A :                     ;------------------------------------------------
    3279/     F8A :                     get_rstg_off:
    3280/     F8A : 21 61 12            	ld	hl, disRegTbl
    3281/     F8D :                     
    3282/     F8D :                     ;-------------------------------------------------
    3283/     F8D :                     ; input
    3284/     F8D :                     ;	bc: found operand point
    3285/     F8D :                     ;	hl: massage table
    3286/     F8D :                     ; output: 
    3287/     F8D :                     ;	DE : string point
    3288/     F8D :                     ;-------------------------------------------------
    3289/     F8D :                     get_strBufpoint:
    3290/     F8D : CB 21               	sla	c
    3291/     F8F : CB 10               	rl	b		; bc *=2
    3292/     F91 : 09                  	add	hl, bc		; get operand string point
    3293/     F92 : 5E                  	ld	e, (hl)
    3294/     F93 : 23                  	inc	hl
    3295/     F94 : 56                  	ld	d, (hl)
    3296/     F95 : C9                  	ret
    3297/     F96 :                     
    3298/     F96 :                     ;------------------------------------------------
    3299/     F96 :                     ; insert "nnH", CR, LF to buffer
    3300/     F96 :                     ;input e: value
    3301/     F96 :                     ;      hl: string buffer
    3302/     F96 :                     ;------------------------------------------------
    3303/     F96 :                     mk_n2crlf:
    3304/     F96 : CD D9 0F            	call	hex2str_asm
    3305/     F99 : C3 37 10            	jp	insPostStr
    3306/     F9C :                     
    3307/     F9C :                     ;------------------------------------------------
    3308/     F9C :                     ; insert "nnnnH", CR, LF to buffer
    3309/     F9C :                     ;input de: value
    3310/     F9C :                     ;      hl: string buffer
    3311/     F9C :                     ;------------------------------------------------
    3312/     F9C :                     mk_n4crlf:
    3313/     F9C : CD C8 0F            	call	hex4str_asm
    3314/     F9F : C3 37 10            	jp	insPostStr
    3315/     FA2 :                     
    3316/     FA2 :                     ;------------------------------------------------
    3317/     FA2 :                     ; insert "(nnnnH), " to buffer dasm_OprStr
    3318/     FA2 :                     ;input de: value
    3319/     FA2 :                     ;
    3320/     FA2 :                     ; make "(nnnnH), " to dasm_OprStr buffer
    3321/     FA2 :                     ; output hl: end point of string buffer
    3322/     FA2 :                     ;------------------------------------------------
    3323/     FA2 :                     ins_kn4kcs:
    3324/     FA2 : 21 9F EF            	ld	hl, dasm_OprStr	;operand str buffer
    3325/     FA5 : CD 6E 10            	call	ins_kakkoL	; "("
    3326/     FA8 : CD C8 0F            	call	hex4str_asm
    3327/     FAB : CD 72 10            	call	ins_kakkoR	; ")"
    3328/     FAE : C3 83 10            	jp	ins_kmR		; ", "
    3329/     FB1 :                     
    3330/     FB1 :                     ;------------------------------------------------
    3331/     FB1 :                     ; insert "(nnnnH)" to buffer
    3332/     FB1 :                     ;input de: value
    3333/     FB1 :                     ;      hl: string buffer
    3334/     FB1 :                     ;------------------------------------------------
    3335/     FB1 :                     mk_kn4k:
    3336/     FB1 : CD 6E 10            	call	ins_kakkoL	; "("
    3337/     FB4 : CD C8 0F            	call	hex4str_asm
    3338/     FB7 : C3 72 10            	jp	ins_kakkoR	; ")"
    3339/     FBA :                     
    3340/     FBA :                     ;------------------------------------------------
    3341/     FBA :                     ; Make address string from branch relative value
    3342/     FBA :                     ; input hl: string buffer pointer
    3343/     FBA :                     ; output *hl= "nnnnH",cr,lf,0
    3344/     FBA :                     ;------------------------------------------------
    3345/     FBA :                     mkRel_str:
    3346/     FBA : E5                  	push	hl
    3347/     FBB : 2A 7D EF            	ld	hl, (dasm_adr)
    3348/     FBE : CD 1A 05            	call	Rel_adr_c	; return hl : target addr
    3349/     FC1 : EB                  	ex	de, hl		; hl: buffer, de: addr value
    3350/     FC2 : E1                  	pop	hl
    3351/     FC3 : CD C8 0F            	call	hex4str_asm
    3352/     FC6 : 18 6F               	jr	insPostStr
    3353/     FC8 :                     	
    3354/     FC8 :                     ;------------------------------------------------
    3355/     FC8 :                     ;input de: value, hl: save baffer.
    3356/     FC8 :                     ;output 4hex chars(asm format)
    3357/     FC8 :                     ;	(ex). "0FFFFH"
    3358/     FC8 :                     ;             "1234H"
    3359/     FC8 :                     ;       hl : hl = hl + 5(or 6); *hl=0
    3360/     FC8 :                     ;------------------------------------------------
    3361/     FC8 :                     hex4str_asm:
    3362/     FC8 : 7A                  	ld	a, d
    3363/     FC9 : FE A0               	cp	0a0h
    3364/     FCB : 38 04               	jr	c, h4sa_1
    3365/     FCD : 3E 30               	ld	a, '0'
    3366/     FCF : 77                  	ld	(hl), a
    3367/     FD0 : 23                  	inc	hl
    3368/     FD1 :                     
    3369/     FD1 :                     h4sa_1:
    3370/     FD1 : CD E7 0F            	call	hex4str
    3371/     FD4 :                     h4sa_2:
    3372/     FD4 : 3E 48               	ld	a, 'H'
    3373/     FD6 : C3 74 10            	jp	ikk_1
    3374/     FD9 :                     
    3375/     FD9 :                     ;------------------------------------------------
    3376/     FD9 :                     ;input e: value, hl: save baffer.
    3377/     FD9 :                     ;output: 2 hex chars(asm format)
    3378/     FD9 :                     ;	(ex). "0FFH"
    3379/     FD9 :                     ;             "12H"
    3380/     FD9 :                     ;       hl : hl = hl + 3(or 4); *hl=0
    3381/     FD9 :                     ;------------------------------------------------
    3382/     FD9 :                     hex2str_asm:
    3383/     FD9 : 7B                  	ld	a, e
    3384/     FDA : FE A0               	cp	0a0h
    3385/     FDC : 38 04               	jr	c, h2sa_1
    3386/     FDE : 3E 30               	ld	a, '0'
    3387/     FE0 : 77                  	ld	(hl), a
    3388/     FE1 : 23                  	inc	hl
    3389/     FE2 :                     
    3390/     FE2 :                     h2sa_1:
    3391/     FE2 : CD EF 0F            	call	hex2str
    3392/     FE5 : 18 ED               	jr	h4sa_2
    3393/     FE7 :                     
    3394/     FE7 :                     ;------------------------------------------------
    3395/     FE7 :                     ;input de: value, hl: save baffer.
    3396/     FE7 :                     ;output: 4 hex chras in save buffer
    3397/     FE7 :                     ;	 hl = hl + 4
    3398/     FE7 :                     ;------------------------------------------------
    3399/     FE7 :                     hex4str:
    3400/     FE7 : 7A                  	ld	a, d
    3401/     FE8 : CD F8 0F            	call	h2s_n1
    3402/     FEB : 7A                  	ld	a, d
    3403/     FEC : CD FC 0F            	call	h2s_n2
    3404/     FEF :                     
    3405/     FEF :                     ;------------------------------------------------
    3406/     FEF :                     ;input e: value, hl: save baffer.
    3407/     FEF :                     ;output: 2 hex chras in save buffer
    3408/     FEF :                     ;	 hl = hl + 2
    3409/     FEF :                     ;------------------------------------------------
    3410/     FEF :                     hex2str:
    3411/     FEF : 7B                  	ld	a, e
    3412/     FF0 : CD F8 0F            	call	h2s_n1
    3413/     FF3 : 7B                  	ld	a, e
    3414/     FF4 : CD FC 0F            	call	h2s_n2
    3415/     FF7 : C9                  	ret
    3416/     FF8 :                     
    3417/     FF8 :                     h2s_n1:
    3418/     FF8 : 0F                  	rrca
    3419/     FF9 : 0F                  	rrca
    3420/     FFA : 0F                  	rrca
    3421/     FFB : 0F                  	rrca
    3422/     FFC :                     h2s_n2:
    3423/     FFC : E6 0F               	and	0fh
    3424/     FFE : F6 30               	or	30h
    3425/    1000 : FE 3A               	cp	3aH
    3426/    1002 : 38 70               	jr	c, ikk_1	; '0' to '9'
    3427/    1004 : C6 07               	add	a, 07h		; 'A' to 'F'
    3428/    1006 : 18 6C               	jr	ikk_1
    3429/    1008 :                     
    3430/    1008 :                     add_opstr:
    3431/    1008 : 11 4E 11            	ld	de, ADDstr
    3432/    100B :                     ;-----------------------------------
    3433/    100B :                     ; make opecode strings
    3434/    100B :                     ; input de : opecode strings
    3435/    100B :                     ;-----------------------------------
    3436/    100B :                     mkopcstr:
    3437/    100B : F5                  	push	af
    3438/    100C : C5                  	push	bc
    3439/    100D : 06 08               	ld	b, 8	;tab size
    3440/    100F : 21 97 EF            	ld	hl, dasm_OpcStr
    3441/    1012 :                     dmkstr0:
    3442/    1012 : 1A                  	ld	a, (de)
    3443/    1013 : B7                  	or	a
    3444/    1014 : 28 06               	jr	z, dmkst1
    3445/    1016 : 77                  	ld	(hl), a
    3446/    1017 : 23                  	inc	hl
    3447/    1018 : 13                  	inc	de
    3448/    1019 : 05                  	dec	b
    3449/    101A : 18 F6               	jr	dmkstr0
    3450/    101C :                     dmkst1:
    3451/    101C : 3E 20               	ld	a, ' '
    3452/    101E :                     dmkst2:
    3453/    101E : 77                  	ld	(hl), a
    3454/    101F : 23                  	inc	hl
    3455/    1020 : 05                  	dec	b
    3456/    1021 : 20 FB               	jr	nz, dmkst2
    3457/    1023 : C1                  	pop	bc
    3458/    1024 : F1                  	pop	af
    3459/    1025 : C9                  	ret
    3460/    1026 :                     
    3461/    1026 :                     ;
    3462/    1026 :                     ; "REG",CR,LF
    3463/    1026 :                     ;
    3464/    1026 :                     a_crlf:
    3465/    1026 : 11 59 1F            	ld	de, RNA
    3466/    1029 : 18 09               	jr	cpstr_crlf	; "A",CR,LF
    3467/    102B :                     ;bc_crlf:
    3468/    102B :                     ;	ld	de, RNBC
    3469/    102B :                     ;	jr	cpstr_crlf
    3470/    102B :                     ;de_crlf:
    3471/    102B :                     ;	ld	de, RNDE
    3472/    102B :                     ;	jr	cpstr_crlf
    3473/    102B :                     ix_crlf:
    3474/    102B : ED 5B 7F EF         	ld	de, (reg_xy)
    3475/    102F : 18 03               	jr	cpstr_crlf
    3476/    1031 :                     ;sp_crlf:
    3477/    1031 :                     ;	ld	de, RNSP
    3478/    1031 :                     ;	jr	cpstr_crlf
    3479/    1031 :                     hl_crlf:
    3480/    1031 : 11 69 1F            	ld	de, RNHL
    3481/    1034 :                     cpstr_crlf:
    3482/    1034 : CD 66 10            	call	st_copy		; "REG"
    3483/    1037 :                     	
    3484/    1037 :                     ;-----------------------------------
    3485/    1037 :                     ; insert CR, LF, 00H(end delimiter)
    3486/    1037 :                     ; input hl : insert buffer
    3487/    1037 :                     ;-----------------------------------
    3488/    1037 :                     insPostStr:
    3489/    1037 : 3E 0D               	ld	a, CR
    3490/    1039 : 77                  	ld	(hl), a		; CR code
    3491/    103A : 23                  	inc	hl
    3492/    103B : 3E 0A               	ld	a, LF
    3493/    103D : 77                  	ld	(hl), a		; LF code
    3494/    103E : 23                  	inc	hl
    3495/    103F : AF                  	xor	a
    3496/    1040 : 77                  	ld	(hl), a		; end delimiter
    3497/    1041 : C9                  	ret
    3498/    1042 :                     
    3499/    1042 :                     mk_krk_1:
    3500/    1042 : 21 9F EF            	ld	hl, dasm_OprStr
    3501/    1045 :                     ;----------------------------
    3502/    1045 :                     ; insert "(Reg)" to buffer
    3503/    1045 :                     ;
    3504/    1045 :                     ; input de: register string
    3505/    1045 :                     ;	hl: save buffer
    3506/    1045 :                     ;----------------------------
    3507/    1045 :                     mk_krk:
    3508/    1045 : CD 6E 10            	call	ins_kakkoL	; "("
    3509/    1048 : CD 66 10            	call	st_copy		; "REG"
    3510/    104B : 18 25               	jr	ins_kakkoR	; ")"
    3511/    104D :                     
    3512/    104D :                     ;----------------------------
    3513/    104D :                     ; insert "(Reg), " to dasm_OprStr
    3514/    104D :                     ;
    3515/    104D :                     ; input de: register string
    3516/    104D :                     ;----------------------------
    3517/    104D :                     mk_krkcs:
    3518/    104D : 21 9F EF            	ld	hl, dasm_OprStr
    3519/    1050 : CD 6E 10            	call	ins_kakkoL	; "("
    3520/    1053 : CD 66 10            	call	st_copy		; "REG"
    3521/    1056 : CD 72 10            	call	ins_kakkoR	; ")"
    3522/    1059 : 18 28               	jr	ins_kmR		; ", "
    3523/    105B :                     
    3524/    105B :                     ;----------------------------
    3525/    105B :                     ; insert "A, " to dasm_OprStr
    3526/    105B :                     ;----------------------------
    3527/    105B :                     a_colon_sp:
    3528/    105B : 11 59 1F            	ld	de, RNA
    3529/    105E :                     ;----------------------------
    3530/    105E :                     ; insert "Reg, " to dasm_OprStr
    3531/    105E :                     ;
    3532/    105E :                     ; input de: register string
    3533/    105E :                     ;----------------------------
    3534/    105E :                     mk_rcs:
    3535/    105E : 21 9F EF            	ld	hl, dasm_OprStr
    3536/    1061 : CD 66 10            	call	st_copy		; "REG"
    3537/    1064 : 18 1D               	jr	ins_kmR		; ", "
    3538/    1066 :                     
    3539/    1066 :                     ;-------------------------------------------------
    3540/    1066 :                     ; copy string to output buffer
    3541/    1066 :                     ; input:
    3542/    1066 :                     ;	de : string point
    3543/    1066 :                     ;	hl : output buffer
    3544/    1066 :                     ;-------------------------------------------------
    3545/    1066 :                     st_copy:
    3546/    1066 : 1A                  	ld	a, (de)
    3547/    1067 : 77                  	ld	(hl), a
    3548/    1068 : B7                  	or	a
    3549/    1069 : C8                  	ret	z	; return after coping delimiter
    3550/    106A :                     			; hl : delimiter position
    3551/    106A : 23                  	inc	hl
    3552/    106B : 13                  	inc	de
    3553/    106C : 18 F8               	jr	st_copy
    3554/    106E :                     
    3555/    106E :                     ;--------------
    3556/    106E :                     ; insert "("
    3557/    106E :                     ;--------------
    3558/    106E :                     ins_kakkoL:
    3559/    106E : 3E 28               	ld	a, '('
    3560/    1070 : 18 02               	jr	ikk_1
    3561/    1072 :                     	
    3562/    1072 :                     ;--------------
    3563/    1072 :                     ; insert ")"
    3564/    1072 :                     ;--------------
    3565/    1072 :                     ins_kakkoR:
    3566/    1072 : 3E 29               	ld	a, ')'
    3567/    1074 :                     ikk_1:
    3568/    1074 : 77                  	ld	(hl), a
    3569/    1075 : 23                  	inc	hl
    3570/    1076 : C9                  	ret
    3571/    1077 :                     
    3572/    1077 :                     ;--------------
    3573/    1077 :                     ; insert " "
    3574/    1077 :                     ;--------------
    3575/    1077 :                     ins_spcR:
    3576/    1077 : 3E 20               	ld	a, ' '
    3577/    1079 : 18 F9               	jr	ikk_1
    3578/    107B :                     
    3579/    107B :                     ;--------------
    3580/    107B :                     ; insert "+"
    3581/    107B :                     ;--------------
    3582/    107B :                     ins_plsR:
    3583/    107B : 3E 2B               	ld	a, '+'
    3584/    107D : 18 F5               	jr	ikk_1
    3585/    107F :                     
    3586/    107F :                     ;--------------
    3587/    107F :                     ; insert "-"
    3588/    107F :                     ;--------------
    3589/    107F :                     ins_misR:
    3590/    107F : 3E 2D               	ld	a, '-'
    3591/    1081 : 18 F1               	jr	ikk_1
    3592/    1083 :                     
    3593/    1083 :                     ;--------------
    3594/    1083 :                     ; insert ", "
    3595/    1083 :                     ;--------------
    3596/    1083 :                     ins_kmR:
    3597/    1083 : 3E 2C               	ld	a, ','
    3598/    1085 : CD 74 10            	call	ikk_1
    3599/    1088 : 18 ED               	jr	ins_spcR
    3600/    108A :                     
    3601/    108A :                     ;------------------------------------------
    3602/    108A :                     ; Dis assemble tables
    3603/    108A :                     ;------------------------------------------
    3604/    108A :                     oth_1op_s:
    3605/    108A : 00                  	DB	00H	; NOP
    3606/    108B : 07                  	DB	07H	; RLCA
    3607/    108C : 0F                  	DB	0FH	; RRCA
    3608/    108D : 17                  	DB	17H	; RLA
    3609/    108E : 1F                  	DB	1FH	; RRA
    3610/    108F : 27                  	DB	27H	; DAA
    3611/    1090 : 2F                  	DB	2FH	; CPL
    3612/    1091 : 37                  	DB	37H	; SCF
    3613/    1092 : 3F                  	DB	3FH	; CCF
    3614/    1093 : C9                  	DB	0C9H	; RET
    3615/    1094 : D9                  	DB	0D9H	; EXX
    3616/    1095 : F3                  	DB	0F3H	; DI
    3617/    1096 : FB                  	DB	0FBH	; EI
    3618/    1097 :                     oth_1op_e:
    3619/    1097 :                     
    3620/    1097 :                     INC_OPCDTBLS:
    3621/    1097 : 04                  	DB	04H	; INC	B
    3622/    1098 : 0C                  	DB	0CH	; INC	C
    3623/    1099 : 14                  	DB	14H	; INC	D
    3624/    109A : 1C                  	DB	1CH	; INC	E
    3625/    109B : 24                  	DB	24H	; INC	H
    3626/    109C : 2C                  	DB	2CH	; INC	L
    3627/    109D : 34                  	DB	34H	; INC	(HL)
    3628/    109E : 3C                  	DB	3CH	; INC	A
    3629/    109F :                     INC_OPCDTBLE:
    3630/    109F :                     
    3631/    109F :                     DEC_OPCDTBLS:
    3632/    109F : 05                  	DB	05H	; DEC	B
    3633/    10A0 : 0D                  	DB	0DH	; DEC	C
    3634/    10A1 : 15                  	DB	15H	; DEC	D
    3635/    10A2 : 1D                  	DB	1DH	; DEC	E
    3636/    10A3 : 25                  	DB	25H	; DEC	H
    3637/    10A4 : 2D                  	DB	2DH	; DEC	L
    3638/    10A5 : 35                  	DB	35H	; DEC	(HL)
    3639/    10A6 : 3D                  	DB	3DH	; DEC	A
    3640/    10A7 :                     DEC_OPCDTBLE:
    3641/    10A7 :                     
    3642/    10A7 :                     inc_rp_s:
    3643/    10A7 : 03                  	DB	03H	; INC	BC
    3644/    10A8 : 13                  	DB	13H	; INC	DE
    3645/    10A9 : 23                  	DB	23H	; INC	HL
    3646/    10AA : 33                  	DB	33H	; INC	SP
    3647/    10AB :                     inc_rp_e:
    3648/    10AB :                     
    3649/    10AB :                     dec_rp_s:
    3650/    10AB : 0B                  	DB	0BH	; DEC	BC
    3651/    10AC : 1B                  	DB	1BH	; DEC	DE
    3652/    10AD : 2B                  	DB	2BH	; DEC	HL
    3653/    10AE : 3B                  	DB	3BH	; DEC	SP
    3654/    10AF :                     dec_rp_e:
    3655/    10AF :                     
    3656/    10AF :                     add_rp_s:
    3657/    10AF : 09                  	DB	09H	; ADD	HL,BC
    3658/    10B0 : 19                  	DB	19H	; ADD	HL,DE
    3659/    10B1 : 29                  	DB	29H	; ADD	HL,HL
    3660/    10B2 : 39                  	DB	39H	; ADD	HL,SP
    3661/    10B3 :                     add_rp_e:
    3662/    10B3 :                     
    3663/    10B3 :                     pop_rp_s:
    3664/    10B3 : C1                  	DB	0C1H	; POP	BC
    3665/    10B4 : D1                  	DB	0D1H	; POP	DE
    3666/    10B5 : E1                  	DB	0E1H	; POP	HL
    3667/    10B6 : F1                  	DB	0F1H	; POP	AF
    3668/    10B7 :                     pop_rp_e:
    3669/    10B7 :                     
    3670/    10B7 :                     push_rp_s:
    3671/    10B7 : C5                  	DB	0C5H	; PUSH	BC
    3672/    10B8 : D5                  	DB	0D5H	; PUSH	DE
    3673/    10B9 : E5                  	DB	0E5H	; PUSH	HL
    3674/    10BA : F5                  	DB	0F5H	; PUSH	AF
    3675/    10BB :                     push_rp_e:
    3676/    10BB :                     
    3677/    10BB :                     dd_ld_tbl:
    3678/    10BB : 46                  	DB	46h	; nn: LD B,(IX+nn)
    3679/    10BC : 4E                  	DB	4Eh	; nn: LD C,(IX+nn)
    3680/    10BD : 56                  	DB	56h	; nn: LD D,(IX+nn)
    3681/    10BE : 5E                  	DB	5Eh	; nn: LD E,(IX+nn)
    3682/    10BF : 66                  	DB	66h	; nn: LD H,(IX+nn)
    3683/    10C0 : 6E                  	DB	6Eh	; nn: LD L,(IX+nn)
    3684/    10C1 : 7E                  	DB	7Eh	; nn: LD A,(IX+nn)
    3685/    10C2 :                     
    3686/    10C2 : 70                  	DB	70h	; nn: LD (IX+nn),B
    3687/    10C3 : 71                  	DB	71h	; nn: LD (IX+nn),C
    3688/    10C4 : 72                  	DB	72h	; nn: LD (IX+nn),D
    3689/    10C5 : 73                  	DB	73h	; nn: LD (IX+nn),E
    3690/    10C6 : 74                  	DB	74h	; nn: LD (IX+nn),H
    3691/    10C7 : 75                  	DB	75h	; nn: LD (IX+nn),L
    3692/    10C8 : 77                  	DB	77h	; nn: LD (IX+nn),A
    3693/    10C9 :                     dd_ld_tble:
    3694/    10C9 :                     
    3695/    10C9 :                     dd_log_tbl:
    3696/    10C9 : 96                  	DB	96h	; nn: SUB (IX+nn)
    3697/    10CA : A6                  	DB	0A6h	; nn: AND (IX+nn)
    3698/    10CB : AE                  	DB	0AEh	; nn: XOR (IX+nn)
    3699/    10CC : B6                  	DB	0B6h	; nn: OR  (IX+nn)
    3700/    10CD : BE                  	DB	0BEh	; nn: CP  (IX+nn)
    3701/    10CE : 34                  	DB	34h	; nn: INC (IX+nn)
    3702/    10CF : 35                  	DB	35h	; nn: DEC (IX+nn)
    3703/    10D0 :                     dd_log_tble:
    3704/    10D0 :                     
    3705/    10D0 :                     dd_rt_tbles:
    3706/    10D0 : 06                  	DB	06h	; RLC (IX+nn)
    3707/    10D1 : 0E                  	DB	0Eh	; RRC (IX+nn)
    3708/    10D2 : 16                  	DB	16h	; RL  (IX+nn)
    3709/    10D3 : 1E                  	DB	1Eh	; RR  (IX+nn)
    3710/    10D4 : 26                  	DB	26h	; SLA (IX+nn)
    3711/    10D5 : 2E                  	DB	2Eh	; SRA (IX+nn)
    3712/    10D6 : 3E                  	DB	3Eh	; SRL (IX+nn)
    3713/    10D7 :                     dd_rt_tble:
    3714/    10D7 :                     
    3715/    10D7 :                     ; use checking undefine MC ( DD CB nn XX )
    3716/    10D7 :                     dd_bit_opTbl:
    3717/    10D7 : 46                  	DB	46h	; BIT 0,(IX+12H)
    3718/    10D8 : 4E                  	DB	4Eh	; BIT 1,(IX+12H)
    3719/    10D9 : 56                  	DB	56h	; BIT 2,(IX+12H)
    3720/    10DA : 5E                  	DB	5Eh	; BIT 3,(IX+12H)
    3721/    10DB : 66                  	DB	66h	; BIT 4,(IX+12H)
    3722/    10DC : 6E                  	DB	6Eh	; BIT 5,(IX+12H)
    3723/    10DD : 76                  	DB	76h	; BIT 6,(IX+12H)
    3724/    10DE : 7E                  	DB	7Eh	; BIT 7,(IX+12H)
    3725/    10DF : 86                  	DB	86h	; RES 0,(IX+12H)
    3726/    10E0 : 8E                  	DB	8Eh	; RES 1,(IX+12H)
    3727/    10E1 : 96                  	DB	96h	; RES 2,(IX+12H)
    3728/    10E2 : 9E                  	DB	9Eh	; RES 3,(IX+12H)
    3729/    10E3 : A6                  	DB	0A6h	; RES 4,(IX+12H)
    3730/    10E4 : AE                  	DB	0AEh	; RES 5,(IX+12H)
    3731/    10E5 : B6                  	DB	0B6h	; RES 6,(IX+12H)
    3732/    10E6 : BE                  	DB	0BEh	; RES 7,(IX+12H)
    3733/    10E7 : C6                  	DB	0C6h	; SET 0,(IX+12H)
    3734/    10E8 : CE                  	DB	0CEh	; SET 1,(IX+12H)
    3735/    10E9 : D6                  	DB	0D6h	; SET 2,(IX+12H)
    3736/    10EA : DE                  	DB	0DEh	; SET 3,(IX+12H)
    3737/    10EB : E6                  	DB	0E6h	; SET 4,(IX+12H)
    3738/    10EC : EE                  	DB	0EEh	; SET 5,(IX+12H)
    3739/    10ED : F6                  	DB	0F6h	; SET 6,(IX+12H)
    3740/    10EE : FE                  	DB	0FEh	; SET 7,(IX+12H)
    3741/    10EF :                     dd_bit_opTble:
    3742/    10EF :                     
    3743/    10EF :                     ; use checking undefine MC ( ED XX ....)
    3744/    10EF :                     ed_op_tbl:
    3745/    10EF : 40                  	DB	40h	; 55:IN  B,(C)
    3746/    10F0 : 48                   	DB	48h	; 54:IN  C,(C)
    3747/    10F1 : 50                  	DB	50h	; 53:IN  D,(C)
    3748/    10F2 : 58                  	DB	58h	; 52:IN  E,(C)
    3749/    10F3 : 60                  	DB	60h	; 51:IN  H,(C)
    3750/    10F4 : 68                  	DB	68h	; 50:IN  L,(C)
    3751/    10F5 : 78                  	DB	78h	; 49:IN  A,(C)
    3752/    10F6 :                     
    3753/    10F6 : 41                  	DB	41h	; 48:OUT (C),B
    3754/    10F7 : 49                  	DB	49h	; 47:OUT (C),C
    3755/    10F8 : 51                  	DB	51h	; 46:OUT (C),D
    3756/    10F9 : 59                  	DB	59h	; 45:OUT (C),E
    3757/    10FA : 61                  	DB	61h	; 44:OUT (C),H
    3758/    10FB : 69                  	DB	69h	; 43:OUT (C),L
    3759/    10FC : 79                  	DB	79h	; 42:OUT (C),A
    3760/    10FD :                     
    3761/    10FD : 42                  	DB	42h	; 41:SBC HL,BC
    3762/    10FE : 52                  	DB	52h	; 40:SBC HL,DE
    3763/    10FF : 62                  	DB	62h	; 39:SBC HL,HL
    3764/    1100 : 72                  	DB	72h	; 38:SBC HL,SP
    3765/    1101 :                     
    3766/    1101 : 4A                  	DB	4Ah	; 37:ADC HL,BC
    3767/    1102 : 5A                  	DB	5Ah	; 36:ADC HL,DE
    3768/    1103 : 6A                  	DB	6Ah	; 35:ADC HL,HL
    3769/    1104 : 7A                  	DB	7Ah	; 34:ADC HL,SP
    3770/    1105 :                     
    3771/    1105 : 47                  	DB	47h	; 33:LD I,A
    3772/    1106 : 4F                  	DB	4Fh	; 32:LD R,A
    3773/    1107 : 57                  	DB	57h	; 31:LD A,I
    3774/    1108 : 5F                  	DB	5Fh	; 30:LD A,R
    3775/    1109 :                     
    3776/    1109 : 46                  	DB	46h	; 29:IM  0
    3777/    110A : 56                  	DB	56h	; 28:IM  1
    3778/    110B : 5E                  	DB	5Eh	; 27:IM  2
    3779/    110C :                     
    3780/    110C : 44                  	DB	44h	; 26:NEG
    3781/    110D : 45                  	DB	45h	; 25:RETN
    3782/    110E : 4D                  	DB	4Dh	; 24:RETI
    3783/    110F : 67                  	DB	67h	; 23:RRD
    3784/    1110 : 6F                  	DB	6Fh	; 22:RLD
    3785/    1111 : A0                  	DB	0A0h	; 21:LDI
    3786/    1112 : A1                  	DB	0A1h	; 20:CPI
    3787/    1113 : A2                  	DB	0A2h	; 19:INI
    3788/    1114 : A3                  	DB	0A3h	; 18:OUTI
    3789/    1115 : A8                  	DB	0A8h	; 17:LDD
    3790/    1116 : A9                  	DB	0A9h	; 16:CPD
    3791/    1117 : AA                  	DB	0AAh	; 15:IND
    3792/    1118 : AB                  	DB	0ABh	; 14:OUTD
    3793/    1119 : B0                  	DB	0B0h	; 13:LDIR
    3794/    111A : B1                  	DB	0B1h	; 12:CPIR
    3795/    111B : B2                  	DB	0B2h	; 11:INIR
    3796/    111C : B3                  	DB	0B3h	; 10:OTIR
    3797/    111D : B8                  	DB	0B8h	; 09:LDDR
    3798/    111E : B9                  	DB	0B9h	; 08:CPDR
    3799/    111F : BA                  	DB	0BAh	; 07:INDR
    3800/    1120 : BB                  	DB	0BBh	; 06:OTDR
    3801/    1121 :                     
    3802/    1121 : 43                  	DB	43h	; 05:LD (nnnn),BC
    3803/    1122 : 53                  	DB	53h	; 04:LD (nnnn),DE
    3804/    1123 : 73                  	DB	73h	; 03:LD (nnnn),SP
    3805/    1124 :                     
    3806/    1124 : 4B                  	DB	4Bh	; 02:LD BC,(nnnn)
    3807/    1125 : 5B                  	DB	5Bh	; 01:LD DE,(nnnn)
    3808/    1126 : 7B                  	DB	7Bh	; 00:LD SP,(nnnn)
    3809/    1127 :                     ed_op_tble:
    3810/    1127 :                     
    3811/    1127 : 41 46 00            RNAF:		DB	"AF",00H
    3812/    112A : 41 46 27 00         RNAFX:		DB	"AF'",00H
    3813/    112E :                     
    3814/    112E : 52 45 54 00         RETstr:		db	"RET", 00h
    3815/    1132 : 4A 50 00            JPstr:		db	"JP", 00h
    3816/    1135 : 4A 52 00            JRstr:		db	"JR", 00h
    3817/    1138 : 44 4A 4E 5A 00      DJNZstr:	db	"DJNZ", 00h
    3818/    113D : 43 41 4C 4C 00      CALLstr:	db	"CALL", 00h
    3819/    1142 : 52 53 54 00         RSTstr:		db	"RST", 00h
    3820/    1146 : 4C 44 00            LDstr:		db	"LD", 00h
    3821/    1149 : 48 41 4C 54 00      HLTstr:		db	"HALT", 00h
    3822/    114E : 41 44 44 00         ADDstr:		db	"ADD", 00h
    3823/    1152 : 41 44 43 00         ADCstr:		db	"ADC", 00h
    3824/    1156 : 53 55 42 00         SUBstr:		db	"SUB", 00h
    3825/    115A : 53 42 43 00         SBCstr:		db	"SBC", 00h
    3826/    115E : 41 4E 44 00         ANDstr:		db	"AND", 00h
    3827/    1162 : 58 4F 52 00         XORstr:		db	"XOR", 00h
    3828/    1166 : 4F 52 00            ORstr:		db	"OR", 00h
    3829/    1169 : 43 50 00            CPstr:		db	"CP", 00h
    3830/    116C : 49 4E 43 00         INCstr:		db	"INC", 00h
    3831/    1170 : 44 45 43 00         DECstr:		db	"DEC", 00h
    3832/    1174 : 50 4F 50 00         POPstr:		db	"POP", 00h
    3833/    1178 : 50 55 53 48 00      PUSHstr:	db	"PUSH",00h
    3834/    117D : 45 58 00            EXstr:		db	"EX", 00h
    3835/    1180 :                     
    3836/    1180 : 45 58 58 00         EXXstr:		db	"EXX", 00h
    3837/    1184 : 4E 4F 50 00         NOPstr:		db	"NOP", 00h
    3838/    1188 : 52 4C 43 41 00      RLCAstr:	db	"RLCA", 00h
    3839/    118D : 52 52 43 41 00      RRCAstr:	db	"RRCA", 00h
    3840/    1192 : 52 4C 41 00         RLAstr:		db	"RLA", 00h
    3841/    1196 : 52 52 41 00         RRAstr:		db	"RRA", 00h
    3842/    119A : 44 41 41 00         DAAstr:		db	"DAA", 00h
    3843/    119E : 43 50 4C 00         CPLstr:		db	"CPL", 00h
    3844/    11A2 : 53 43 46 00         SCFstr:		db	"SCF", 00h
    3845/    11A6 : 43 43 46 00         CCFstr:		db	"CCF", 00h
    3846/    11AA : 44 49 00            DIstr:		db	"DI", 00h
    3847/    11AD : 45 49 00            EIstr:		db	"EI", 00h
    3848/    11B0 :                     
    3849/    11B0 : 4F 55 54 00         OUTstr:		db	"OUT", 00h
    3850/    11B4 : 49 4E 00            INstr:		db	"IN", 00h
    3851/    11B7 :                     
    3852/    11B7 : 52 4C 43 00         RLCstr		db	"RLC", 00h
    3853/    11BB : 52 52 43 00         RRCstr		db	"RRC", 00h
    3854/    11BF : 52 4C 00            RLstr		db	"RL", 00h
    3855/    11C2 : 52 52 00            RRstr		db	"RR", 00h
    3856/    11C5 : 53 4C 41 00         SLAstr		db	"SLA", 00h
    3857/    11C9 : 53 52 41 00         SRAstr		db	"SRA", 00h
    3858/    11CD : 53 52 4C 00         SRLstr		db	"SRL", 00h
    3859/    11D1 : 42 49 54 00         BITstr		db	"BIT", 00h
    3860/    11D5 : 52 45 53 00         RESstr		db	"RES", 00h
    3861/    11D9 : 4E 45 47 00         NEGstr		db	"NEG", 00h
    3862/    11DD : 49 4D 00            IMstr		db	"IM", 00h
    3863/    11E0 : 52 52 44 00         RRDstr		db	"RRD", 00h
    3864/    11E4 : 52 4C 44 00         RLDstr		db	"RLD", 00h
    3865/    11E8 : 4C 44 49 00         LDIstr		db	"LDI", 00h
    3866/    11EC : 43 50 49 00         CPIstr		db	"CPI", 00h
    3867/    11F0 : 49 4E 49 00         INIstr		db	"INI", 00h
    3868/    11F4 : 4F 55 54 49 00      OUTIstr		db	"OUTI", 00h
    3869/    11F9 : 4C 44 44 00         LDDstr		db	"LDD", 00h
    3870/    11FD : 43 50 44 00         CPDstr		db	"CPD", 00h
    3871/    1201 : 49 4E 44 00         INDstr		db	"IND", 00h
    3872/    1205 : 4F 55 54 44 00      OUTDstr		db	"OUTD", 00h
    3873/    120A : 4C 44 49 52 00      LDIRstr		db	"LDIR", 00h
    3874/    120F : 43 50 49 52 00      CPIRstr		db	"CPIR", 00h
    3875/    1214 : 49 4E 49 52 00      INIRstr		db	"INIR", 00h
    3876/    1219 : 4F 54 49 52 00      OTIRstr		db	"OTIR", 00h
    3877/    121E : 4C 44 44 52 00      LDDRstr		db	"LDDR", 00h
    3878/    1223 : 43 50 44 52 00      CPDRstr		db	"CPDR", 00h
    3879/    1228 : 49 4E 44 52 00      INDRstr		db	"INDR", 00h
    3880/    122D : 4F 54 44 52 00      OTDRstr		db	"OTDR", 00h
    3881/    1232 : 52 45 54 49 00      RETIstr		db	"RETI", 00h
    3882/    1237 : 52 45 54 4E 00      RETNstr		db	"RETN", 00h
    3883/    123C :                     ;BITstr		db	"BIT", 00h
    3884/    123C :                     ;RESstr		db	"RES", 00h
    3885/    123C : 53 45 54 00         SETstr		db	"SET", 00h
    3886/    1240 : 3F 3F 3F 00         ER_OPMSG:	db	"???", 00h
    3887/    1244 : 28 43 29 00         KCKstr		db	"(C)", 00h
    3888/    1248 :                     
    3889/    1248 : 28 48 4C 29 00      kRNHL:	db	"(HL)", 00h
    3890/    124D : 4E 5A 00            cc0:	db	"NZ", 00h
    3891/    1250 : 5A 00               cc1:	db	"Z", 00h
    3892/    1252 : 4E 43 00            cc2:	db	"NC", 00h
    3893/    1255 : 43 00               cc3:	db	"C", 00h
    3894/    1257 : 50 4F 00            cc4:	db	"PO", 00h
    3895/    125A : 50 45 00            cc5:	db	"PE", 00h
    3896/    125D : 50 00               cc6:	db	"P", 00h
    3897/    125F : 4D 00               cc7:	db	"M", 00h
    3898/    1261 :                     
    3899/    1261 : 5E 1F 60 1F 65 1F   disRegTbl:	dw	RNB, RNC, RND, RNE, RNH, RNL, kRNHL, RNA
             1267 : 67 1F 6C 1F 6E 1F 
             126D : 48 12 59 1F       
    3900/    1271 : 5F 12 5D 12 5A 12   CC_opr:		dw	cc7, cc6, cc5, cc4, cc3, cc2, cc1, cc0
             1277 : 57 12 55 12 52 12 
             127D : 50 12 4D 12       
    3901/    1281 : 55 12 52 12 50 12   JRCC_opr1:	dw	cc3, cc2, cc1, cc0
             1287 : 4D 12             
    3902/    1289 : 9C 1F 69 1F 62 1F   INC_DEC_ADDrp:	dw	RNSP, RNHL, RNDE, RNBC
             128F : 5B 1F             
    3903/    1291 : 27 11 69 1F 62 1F   POP_PUSHrp:	dw	RNAF, RNHL, RNDE, RNBC
             1297 : 5B 1F             
    3904/    1299 :                     
    3905/    1299 : AD 11 AA 11 80 11   oth_1op_tbl:	dw	EIstr, DIstr, EXXstr, RETstr, CCFstr
             129F : 2E 11 A6 11       
    3906/    12A3 : A2 11 9E 11 9A 11   		dw	SCFstr, CPLstr, DAAstr, RRAstr
             12A9 : 96 11             
    3907/    12AB : 92 11 8D 11 88 11   		dw	RLAstr, RRCAstr, RLCAstr, NOPstr
             12B1 : 84 11             
    3908/    12B3 :                     
    3909/    12B3 : B0 11 B4 11 69 11   logop2str:	dw	OUTstr, INstr, CPstr, ORstr, XORstr
             12B9 : 66 11 62 11       
    3910/    12BD : 5E 11 56 11 5A 11   		dw	ANDstr, SUBstr, SBCstr, ADCstr, ADDstr
             12C3 : 52 11 4E 11       
    3911/    12C7 :                     
    3912/    12C7 : 9C 1F 69 1F 62 1F   logop3str	dw	RNSP, RNHL, RNDE, RNBC
             12CD : 5B 1F             
    3913/    12CF : 9C 1F 62 1F 5B 1F   ed_rp_str	dw	RNSP, RNDE, RNBC, RNSP, RNDE, RNBC
             12D5 : 9C 1F 62 1F 5B 1F 
    3914/    12DB :                     
    3915/    12DB : 74 11 78 11 70 11   dd_2opt:	dw	POPstr, PUSHstr, DECstr, INCstr
             12E1 : 6C 11             
    3916/    12E3 : 9C 1F 96 1F 62 1F   addixrp_tbl:	dw	RNSP, RNIX, RNDE, RNBC
             12E9 : 5B 1F             
    3917/    12EB : 9C 1F 99 1F 62 1F   addiyrp_tbl:	dw	RNSP, RNIY, RNDE, RNBC
             12F1 : 5B 1F             
    3918/    12F3 :                     
    3919/    12F3 : 70 11 6C 11 69 11   ddlogtbl:	dw	DECstr, INCstr, CPstr, ORstr, XORstr, ANDstr, SUBstr
             12F9 : 66 11 62 11 5E 11 
             12FF : 56 11             
    3920/    1301 : 59 1F 6E 1F 6C 1F   dd_ldtbl:	dw	RNA, RNL, RNH, RNE, RND, RNC, RNB
             1307 : 67 1F 65 1F 60 1F 
             130D : 5E 1F             
    3921/    130F :                     
    3922/    130F : 2D 12 28 12 23 12   ed_noopr:	dw	OTDRstr, INDRstr, CPDRstr, LDDRstr
             1315 : 1E 12             
    3923/    1317 : 19 12 14 12 0F 12   		dw	OTIRstr, INIRstr, CPIRstr, LDIRstr
             131D : 0A 12             
    3924/    131F : 05 12 01 12 FD 11   		dw	OUTDstr, INDstr, CPDstr, LDDstr
             1325 : F9 11             
    3925/    1327 : F4 11 F0 11 EC 11   		dw	OUTIstr, INIstr, CPIstr, LDIstr
             132D : E8 11             
    3926/    132F : E4 11 E0 11 32 12   		dw	RLDstr, RRDstr, RETIstr, RETNstr
             1335 : 37 12             
    3927/    1337 : D9 11               		dw	NEGstr
    3928/    1339 :                     
    3929/    1339 : CD 11 C9 11 C5 11   dd_rt_str:	dw	SRLstr, SRAstr, SLAstr, RRstr
             133F : C2 11             
    3930/    1341 : BF 11 BB 11 B7 11   		dw	RLstr, RRCstr, RLCstr
    3931/    1347 :                     	
    3932/    1347 :                     ;;;
    3933/    1347 :                     ;;; GO address
    3934/    1347 :                     ;;; 
    3935/    1347 :                     
    3936/    1347 :                     GO:
    3937/    1347 : ED 5B 42 EF         	ld	de, (REGPC)
    3938/    134B : ED 53 54 EF         	ld	(goTmp), de	; save go tmp go address
    3939/    134F : 23                  	INC	HL
    3940/    1350 : CD 02 18            	CALL	SKIPSP
    3941/    1353 : CD 12 18            	CALL	RDHEX
    3942/    1356 : 30 03               	jr	nc, gostmp
    3943/    1358 : B7                  	OR	A
    3944/    1359 : 28 0A               	JR	Z, g_stpadr
    3945/    135B :                     gostmp:
    3946/    135B : 7A                  	ld	a, d
    3947/    135C : FE F0               	cp	IO_B >> 8	; a - 0F0H
    3948/    135E : D2 FE 00            	jp	nc, ERR		; detect I/O area
    3949/    1361 : ED 53 54 EF         	LD	(goTmp),DE	; save going address
    3950/    1365 :                     g_stpadr:
    3951/    1365 : CD 02 18            	CALL	SKIPSP
    3952/    1368 : 7E                  	LD	A,(HL)
    3953/    1369 : B7                  	or	a
    3954/    136A : 28 18               	jr	z, GO1
    3955/    136C : FE 2C               	cp	','
    3956/    136E : C2 FE 00            	jp	nz, ERR
    3957/    1371 :                     
    3958/    1371 :                     ; set break point with go command
    3959/    1371 :                     
    3960/    1371 : 23                  	INC	HL
    3961/    1372 : CD 02 18            	CALL	SKIPSP
    3962/    1375 : CD 12 18            	CALL	RDHEX		; 1st arg.
    3963/    1378 : DA FE 00            	jp	c, ERR
    3964/    137B :                     
    3965/    137B : 21 6D EF            	ld	hl, tmpb_f	; hl: temp break point buffer
    3966/    137E : CD 60 02            	call	setbpadr
    3967/    1381 : DA FE 00            	jp	c, ERR		; address is incorrect
    3968/    1384 :                     
    3969/    1384 :                     GO1:
    3970/    1384 : 2A 54 EF            	LD	hl, (goTmp)
    3971/    1387 : 22 42 EF            	ld	(REGPC), hl	; set go address
    3972/    138A :                     
    3973/    138A :                     G0:
    3974/    138A :                     ; check Trace mode
    3975/    138A :                     
    3976/    138A : 3A 5D EF            	ld	a, (tpt1_f)
    3977/    138D : B7                  	or	a
    3978/    138E : 28 1A               	jr	z, donot_trace
    3979/    1390 :                     	
    3980/    1390 : 2A 5A EF            	ld	hl,(tmpT)
    3981/    1393 : 22 42 EF            	ld	(REGPC), hl	; set trace address
    3982/    1396 :                     
    3983/    1396 : 21 5D EF            	ld	hl, tpt1_f
    3984/    1399 : 11 5F EF            	ld	de, tpt1_adr
    3985/    139C : CD 02 14            	call	set_bp
    3986/    139F : 21 61 EF            	ld	hl, tpt2_f
    3987/    13A2 : 11 63 EF            	ld	de, tpt2_adr
    3988/    13A5 : CD 02 14            	call	set_bp
    3989/    13A8 : 18 1B               	jr	skp_tbp		; skip set tmp bp and bp, if tracing
    3990/    13AA :                     
    3991/    13AA :                     ; set break point
    3992/    13AA :                     donot_trace:
    3993/    13AA : 21 65 EF            	ld	hl, bpt1_f
    3994/    13AD : 11 67 EF            	ld	de, bpt1_adr
    3995/    13B0 : CD 02 14            	call	set_bp
    3996/    13B3 : 21 69 EF            	ld	hl, bpt2_f
    3997/    13B6 : 11 6B EF            	ld	de, bpt2_adr
    3998/    13B9 : CD 02 14            	call	set_bp
    3999/    13BC :                     
    4000/    13BC :                     
    4001/    13BC :                     ; check go, break pointer
    4002/    13BC :                     
    4003/    13BC : 21 6D EF            	ld	hl, tmpb_f
    4004/    13BF : 11 6F EF            	ld	de, tmpb_adr
    4005/    13C2 : CD 02 14            	call	set_bp
    4006/    13C5 :                     
    4007/    13C5 :                     	;; R register adjustment
    4008/    13C5 :                     
    4009/    13C5 :                     skp_tbp:
    4010/    13C5 : 2A 40 EF            	LD	HL,(REGSP)
    4011/    13C8 : F9                  	LD	SP,HL
    4012/    13C9 : 2A 42 EF            	LD	HL,(REGPC)
    4013/    13CC : E5                  	PUSH	HL
    4014/    13CD : DD 2A 3C EF         	LD	IX,(REGIX)
    4015/    13D1 : FD 2A 3E EF         	LD	IY,(REGIY)
    4016/    13D5 : 2A 34 EF            	LD	HL,(REGAFX)
    4017/    13D8 : E5                  	PUSH	HL
    4018/    13D9 : ED 4B 36 EF         	LD	BC,(REGBCX)
    4019/    13DD : ED 5B 38 EF         	LD	DE,(REGDEX)
    4020/    13E1 : 2A 3A EF            	LD	HL,(REGHLX)
    4021/    13E4 : D9                  	EXX
    4022/    13E5 : F1                  	POP	AF
    4023/    13E6 : 08                  	EX	AF,AF'
    4024/    13E7 : 2A 2C EF            	LD	HL,(REGAF)
    4025/    13EA : E5                  	PUSH	HL
    4026/    13EB : ED 4B 2E EF         	LD	BC,(REGBC)
    4027/    13EF : ED 5B 30 EF         	LD	DE,(REGDE)
    4028/    13F3 : 2A 32 EF            	LD	HL,(REGHL)
    4029/    13F6 : 3A 44 EF            	LD	A,(REGI)
    4030/    13F9 : ED 47               	LD	I,A
    4031/    13FB : 3A 45 EF            	LD	A,(REGR)
    4032/    13FE : ED 4F               	LD	R,A
    4033/    1400 : F1                  	POP	AF
    4034/    1401 : C9                  	RET			; POP PC
    4035/    1402 :                     
    4036/    1402 :                     set_bp:
    4037/    1402 : 7E                  	ld	a, (hl)
    4038/    1403 : B7                  	or	a
    4039/    1404 : C8                  	ret	z
    4040/    1405 :                     
    4041/    1405 : 1A                  	ld	a, (de)
    4042/    1406 : 4F                  	ld	c, a
    4043/    1407 : 13                  	inc	de
    4044/    1408 : 1A                  	ld	a, (de)
    4045/    1409 : 47                  	ld	b, a	; bc = break point address
    4046/    140A :                     
    4047/    140A : 3E FF               	ld	a, 0FFH
    4048/    140C : 02                  	ld	(bc), a	; insert RST 38H code
    4049/    140D : C9                  	ret
    4050/    140E :                     	
    4051/    140E :                     ;;;
    4052/    140E :                     ;;; SET memory
    4053/    140E :                     ;;; 
    4054/    140E :                     
    4055/    140E :                     SETM:
    4056/    140E : 23                  	INC	HL
    4057/    140F : CD 02 18            	CALL	SKIPSP
    4058/    1412 : CD 12 18            	CALL	RDHEX
    4059/    1415 :                     
    4060/    1415 : DA FE 00            	jp	c, ERR
    4061/    1418 :                     
    4062/    1418 : CD 02 18            	CALL	SKIPSP
    4063/    141B : 7E                  	LD	A,(HL)
    4064/    141C : B7                  	OR	A
    4065/    141D : C2 FE 00            	JP	NZ,ERR
    4066/    1420 : 79                  	LD	A,C
    4067/    1421 : B7                  	OR	A
    4068/    1422 : 20 04               	JR	NZ,SM0
    4069/    1424 : ED 5B 27 EF         	LD	DE,(SADDR)
    4070/    1428 :                     
    4071/    1428 :                     
    4072/    1428 :                     SM0:
    4073/    1428 : EB                  	EX	DE,HL
    4074/    1429 :                     SM1:
    4075/    1429 : CD 51 17            	CALL	HEXOUT4
    4076/    142C : E5                  	PUSH	HL
    4077/    142D : 21 77 1D            	LD	HL,DSEP1
    4078/    1430 : CD 48 17            	CALL	STROUT
    4079/    1433 : E1                  	POP	HL
    4080/    1434 : 7E                  	LD	A,(HL)
    4081/    1435 : E5                  	PUSH	HL
    4082/    1436 : CD 56 17            	CALL	HEXOUT2
    4083/    1439 : 3E 20               	LD	A,' '
    4084/    143B : CD B8 1F            	CALL	CONOUT
    4085/    143E : CD A8 17            	CALL	GETLIN
    4086/    1441 : CD 02 18            	CALL	SKIPSP
    4087/    1444 : 7E                  	LD	A,(HL)
    4088/    1445 : B7                  	OR	A
    4089/    1446 : 20 07               	JR	NZ,SM2
    4090/    1448 :                     	;; Empty  (Increment address)
    4091/    1448 : E1                  	POP	HL
    4092/    1449 : 23                  	INC	HL
    4093/    144A : 22 27 EF            	LD	(SADDR),HL
    4094/    144D : 18 DA               	JR	SM1
    4095/    144F :                     SM2:
    4096/    144F : FE 2D               	CP	'-'
    4097/    1451 : 20 07               	JR	NZ,SM3
    4098/    1453 :                     	;; '-'  (Decrement address)
    4099/    1453 : E1                  	POP	HL
    4100/    1454 : 2B                  	DEC	HL
    4101/    1455 : 22 27 EF            	LD	(SADDR),HL
    4102/    1458 : 18 CF               	JR	SM1
    4103/    145A :                     SM3:
    4104/    145A : FE 2E               	CP	'.'
    4105/    145C : 20 07               	JR	NZ,SM4
    4106/    145E : E1                  	POP	HL
    4107/    145F : 22 27 EF            	LD	(SADDR),HL
    4108/    1462 : C3 BE 00            	JP	WSTART
    4109/    1465 :                     SM4:
    4110/    1465 : CD 12 18            	CALL	RDHEX
    4111/    1468 : B7                  	OR	A
    4112/    1469 : E1                  	POP	HL
    4113/    146A : CA FE 00            	JP	Z,ERR
    4114/    146D : 73                  	LD	(HL),E
    4115/    146E : 23                  	INC	HL
    4116/    146F : 22 27 EF            	LD	(SADDR),HL	; set value
    4117/    1472 :                     
    4118/    1472 :                     	; resave opcode for BP command
    4119/    1472 : ED 5B 67 EF         	ld	de, (bpt1_adr)
    4120/    1476 : 1A                  	ld	a, (de)
    4121/    1477 : 32 66 EF            	ld	(bpt1_op), a
    4122/    147A : ED 5B 6B EF         	ld	de, (bpt2_adr)
    4123/    147E : 1A                  	ld	a, (de)
    4124/    147F : 32 6A EF            	ld	(bpt2_op), a
    4125/    1482 :                     
    4126/    1482 : 18 A5               	JR	SM1
    4127/    1484 :                     
    4128/    1484 :                     ;;;
    4129/    1484 :                     ;;; LOAD HEX file
    4130/    1484 :                     ;;;
    4131/    1484 :                     
    4132/    1484 :                     LOADH:
    4133/    1484 :                     	; clear brk point
    4134/    1484 : AF                  	xor	a
    4135/    1485 : 32 65 EF            	ld	(bpt1_f), a
    4136/    1488 : 32 69 EF            	ld	(bpt2_f), a
    4137/    148B :                     	
    4138/    148B : 23                  	INC	HL
    4139/    148C : CD 02 18            	CALL	SKIPSP
    4140/    148F : CD 12 18            	CALL	RDHEX
    4141/    1492 : CD 02 18            	CALL	SKIPSP
    4142/    1495 : 7E                  	LD	A,(HL)
    4143/    1496 : B7                  	OR	A
    4144/    1497 : C2 FE 00            	JP	NZ,ERR
    4145/    149A :                     
    4146/    149A : 79                  	LD	A,C
    4147/    149B : B7                  	OR	A
    4148/    149C : 20 03               	JR	NZ,LH0
    4149/    149E :                     
    4150/    149E : 11 00 00            	LD	DE,0		;Offset
    4151/    14A1 :                     LH0:
    4152/    14A1 : CD A7 1F            	CALL	CONIN
    4153/    14A4 :                     ;	CALL	UPPER
    4154/    14A4 : FE 53               	CP	'S'
    4155/    14A6 : 28 61               	JR	Z,LHS0
    4156/    14A8 :                     LH1:
    4157/    14A8 : FE 3A               	CP	':'
    4158/    14AA : 28 0D               	JR	Z,LHI0
    4159/    14AC :                     LH2:
    4160/    14AC :                     	;; Skip to EOL
    4161/    14AC : FE 0D               	CP	CR
    4162/    14AE : 28 F1               	JR	Z,LH0
    4163/    14B0 : FE 0A               	CP	LF
    4164/    14B2 : 28 ED               	JR	Z,LH0
    4165/    14B4 :                     LH3:
    4166/    14B4 : CD A7 1F            	CALL	CONIN
    4167/    14B7 : 18 F3               	JR	LH2
    4168/    14B9 :                     
    4169/    14B9 :                     LHI0:
    4170/    14B9 : 3E 2E               	ld	a, '.'
    4171/    14BB : CD B8 1F            	call	CONOUT
    4172/    14BE :                     
    4173/    14BE : CD 6D 17            	CALL	HEXIN
    4174/    14C1 : 4F                  	LD	C,A		; Checksum
    4175/    14C2 : 47                  	LD	B,A		; Length
    4176/    14C3 :                     
    4177/    14C3 : CD 6D 17            	CALL	HEXIN
    4178/    14C6 : 67                  	LD	H,A		; Address H
    4179/    14C7 : 81                  	ADD	A,C
    4180/    14C8 : 4F                  	LD	C,A
    4181/    14C9 :                     
    4182/    14C9 : CD 6D 17            	CALL	HEXIN
    4183/    14CC : 6F                  	LD	L,A		; Address L
    4184/    14CD : 81                  	ADD	A,C
    4185/    14CE : 4F                  	LD	C,A
    4186/    14CF :                     
    4187/    14CF :                     	;; Add offset
    4188/    14CF : 19                  	ADD	HL,DE
    4189/    14D0 :                     
    4190/    14D0 : CD 6D 17            	CALL	HEXIN
    4191/    14D3 : 32 2A EF            	LD	(RECTYP),A
    4192/    14D6 : 81                  	ADD	A,C
    4193/    14D7 : 4F                  	LD	C,A		; Checksum
    4194/    14D8 :                     
    4195/    14D8 : 78                  	LD	A,B
    4196/    14D9 : B7                  	OR	A
    4197/    14DA : 28 14               	JR	Z,LHI3
    4198/    14DC :                     LHI1:
    4199/    14DC : CD 6D 17            	CALL	HEXIN
    4200/    14DF : F5                  	PUSH	AF
    4201/    14E0 : 81                  	ADD	A,C
    4202/    14E1 : 4F                  	LD	C,A		; Checksum
    4203/    14E2 :                     
    4204/    14E2 : 3A 2A EF            	LD	A,(RECTYP)
    4205/    14E5 : B7                  	OR	A
    4206/    14E6 : 20 05               	JR	NZ,LHI20
    4207/    14E8 :                     
    4208/    14E8 : F1                  	POP	AF
    4209/    14E9 : 77                  	LD	(HL),A
    4210/    14EA : 23                  	INC	HL
    4211/    14EB : 18 01               	JR	LHI2
    4212/    14ED :                     LHI20:
    4213/    14ED : F1                  	POP	AF
    4214/    14EE :                     LHI2:
    4215/    14EE : 10 EC               	DJNZ	LHI1
    4216/    14F0 :                     LHI3:
    4217/    14F0 : CD 6D 17            	CALL	HEXIN
    4218/    14F3 : 81                  	ADD	A,C
    4219/    14F4 : 20 0A               	JR	NZ,LHIE		; Checksum error
    4220/    14F6 : 3A 2A EF            	LD	A,(RECTYP)
    4221/    14F9 : B7                  	OR	A
    4222/    14FA : CA B4 14            	JP	Z,LH3
    4223/    14FD : C3 BE 00            	JP	WSTART
    4224/    1500 :                     LHIE:
    4225/    1500 : 21 52 1D            	LD	HL,IHEMSG
    4226/    1503 : CD 48 17            	CALL	STROUT
    4227/    1506 : C3 BE 00            	JP	WSTART
    4228/    1509 :                     	
    4229/    1509 :                     LHS0:
    4230/    1509 : CD A7 1F            	CALL	CONIN
    4231/    150C : 32 2A EF            	LD	(RECTYP),A
    4232/    150F :                     
    4233/    150F : CD 6D 17            	CALL	HEXIN
    4234/    1512 : 47                  	LD	B,A		; Length+3
    4235/    1513 : 4F                  	LD	C,A		; Checksum
    4236/    1514 :                     
    4237/    1514 : CD 6D 17            	CALL	HEXIN
    4238/    1517 : 67                  	LD	H,A
    4239/    1518 : 81                  	ADD	A,C
    4240/    1519 : 4F                  	LD	C,A
    4241/    151A :                     	
    4242/    151A : CD 6D 17            	CALL	HEXIN
    4243/    151D : 6F                  	LD	L,A
    4244/    151E : 81                  	ADD	A,C
    4245/    151F : 4F                  	LD	C,A
    4246/    1520 :                     
    4247/    1520 : 19                  	ADD	HL,DE
    4248/    1521 :                     
    4249/    1521 : 05                  	DEC	B
    4250/    1522 : 05                  	DEC	B
    4251/    1523 : 05                  	DEC	B
    4252/    1524 : 28 15               	JR	Z,LHS3
    4253/    1526 :                     LHS1:
    4254/    1526 : CD 6D 17            	CALL	HEXIN
    4255/    1529 : F5                  	PUSH	AF
    4256/    152A : 81                  	ADD	A,C
    4257/    152B : 4F                  	LD	C,A		; Checksum
    4258/    152C :                     
    4259/    152C : 3A 2A EF            	LD	A,(RECTYP)
    4260/    152F : FE 31               	CP	'1'
    4261/    1531 : 20 05               	JR	NZ,LHS2
    4262/    1533 :                     
    4263/    1533 : F1                  	POP	AF
    4264/    1534 : 77                  	LD	(HL),A
    4265/    1535 : 23                  	INC	HL
    4266/    1536 : 18 01               	JR	LHS20
    4267/    1538 :                     LHS2:
    4268/    1538 : F1                  	POP	AF
    4269/    1539 :                     LHS20:
    4270/    1539 : 10 EB               	DJNZ	LHS1
    4271/    153B :                     LHS3:
    4272/    153B : CD 6D 17            	CALL	HEXIN
    4273/    153E : 81                  	ADD	A,C
    4274/    153F : FE FF               	CP	0FFH
    4275/    1541 : 20 12               	JR	NZ,LHSE
    4276/    1543 :                     
    4277/    1543 : 3A 2A EF            	LD	A,(RECTYP)
    4278/    1546 : FE 37               	CP	'7'
    4279/    1548 : 28 11               	JR	Z,LHSR
    4280/    154A : FE 38               	CP	'8'
    4281/    154C : 28 0D               	JR	Z,LHSR
    4282/    154E : FE 39               	CP	'9'
    4283/    1550 : 28 09               	JR	Z,LHSR
    4284/    1552 : C3 B4 14            	JP	LH3
    4285/    1555 :                     LHSE:
    4286/    1555 : 21 5F 1D            	LD	HL,SHEMSG
    4287/    1558 : CD 48 17            	CALL	STROUT
    4288/    155B :                     LHSR:
    4289/    155B : C3 BE 00            	JP	WSTART
    4290/    155E :                     	
    4291/    155E :                     ;;;
    4292/    155E :                     ;;; SAVE HEX file
    4293/    155E :                     ;;;
    4294/    155E :                     
    4295/    155E :                     SAVEH:
    4296/    155E : 23                  	INC	HL
    4297/    155F : 7E                  	LD	A,(HL)
    4298/    1560 :                     ;	CALL	UPPER
    4299/    1560 : FE 49               	CP	'I'
    4300/    1562 : 28 04               	JR	Z,SH0
    4301/    1564 : FE 53               	CP	'S'
    4302/    1566 : 20 04               	JR	NZ,SH1
    4303/    1568 :                     SH0:
    4304/    1568 : 23                  	INC	HL
    4305/    1569 : 32 29 EF            	LD	(HEXMOD),A
    4306/    156C :                     SH1:
    4307/    156C : CD 02 18            	CALL	SKIPSP
    4308/    156F : CD 12 18            	CALL	RDHEX
    4309/    1572 : B7                  	OR	A
    4310/    1573 : 28 1C               	JR	Z,SHE
    4311/    1575 : D5                  	PUSH	DE
    4312/    1576 : DD E1               	POP	IX		; IX = Start address
    4313/    1578 : CD 02 18            	CALL	SKIPSP
    4314/    157B : 7E                  	LD	A,(HL)
    4315/    157C : FE 2C               	CP	','
    4316/    157E : 20 11               	JR	NZ,SHE
    4317/    1580 : 23                  	INC	HL
    4318/    1581 : CD 02 18            	CALL	SKIPSP
    4319/    1584 : CD 12 18            	CALL	RDHEX		; DE = End address
    4320/    1587 : B7                  	OR	A
    4321/    1588 : 28 07               	JR	Z,SHE
    4322/    158A : CD 02 18            	CALL	SKIPSP
    4323/    158D : 7E                  	LD	A,(HL)
    4324/    158E : B7                  	OR	A
    4325/    158F : 28 03               	JR	Z,SH2
    4326/    1591 :                     SHE:
    4327/    1591 : C3 FE 00            	JP	ERR
    4328/    1594 :                     
    4329/    1594 :                     SH2:
    4330/    1594 : DD E5               	PUSH	IX
    4331/    1596 : E1                  	POP	HL
    4332/    1597 : EB                  	EX	DE,HL
    4333/    1598 : 23                  	INC	HL
    4334/    1599 : B7                  	OR	A
    4335/    159A : ED 52               	SBC	HL,DE		; HL = Length
    4336/    159C :                     SH3:
    4337/    159C : CD BC 15            	CALL	SHL00
    4338/    159F : 7C                  	LD	A,H
    4339/    15A0 : B5                  	OR	L
    4340/    15A1 : 20 F9               	JR	NZ,SH3
    4341/    15A3 :                     
    4342/    15A3 : 3A 29 EF            	LD	A,(HEXMOD)
    4343/    15A6 : FE 49               	CP	'I'
    4344/    15A8 : 20 09               	JR	NZ,SH4
    4345/    15AA :                     	;; End record for Intel HEX
    4346/    15AA : 21 7B 1D            	LD	HL,IHEXER
    4347/    15AD : CD 48 17            	CALL	STROUT
    4348/    15B0 : C3 BE 00            	JP	WSTART
    4349/    15B3 :                     SH4:
    4350/    15B3 :                     	;; End record for Motorola S record
    4351/    15B3 : 21 89 1D            	LD	HL,SRECER
    4352/    15B6 : CD 48 17            	CALL	STROUT
    4353/    15B9 : C3 BE 00            	JP	WSTART
    4354/    15BC :                     
    4355/    15BC :                     SHL00:
    4356/    15BC : 0E 10               	LD	C,16
    4357/    15BE : 7C                  	LD	A,H
    4358/    15BF : B7                  	OR	A
    4359/    15C0 : 20 05               	JR	NZ,SHL0
    4360/    15C2 : 7D                  	LD	A,L
    4361/    15C3 : B9                  	CP	C
    4362/    15C4 : 30 01               	JR	NC,SHL0
    4363/    15C6 : 4F                  	LD	C,A
    4364/    15C7 :                     SHL0:
    4365/    15C7 : 06 00               	LD	B,0
    4366/    15C9 : B7                  	OR	A
    4367/    15CA : ED 42               	SBC	HL,BC
    4368/    15CC : 41                  	LD	B,C
    4369/    15CD :                     
    4370/    15CD : 3A 29 EF            	LD	A,(HEXMOD)
    4371/    15D0 : FE 49               	CP	'I'
    4372/    15D2 : 20 30               	JR	NZ,SHLS
    4373/    15D4 :                     
    4374/    15D4 :                     	;; Intel HEX
    4375/    15D4 : 3E 3A               	LD	A,':'
    4376/    15D6 : CD B8 1F            	CALL	CONOUT
    4377/    15D9 :                     
    4378/    15D9 : 78                  	LD	A,B
    4379/    15DA : CD 56 17            	CALL	HEXOUT2		; Length
    4380/    15DD : 48                  	LD	C,B		; Checksum
    4381/    15DE :                     
    4382/    15DE : 7A                  	LD	A,D
    4383/    15DF : CD 56 17            	CALL	HEXOUT2
    4384/    15E2 : 7A                  	LD	A,D
    4385/    15E3 : 81                  	ADD	A,C
    4386/    15E4 : 4F                  	LD	C,A
    4387/    15E5 :                     	
    4388/    15E5 : 7B                  	LD	A,E
    4389/    15E6 : CD 56 17            	CALL	HEXOUT2
    4390/    15E9 : 7B                  	LD	A,E
    4391/    15EA : 81                  	ADD	A,C
    4392/    15EB : 4F                  	LD	C,A
    4393/    15EC :                     	
    4394/    15EC : AF                  	XOR	A
    4395/    15ED : CD 56 17            	CALL	HEXOUT2
    4396/    15F0 :                     SHLI0:
    4397/    15F0 : 1A                  	LD	A,(DE)
    4398/    15F1 : F5                  	PUSH	AF
    4399/    15F2 : CD 56 17            	CALL	HEXOUT2
    4400/    15F5 : F1                  	POP	AF
    4401/    15F6 : 81                  	ADD	A,C
    4402/    15F7 : 4F                  	LD	C,A
    4403/    15F8 :                     
    4404/    15F8 : 13                  	INC	DE
    4405/    15F9 : 10 F5               	DJNZ	SHLI0
    4406/    15FB :                     
    4407/    15FB : 79                  	LD	A,C
    4408/    15FC : ED 44               	NEG
    4409/    15FE : CD 56 17            	CALL	HEXOUT2
    4410/    1601 : C3 91 17            	JP	CRLF
    4411/    1604 :                     
    4412/    1604 :                     SHLS:
    4413/    1604 :                     	;; Motorola S record
    4414/    1604 : 3E 53               	LD	A,'S'
    4415/    1606 : CD B8 1F            	CALL	CONOUT
    4416/    1609 : 3E 31               	LD	A,'1'
    4417/    160B : CD B8 1F            	CALL	CONOUT
    4418/    160E :                     
    4419/    160E : 78                  	LD	A,B
    4420/    160F : C6 03               	ADD	A,2+1		; DataLength + 2(Addr) + 1(Sum)
    4421/    1611 : 4F                  	LD	C,A
    4422/    1612 : CD 56 17            	CALL	HEXOUT2
    4423/    1615 :                     
    4424/    1615 : 7A                  	LD	A,D
    4425/    1616 : CD 56 17            	CALL	HEXOUT2
    4426/    1619 : 7A                  	LD	A,D
    4427/    161A : 81                  	ADD	A,C
    4428/    161B : 4F                  	LD	C,A
    4429/    161C :                     	
    4430/    161C : 7B                  	LD	A,E
    4431/    161D : CD 56 17            	CALL	HEXOUT2
    4432/    1620 : 7B                  	LD	A,E
    4433/    1621 : 81                  	ADD	A,C
    4434/    1622 : 4F                  	LD	C,A
    4435/    1623 :                     SHLS0:
    4436/    1623 : 1A                  	LD	A,(DE)
    4437/    1624 : F5                  	PUSH	AF
    4438/    1625 : CD 56 17            	CALL	HEXOUT2		; Data
    4439/    1628 : F1                  	POP	AF
    4440/    1629 : 81                  	ADD	A,C
    4441/    162A : 4F                  	LD	C,A
    4442/    162B :                     
    4443/    162B : 13                  	INC	DE
    4444/    162C : 10 F5               	DJNZ	SHLS0
    4445/    162E :                     
    4446/    162E : 79                  	LD	A,C
    4447/    162F : 2F                  	CPL
    4448/    1630 : CD 56 17            	CALL	HEXOUT2
    4449/    1633 : C3 91 17            	JP	CRLF
    4450/    1636 :                     
    4451/    1636 :                     ;;;
    4452/    1636 :                     ;;; Register
    4453/    1636 :                     ;;;
    4454/    1636 :                     
    4455/    1636 :                     REG:
    4456/    1636 : 23                  	INC	HL
    4457/    1637 : CD 02 18            	CALL	SKIPSP
    4458/    163A :                     ;	CALL	UPPER
    4459/    163A : B7                  	OR	A
    4460/    163B : 20 06               	JR	NZ,RG0
    4461/    163D : CD BC 16            	CALL	RDUMP
    4462/    1640 : C3 BE 00            	JP	WSTART
    4463/    1643 :                     RG0:
    4464/    1643 : EB                  	EX	DE,HL
    4465/    1644 : 21 3F 1E            	LD	HL,RNTAB
    4466/    1647 :                     RG1:
    4467/    1647 : BE                  	CP	(HL)
    4468/    1648 : 28 0D               	JR	Z,RG2		; Character match
    4469/    164A : 4F                  	LD	C,A
    4470/    164B : 23                  	INC	HL
    4471/    164C : 7E                  	LD	A,(HL)
    4472/    164D : B7                  	OR	A
    4473/    164E : 28 69               	JR	Z,RGE		; Found end mark
    4474/    1650 : 79                  	LD	A,C
    4475/    1651 : 01 05 00            	LD	BC,5
    4476/    1654 : 09                  	ADD	HL,BC		; Next entry
    4477/    1655 : 18 F0               	JR	RG1
    4478/    1657 :                     RG2:
    4479/    1657 : 23                  	INC	HL
    4480/    1658 : 7E                  	LD	A,(HL)
    4481/    1659 : FE 0F               	CP	0FH		; Link code
    4482/    165B : 20 09               	JR	NZ,RG3
    4483/    165D :                     	;; Next table
    4484/    165D : 23                  	INC	HL
    4485/    165E : 4E                  	LD	C,(HL)
    4486/    165F : 23                  	INC	HL
    4487/    1660 : 66                  	LD	H,(HL)
    4488/    1661 : 69                  	LD	L,C
    4489/    1662 : 13                  	INC	DE
    4490/    1663 : 1A                  	LD	A,(DE)
    4491/    1664 :                     ;	CALL	UPPER
    4492/    1664 : 18 E1               	JR	RG1
    4493/    1666 :                     RG3:
    4494/    1666 : B7                  	OR	A
    4495/    1667 : 28 50               	JR	Z,RGE		; Found end mark
    4496/    1669 :                     
    4497/    1669 : 4E                  	LD	C,(HL)		; LD C,A???
    4498/    166A : 23                  	INC	HL
    4499/    166B : 5E                  	LD	E,(HL)
    4500/    166C : 23                  	INC	HL
    4501/    166D : 56                  	LD	D,(HL)
    4502/    166E : D5                  	PUSH	DE		; Reg storage address
    4503/    166F : 23                  	INC	HL
    4504/    1670 : 7E                  	LD	A,(HL)
    4505/    1671 : 23                  	INC	HL
    4506/    1672 : 66                  	LD	H,(HL)
    4507/    1673 : 6F                  	LD	L,A		; HL: Reg name
    4508/    1674 : CD 48 17            	CALL	STROUT
    4509/    1677 : 3E 3D               	LD	A,'='
    4510/    1679 : CD B8 1F            	CALL	CONOUT
    4511/    167C :                     
    4512/    167C : 79                  	LD	A,C
    4513/    167D : E6 07               	AND	07H
    4514/    167F : FE 01               	CP	1
    4515/    1681 : 20 08               	JR	NZ,RG4
    4516/    1683 :                     	;; 8 bit register
    4517/    1683 : E1                  	POP	HL
    4518/    1684 : 7E                  	LD	A,(HL)
    4519/    1685 : E5                  	PUSH	HL
    4520/    1686 : CD 56 17            	CALL	HEXOUT2
    4521/    1689 : 18 0C               	JR	RG5
    4522/    168B :                     RG4:
    4523/    168B :                     	;; 16 bit register
    4524/    168B : E1                  	POP	HL
    4525/    168C : E5                  	PUSH	HL
    4526/    168D : 23                  	INC	HL
    4527/    168E : 7E                  	LD	A,(HL)
    4528/    168F : CD 56 17            	CALL	HEXOUT2
    4529/    1692 : 2B                  	DEC	HL
    4530/    1693 : 7E                  	LD	A,(HL)
    4531/    1694 : CD 56 17            	CALL	HEXOUT2
    4532/    1697 :                     RG5:
    4533/    1697 : 3E 20               	LD	A,' '
    4534/    1699 : CD B8 1F            	CALL	CONOUT
    4535/    169C : C5                  	PUSH	BC		; C: reg size
    4536/    169D : CD A8 17            	CALL	GETLIN
    4537/    16A0 : CD 02 18            	CALL	SKIPSP
    4538/    16A3 : CD 12 18            	CALL	RDHEX
    4539/    16A6 : B7                  	OR	A
    4540/    16A7 : 28 0D               	JR	Z,RGR
    4541/    16A9 : C1                  	POP	BC
    4542/    16AA : E1                  	POP	HL
    4543/    16AB : 79                  	LD	A,C
    4544/    16AC : FE 01               	CP	1
    4545/    16AE : 20 03               	JR	NZ,RG6
    4546/    16B0 :                     	;; 8 bit register
    4547/    16B0 : 73                  	LD	(HL),E
    4548/    16B1 : 18 03               	JR	RG7
    4549/    16B3 :                     RG6:
    4550/    16B3 :                     	;; 16 bit register
    4551/    16B3 : 73                  	LD	(HL),E
    4552/    16B4 : 23                  	INC	HL
    4553/    16B5 : 72                  	LD	(HL),D
    4554/    16B6 :                     RG7:
    4555/    16B6 :                     RGR:
    4556/    16B6 : C3 BE 00            	JP	WSTART
    4557/    16B9 :                     RGE:
    4558/    16B9 : C3 FE 00            	JP	ERR
    4559/    16BC :                     
    4560/    16BC :                     RDUMP:
    4561/    16BC : 21 96 1D            	LD	HL,RDTAB
    4562/    16BF :                     RD0:
    4563/    16BF : 5E                  	LD	E,(HL)
    4564/    16C0 : 23                  	INC	HL
    4565/    16C1 : 56                  	LD	D,(HL)
    4566/    16C2 : 23                  	INC	HL
    4567/    16C3 : 7A                  	LD	A,D
    4568/    16C4 : B3                  	OR	E
    4569/    16C5 : CA 91 17            	JP	Z,CRLF		; End
    4570/    16C8 : D5                  	push	de
    4571/    16C9 : EB                  	EX	DE,HL
    4572/    16CA : CD 48 17            	CALL	STROUT	; print name of register
    4573/    16CD : EB                  	EX	DE,HL
    4574/    16CE : D1                  	pop	de
    4575/    16CF :                     
    4576/    16CF :                     ; flag check
    4577/    16CF : 3E 1E               	ld	a, RDSF_H
    4578/    16D1 : BA                  	cp	d
    4579/    16D2 : 20 07               	jr	nz, rd101
    4580/    16D4 : 3E 01               	ld	a, RDSF_L
    4581/    16D6 : BB                  	cp	e
    4582/    16D7 : 20 02               	jr	nz, rd101
    4583/    16D9 : 18 29               	jr	rd20
    4584/    16DB :                     
    4585/    16DB :                     rd101:
    4586/    16DB : 3E 1E               	ld	a, RDSFX_H
    4587/    16DD : BA                  	cp	d
    4588/    16DE : 20 05               	jr	nz, rd10
    4589/    16E0 : 3E 28               	ld	a, RDSFX_L
    4590/    16E2 : BB                  	cp	e
    4591/    16E3 : 28 1F               	jr	z, rd20
    4592/    16E5 :                     
    4593/    16E5 :                     rd10:
    4594/    16E5 : 5E                  	LD	E,(HL)
    4595/    16E6 : 23                  	INC	HL
    4596/    16E7 : 56                  	LD	D,(HL)
    4597/    16E8 : 23                  	INC	HL
    4598/    16E9 : 7E                  	LD	A,(HL)
    4599/    16EA : 23                  	INC	HL
    4600/    16EB : EB                  	EX	DE,HL
    4601/    16EC : FE 01               	CP	1
    4602/    16EE : 20 07               	JR	NZ,RD1
    4603/    16F0 :                     	;; 1 byte
    4604/    16F0 : 7E                  	LD	A,(HL)
    4605/    16F1 : CD 56 17            	CALL	HEXOUT2
    4606/    16F4 : EB                  	EX	DE,HL
    4607/    16F5 : 18 C8               	JR	RD0
    4608/    16F7 :                     RD1:
    4609/    16F7 :                     	;; 2 byte
    4610/    16F7 : 23                  	INC	HL
    4611/    16F8 : 7E                  	LD	A,(HL)
    4612/    16F9 : CD 56 17            	CALL	HEXOUT2		; High byte
    4613/    16FC : 2B                  	DEC	HL
    4614/    16FD : 7E                  	LD	A,(HL)
    4615/    16FE : CD 56 17            	CALL	HEXOUT2		; Low byte
    4616/    1701 : EB                  	EX	DE,HL
    4617/    1702 : 18 BB               	JR	RD0
    4618/    1704 :                     
    4619/    1704 :                     ; make flag image string
    4620/    1704 :                     rd20:
    4621/    1704 : 5E                  	LD	E,(HL)
    4622/    1705 : 23                  	INC	HL
    4623/    1706 : 56                  	LD	D,(HL)
    4624/    1707 : 23                  	INC	HL
    4625/    1708 : 1A                  	ld	a, (de)		; get flag values
    4626/    1709 :                     
    4627/    1709 : D5                  	push	de
    4628/    170A : E5                  	push	hl
    4629/    170B :                     
    4630/    170B :                     ; make flag image
    4631/    170B :                     
    4632/    170B : 21 71 EF            	ld	hl, F_bit
    4633/    170E : 01 38 17            	ld	bc, F_bit_on
    4634/    1711 : 11 40 17            	ld	de, F_bit_off
    4635/    1714 : F5                  	push	af		; adjustment SP. DO NOT DELETE THIS LINE!
    4636/    1715 :                     
    4637/    1715 :                     flg_loop:
    4638/    1715 : F1                  	pop	af		; "push af" before loop back
    4639/    1716 : CB 27               	sla	a
    4640/    1718 : 30 06               	jr	nc, flg_off
    4641/    171A : F5                  	push	af
    4642/    171B : 0A                  	ld	a, (bc)
    4643/    171C : 77                  	ld	(hl), a
    4644/    171D : F1                  	pop	af
    4645/    171E : 18 04               	jr	flg_nxt
    4646/    1720 :                     flg_off:
    4647/    1720 : F5                  	push	af
    4648/    1721 : 1A                  	ld	a, (de)
    4649/    1722 : 77                  	ld	(hl), a
    4650/    1723 : F1                  	pop	af
    4651/    1724 :                     
    4652/    1724 :                     flg_nxt:
    4653/    1724 : 03                  	inc	bc
    4654/    1725 : 13                  	inc	de
    4655/    1726 : 23                  	inc	hl
    4656/    1727 :                     
    4657/    1727 : F5                  	push	af
    4658/    1728 : 7E                  	ld	a, (hl)
    4659/    1729 : B7                  	or	a		;check delimiter
    4660/    172A : 20 E9               	jr	nz, flg_loop
    4661/    172C :                     
    4662/    172C : F1                  	pop	af		; restore stack position
    4663/    172D : 21 71 EF            	ld	hl, F_bit
    4664/    1730 : CD 48 17            	call	STROUT		; print flag register for bit imaze
    4665/    1733 :                     
    4666/    1733 : E1                  	pop	hl
    4667/    1734 : D1                  	pop	de
    4668/    1735 :                     
    4669/    1735 : 23                  	inc	hl
    4670/    1736 : 18 87               	JR	RD0
    4671/    1738 :                     
    4672/    1738 : 53 5A 2E 48 2E 50   F_bit_on:	db	"SZ.H.PNC"
             173E : 4E 43             
    4673/    1740 : 2E 2E 2E 2E 2E 2E   F_bit_off:	db	"........"
             1746 : 2E 2E             
    4674/    1748 :                     
    4675/    1748 :                     
    4676/    1748 :                     ;;;
    4677/    1748 :                     ;;; Other support routines
    4678/    1748 :                     ;;;
    4679/    1748 :                     
    4680/    1748 :                     STROUT:
    4681/    1748 : 7E                  	LD	A,(HL)
    4682/    1749 : A7                  	AND	A
    4683/    174A : C8                  	RET	Z
    4684/    174B : CD B8 1F            	CALL	CONOUT
    4685/    174E : 23                  	INC	HL
    4686/    174F : 18 F7               	JR	STROUT
    4687/    1751 :                     
    4688/    1751 :                     ; input:  HL
    4689/    1751 :                     ; output: 4 hex_char output console
    4690/    1751 :                     
    4691/    1751 :                     HEXOUT4:
    4692/    1751 : 7C                  	LD	A,H
    4693/    1752 : CD 56 17            	CALL	HEXOUT2
    4694/    1755 : 7D                  	LD	A,L
    4695/    1756 :                     
    4696/    1756 :                     ; input:  A
    4697/    1756 :                     ; output: 2 hex_char output console
    4698/    1756 :                     HEXOUT2:
    4699/    1756 : F5                  	PUSH	AF
    4700/    1757 : 1F                  	RRA
    4701/    1758 : 1F                  	RRA
    4702/    1759 : 1F                  	RRA
    4703/    175A : 1F                  	RRA
    4704/    175B : CD 5F 17            	CALL	HEXOUT1
    4705/    175E : F1                  	POP	AF
    4706/    175F :                     
    4707/    175F :                     ; input:  A
    4708/    175F :                     ; output: 1 hex_char output console
    4709/    175F :                     HEXOUT1:
    4710/    175F : E6 0F               	AND	0FH
    4711/    1761 : C6 30               	ADD	A,'0'
    4712/    1763 : FE 3A               	CP	'9'+1
    4713/    1765 : DA B8 1F            	JP	C,CONOUT
    4714/    1768 : C6 07               	ADD	A,'A'-'9'-1
    4715/    176A : C3 B8 1F            	JP	CONOUT
    4716/    176D :                     
    4717/    176D :                     HEXIN:
    4718/    176D : AF                  	XOR	A
    4719/    176E : CD 75 17            	CALL	HI0
    4720/    1771 : 07                  	RLCA
    4721/    1772 : 07                  	RLCA
    4722/    1773 : 07                  	RLCA
    4723/    1774 : 07                  	RLCA
    4724/    1775 :                     HI0:
    4725/    1775 : C5                  	PUSH	BC
    4726/    1776 : 4F                  	LD	C,A
    4727/    1777 : CD A7 1F            	CALL	CONIN
    4728/    177A :                     ;	CALL	UPPER
    4729/    177A : FE 30               	CP	'0'
    4730/    177C : 38 11               	JR	C,HIR
    4731/    177E : FE 3A               	CP	'9'+1
    4732/    1780 : 38 0A               	JR	C,HI1
    4733/    1782 : FE 41               	CP	'A'
    4734/    1784 : 38 09               	JR	C,HIR
    4735/    1786 : FE 47               	CP	'F'+1
    4736/    1788 : 30 05               	JR	NC,HIR
    4737/    178A : D6 07               	SUB	'A'-'9'-1
    4738/    178C :                     HI1:
    4739/    178C : D6 30               	SUB	'0'
    4740/    178E : B1                  	OR	C
    4741/    178F :                     HIR:
    4742/    178F : C1                  	POP	BC
    4743/    1790 : C9                  	RET
    4744/    1791 :                     	
    4745/    1791 :                     CRLF:
    4746/    1791 : 3E 0D               	LD	A,CR
    4747/    1793 : CD B8 1F            	CALL	CONOUT
    4748/    1796 : 3E 0A               	LD	A,LF
    4749/    1798 : C3 B8 1F            	JP	CONOUT
    4750/    179B :                     
    4751/    179B :                     CLR_CRT:
    4752/    179B : E5                  	PUSH	HL
    4753/    179C : 21 A4 17            	LD	HL, ESC_CRT_CLR
    4754/    179F : CD 48 17            	CALL	STROUT
    4755/    17A2 : E1                  	POP	HL
    4756/    17A3 : C9                  	RET
    4757/    17A4 :                     	
    4758/    17A4 :                     ESC_CRT_CLR:
    4759/    17A4 : 1B                  	db	01BH
    4760/    17A5 : 5B 32               	db	"[2"
    4761/    17A7 : 00                  	db	0
    4762/    17A8 :                     
    4763/    17A8 :                     GETLIN:
    4764/    17A8 : 21 00 EF            	LD	HL,INBUF
    4765/    17AB :                     
    4766/    17AB :                     GL0:	; input hl
    4767/    17AB :                     
    4768/    17AB : C5                  	PUSH	BC
    4769/    17AC : E5                  	push	hl
    4770/    17AD : 06 00               	LD	B,0
    4771/    17AF :                     
    4772/    17AF :                     GL00:
    4773/    17AF : CD A7 1F            	CALL	CONIN
    4774/    17B2 : FE 0D               	CP	CR
    4775/    17B4 : 28 44               	JR	Z,GLE
    4776/    17B6 : FE 0A               	CP	LF
    4777/    17B8 : 28 40               	JR	Z,GLE
    4778/    17BA : FE 08               	CP	BS
    4779/    17BC : 28 25               	JR	Z,GLB
    4780/    17BE : FE 7F               	CP	DEL
    4781/    17C0 : 28 21               	JR	Z,GLB
    4782/    17C2 : FE 20               	CP	' '
    4783/    17C4 : 38 E9               	JR	C,GL00
    4784/    17C6 : FE 80               	CP	80H
    4785/    17C8 : 30 E5               	JR	NC,GL00
    4786/    17CA : 4F                  	LD	C,A
    4787/    17CB : 78                  	LD	A,B
    4788/    17CC : FE 1F               	CP	BUFLEN-1
    4789/    17CE : 30 DF               	JR	NC,GL00	; Too long
    4790/    17D0 : 04                  	INC	B
    4791/    17D1 : 79                  	LD	A,C
    4792/    17D2 : CD B8 1F            	CALL	CONOUT
    4793/    17D5 : FE 61               	cp	'a'
    4794/    17D7 : 38 06               	jr	c, GL1
    4795/    17D9 : FE 7B               	cp	'z'+1
    4796/    17DB : 30 02               	jr	nc, GL1
    4797/    17DD : E6 DF               	and	0DFH	; make upper code
    4798/    17DF :                     GL1:
    4799/    17DF : 77                  	LD	(HL),A
    4800/    17E0 : 23                  	INC	HL
    4801/    17E1 : 18 CC               	JR	GL00
    4802/    17E3 :                     GLB:
    4803/    17E3 : 78                  	LD	A,B
    4804/    17E4 : A7                  	AND	A
    4805/    17E5 : 28 C8               	JR	Z,GL00
    4806/    17E7 : 05                  	DEC	B
    4807/    17E8 : 2B                  	DEC	HL
    4808/    17E9 : 3E 08               	LD	A,08H
    4809/    17EB : CD B8 1F            	CALL	CONOUT
    4810/    17EE : 3E 20               	LD	A,' '
    4811/    17F0 : CD B8 1F            	CALL	CONOUT
    4812/    17F3 : 3E 08               	LD	A,08H
    4813/    17F5 : CD B8 1F            	CALL	CONOUT
    4814/    17F8 : 18 B5               	JR	GL00
    4815/    17FA :                     GLE:
    4816/    17FA : CD 91 17            	CALL	CRLF
    4817/    17FD : 36 00               	LD	(HL),00H
    4818/    17FF : E1                  	pop	hl
    4819/    1800 : C1                  	POP	BC
    4820/    1801 : C9                  	RET
    4821/    1802 :                     
    4822/    1802 :                     SKIPSP:
    4823/    1802 : 7E                  	LD	A,(HL)
    4824/    1803 : FE 20               	CP	' '
    4825/    1805 : C0                  	RET	NZ
    4826/    1806 : 23                  	INC	HL
    4827/    1807 : 18 F9               	JR	SKIPSP
    4828/    1809 :                     
    4829/    1809 :                     UPPER:
    4830/    1809 : FE 61               	CP	'a'
    4831/    180B : D8                  	RET	C
    4832/    180C : FE 7B               	CP	'z'+1
    4833/    180E : D0                  	RET	NC
    4834/    180F : C6 E0               	ADD	A,'A'-'a'
    4835/    1811 : C9                  	RET
    4836/    1812 :                     
    4837/    1812 :                     RDHEX:
    4838/    1812 : 0E 00               	LD	C,0
    4839/    1814 : 11 00 00            	LD	DE,0
    4840/    1817 :                     RH0:
    4841/    1817 : 7E                  	LD	A,(HL)
    4842/    1818 :                     ;	CALL	UPPER
    4843/    1818 : FE 30               	CP	'0'
    4844/    181A : 38 2C               	JR	C,RHE
    4845/    181C : FE 3A               	CP	'9'+1
    4846/    181E : 38 0A               	JR	C,RH1
    4847/    1820 : FE 41               	CP	'A'
    4848/    1822 : 38 24               	JR	C,RHE
    4849/    1824 : FE 47               	CP	'F'+1
    4850/    1826 : 30 20               	JR	NC,RHE
    4851/    1828 : D6 07               	SUB	'A'-'9'-1
    4852/    182A :                     RH1:
    4853/    182A : D6 30               	SUB	'0'
    4854/    182C : 17                  	RLA
    4855/    182D : 17                  	RLA
    4856/    182E : 17                  	RLA
    4857/    182F : 17                  	RLA
    4858/    1830 : 17                  	RLA
    4859/    1831 : CB 13               	RL	E
    4860/    1833 : CB 12               	RL	D
    4861/    1835 : 17                  	RLA
    4862/    1836 : CB 13               	RL	E
    4863/    1838 : CB 12               	RL	D
    4864/    183A : 17                  	RLA
    4865/    183B : CB 13               	RL	E
    4866/    183D : CB 12               	RL	D
    4867/    183F : 17                  	RLA
    4868/    1840 : CB 13               	RL	E
    4869/    1842 : CB 12               	RL	D
    4870/    1844 : 23                  	INC	HL
    4871/    1845 : 0C                  	INC	C
    4872/    1846 : 18 CF               	JR	RH0
    4873/    1848 :                     RHE:
    4874/    1848 : 79                  	ld	a, c
    4875/    1849 : B7                  	or	a
    4876/    184A : 28 06               	jr	z, rhe1
    4877/    184C : FE 05               	cp	5
    4878/    184E : 30 02               	jr	nc, rhe1
    4879/    1850 : B7                  	or	a	; clear carry
    4880/    1851 : C9                  	ret
    4881/    1852 :                     	
    4882/    1852 :                     rhe1:
    4883/    1852 : 37                  	scf	; set carry
    4884/    1853 : C9                  	RET
    4885/    1854 :                     
    4886/    1854 :                     ;;;
    4887/    1854 :                     ;;; API Handler
    4888/    1854 :                     ;;:   C : API entory NO.
    4889/    1854 :                     ;;;
    4890/    1854 :                     
    4891/    1854 :                     RST30H_IN:
    4892/    1854 :                     
    4893/    1854 : E5                  	PUSH	HL
    4894/    1855 : C5                  	PUSH	BC
    4895/    1856 : 21 64 18            	LD	HL,APITBL
    4896/    1859 : 06 00               	LD	B,0
    4897/    185B : 09                  	ADD	HL,BC
    4898/    185C : 09                  	ADD	HL,BC
    4899/    185D : 46                  	LD	B,(HL)
    4900/    185E : 23                  	INC	HL
    4901/    185F : 66                  	LD	H,(HL)
    4902/    1860 : 68                  	LD	L,B
    4903/    1861 : C1                  	POP	BC
    4904/    1862 : E3                  	EX	(SP),HL		; Restore HL, jump address on stack top
    4905/    1863 :                     no_operate:
    4906/    1863 : C9                  	RET
    4907/    1864 :                     
    4908/    1864 :                     APITBL:
    4909/    1864 : 8E 18               	DW	API00		; 00: CSTART
    4910/    1866 : 91 18               	DW	API01		; 01: WSTART
    4911/    1868 : B8 1F               	DW	CONOUT		; 02: CONOUT
    4912/    186A : 48 17               	DW	STROUT		; 03: STROUT
    4913/    186C : A7 1F               	DW	CONIN		; 04: CONIN
    4914/    186E : B2 1F               	DW	CONST		; 05: CONST
    4915/    1870 : D3 18               	DW	API06		; 06: PSPEC
    4916/    1872 : 51 17               	DW	HEXOUT4		; 07: CONOUT HEX4bytes: input HL
    4917/    1874 : 56 17               	DW	HEXOUT2		; 08: CONOUT HEX2bytes: input A
    4918/    1876 : 5F 17               	DW	HEXOUT1		; 09: CONOUT HEX1byte : input A
    4919/    1878 : 9B 17               	DW	CLR_CRT		; 10: Clear screen (ESC+[2)
    4920/    187A : AB 17               	DW	GL0		; 11: GET a line (input HL : input buffer address)
    4921/    187C : 02 18               	DW	SKIPSP		; 12: SKIP Spase
    4922/    187E : 91 17               	DW	CRLF		; 13: CONOUT CRLF
    4923/    1880 : 09 18               	DW	UPPER		; 14: Lower to UPPER
    4924/    1882 : 12 18               	DW	RDHEX		; 15: get hex number from chr buffer
    4925/    1884 :                     				;     input  HL : hex string buffer
    4926/    1884 :                     				;     output DE : hex number
    4927/    1884 :                     				;            CF=1 : error, C, A = hex counts(1-4)
    4928/    1884 : A7 1A               	DW	DEC_STR		; 16: get decimal srtings
    4929/    1886 :                     				; input hl : return storings buffer addr.
    4930/    1886 :                     				;       de : 16bit binary
    4931/    1886 : DD 1A               	DW	DIV16_8		; 17; division 16bit / 8bit
    4932/    1888 : 53 1B               	DW	MUL_8		; 18: multiply 8bit * 8bit
    4933/    188A : =>TRUE               	IF RAM12K
    4934/    188A : 0A 1A               	DW	STOPW		; 19: stopwatch
    4935/    188C : =>FALSE              	ELSE
    4936/    188C :                     	DW	no_operate	; 19: no operation : if RAM12K=0
    4937/    188C : [4933]               	ENDIF
    4938/    188C : F1 07               	dw	get_disasm_st	; 20: dis assemble string
    4939/    188E :                     				;     input: HL buffer. need 42bytes
    4940/    188E :                     				;     output : DE : next MC address
    4941/    188E :                     				;              A  : disassembled MC size
    4942/    188E :                     
    4943/    188E :                     	;; CSTART
    4944/    188E :                     API00:
    4945/    188E : C3 40 00            	JP	CSTART
    4946/    1891 :                     
    4947/    1891 :                     	;; WSTART from API
    4948/    1891 :                     API01:
    4949/    1891 : 31 00 EF            	LD	SP,STACKM	; reset SP for monitor
    4950/    1894 :                     
    4951/    1894 :                     ; check stop by bp and trace operation
    4952/    1894 :                     
    4953/    1894 : 3A 6D EF            	ld	a, (tmpb_f)
    4954/    1897 : B7                  	or	a
    4955/    1898 : 28 06               	jr	z, ws_chk1
    4956/    189A : 21 6E EF            	ld	hl, tmpb_op
    4957/    189D : CD C2 19            	call	rstr_tpt
    4958/    18A0 :                     ws_chk1:
    4959/    18A0 : 3A 5D EF            	ld	a, (tpt1_f)
    4960/    18A3 : B7                  	or	a
    4961/    18A4 : 28 06               	jr	z, ws_chk2
    4962/    18A6 : 21 5E EF            	ld	hl, tpt1_op
    4963/    18A9 : CD C2 19            	call	rstr_tpt
    4964/    18AC :                     
    4965/    18AC :                     ws_chk2:
    4966/    18AC : 3A 61 EF            	ld	a, (tpt2_f)
    4967/    18AF : B7                  	or	a
    4968/    18B0 : 28 06               	jr	z, ws_chk3
    4969/    18B2 : 21 62 EF            	ld	hl, tpt2_op
    4970/    18B5 : CD C2 19            	call	rstr_tpt
    4971/    18B8 :                     ws_chk3:
    4972/    18B8 : 3A 69 EF            	ld	a, (bpt2_f)
    4973/    18BB : B7                  	or	a
    4974/    18BC : 28 06               	jr	z, ws_chk4
    4975/    18BE : 21 6A EF            	ld	hl, bpt2_op
    4976/    18C1 : CD CE 19            	call	rstr_bpt
    4977/    18C4 :                     ws_chk4:
    4978/    18C4 : 3A 65 EF            	ld	a, (bpt1_f)
    4979/    18C7 : B7                  	or	a
    4980/    18C8 : 28 06               	jr	z, ws_chk5
    4981/    18CA : 21 66 EF            	ld	hl, bpt1_op
    4982/    18CD : CD CE 19            	call	rstr_bpt
    4983/    18D0 :                     ws_chk5:
    4984/    18D0 : C3 98 19            	JP	backTomon
    4985/    18D3 :                     
    4986/    18D3 :                     	;; PSPEC
    4987/    18D3 :                     API06:
    4988/    18D3 : AF                  	XOR	A
    4989/    18D4 : C9                  	RET
    4990/    18D5 :                     
    4991/    18D5 :                     ;;;
    4992/    18D5 :                     ;;; Break Point
    4993/    18D5 :                     ;;; trace Point
    4994/    18D5 :                     ;;; go, stop point
    4995/    18D5 :                     ;;; operation handler
    4996/    18D5 :                     ;;
    4997/    18D5 :                     RST38H_IN:
    4998/    18D5 : F5                  	PUSH	AF
    4999/    18D6 : ED 5F               	LD	A,R
    5000/    18D8 : 32 45 EF            	LD	(REGR),A
    5001/    18DB : ED 57               	LD	A,I
    5002/    18DD : 32 44 EF            	LD	(REGI),A
    5003/    18E0 : 22 32 EF            	LD	(REGHL),HL
    5004/    18E3 : ED 53 30 EF         	LD	(REGDE),DE
    5005/    18E7 : ED 43 2E EF         	LD	(REGBC),BC
    5006/    18EB : E1                  	POP	HL
    5007/    18EC : 22 2C EF            	LD	(REGAF),HL
    5008/    18EF : 08                  	EX	AF,AF'
    5009/    18F0 : F5                  	PUSH	AF
    5010/    18F1 : D9                  	EXX
    5011/    18F2 : 22 3A EF            	LD	(REGHLX),HL
    5012/    18F5 : ED 53 38 EF         	LD	(REGDEX),DE
    5013/    18F9 : ED 43 36 EF         	LD	(REGBCX),BC
    5014/    18FD : E1                  	POP	HL
    5015/    18FE : 22 34 EF            	LD	(REGAFX),HL
    5016/    1901 : DD 22 3C EF         	LD	(REGIX),IX
    5017/    1905 : FD 22 3E EF         	LD	(REGIY),IY
    5018/    1909 : E1                  	POP	HL
    5019/    190A : 2B                  	DEC	HL
    5020/    190B : 22 42 EF            	LD	(REGPC),HL
    5021/    190E : ED 73 40 EF         	LD	(REGSP),SP
    5022/    1912 :                     
    5023/    1912 :                     ; check bp and trace operation
    5024/    1912 :                     
    5025/    1912 : 31 00 EF            	LD	SP,STACKM	; reset SP for monitor
    5026/    1915 : AF                  	xor	a
    5027/    1916 : 57                  	ld	d, a
    5028/    1917 : 5F                  	ld	e, a		;clear msg pointer
    5029/    1918 :                     
    5030/    1918 :                     
    5031/    1918 :                     ; check go, end operation
    5032/    1918 : 3A 6D EF            	ld	a, (tmpb_f)
    5033/    191B : B7                  	or	a
    5034/    191C : 28 09               	jr	z, chk_bp
    5035/    191E : 11 F8 19            	ld	de, stpBrk_msg
    5036/    1921 : 21 6E EF            	ld	hl, tmpb_op
    5037/    1924 : CD C2 19            	call	rstr_tpt
    5038/    1927 :                     
    5039/    1927 :                     ; check set break point
    5040/    1927 :                     
    5041/    1927 :                     chk_bp:
    5042/    1927 : 3A 69 EF            	ld	a, (bpt2_f)
    5043/    192A : B7                  	or	a
    5044/    192B : 28 09               	jr	z, bp_chk1
    5045/    192D : 11 F8 19            	ld	de, stpBrk_msg
    5046/    1930 : 21 6A EF            	ld	hl, bpt2_op
    5047/    1933 : CD CE 19            	call	rstr_bpt
    5048/    1936 :                     
    5049/    1936 :                     bp_chk1:
    5050/    1936 : 3A 65 EF            	ld	a, (bpt1_f)
    5051/    1939 : B7                  	or	a
    5052/    193A : 28 09               	jr	z, tp_chk1
    5053/    193C : 11 F8 19            	ld	de, stpBrk_msg
    5054/    193F : 21 66 EF            	ld	hl, bpt1_op
    5055/    1942 : CD CE 19            	call	rstr_bpt
    5056/    1945 :                     
    5057/    1945 :                     ; check trace operation
    5058/    1945 :                     tp_chk1:
    5059/    1945 : 3A 5D EF            	ld	a, (tpt1_f)
    5060/    1948 : B7                  	or	a
    5061/    1949 : 28 09               	jr	z, tp_chk2
    5062/    194B : 11 01 1A            	ld	de, trace_msg
    5063/    194E : 21 5E EF            	ld	hl, tpt1_op
    5064/    1951 : CD C2 19            	call	rstr_tpt
    5065/    1954 :                     
    5066/    1954 :                     tp_chk2:
    5067/    1954 : 3A 61 EF            	ld	a, (tpt2_f)
    5068/    1957 : B7                  	or	a
    5069/    1958 : 28 09               	jr	z, bp_chk_end
    5070/    195A :                     
    5071/    195A : 11 01 1A            	ld	de, trace_msg
    5072/    195D : 21 62 EF            	ld	hl, tpt2_op
    5073/    1960 : CD C2 19            	call	rstr_tpt
    5074/    1963 :                     
    5075/    1963 :                     bp_chk_end:
    5076/    1963 : 7A                  	ld	a, d
    5077/    1964 : B3                  	or	e
    5078/    1965 : 20 03               	jr	nz, no_rst38_msg
    5079/    1967 :                     
    5080/    1967 :                     	; set RST 38H message
    5081/    1967 : 11 EE 19            	LD	de,RST38MSG
    5082/    196A :                     
    5083/    196A :                     no_rst38_msg:
    5084/    196A : 1A                  	ld	a, (de)		; get first char of message
    5085/    196B : FE 54               	cp	'T'		; trace ?
    5086/    196D : 28 0C               	jr	z, chk_ntrace
    5087/    196F :                     	
    5088/    196F : EB                  	ex	de, hl
    5089/    1970 : CD 48 17            	CALL	STROUT
    5090/    1973 :                     
    5091/    1973 :                     	;; R register adjustment
    5092/    1973 :                     
    5093/    1973 : CD BC 16            	CALL	RDUMP
    5094/    1976 : CD D5 19            	call	dis_call	; list disassemble
    5095/    1979 : 18 1D               	jr	backTomon	; goto WBOOT
    5096/    197B :                     
    5097/    197B :                     ;
    5098/    197B :                     ; check continue trace operation
    5099/    197B :                     ;
    5100/    197B :                     chk_ntrace:
    5101/    197B : 3A 56 EF            	ld	a, (TP_mode)
    5102/    197E : FE 46               	cp	'F'		; chk
    5103/    1980 : 28 0A               	jr	z, skp_rmsg
    5104/    1982 :                     
    5105/    1982 :                     ;no_trace:
    5106/    1982 : EB                  	ex	de, hl
    5107/    1983 : CD 48 17            	CALL	STROUT
    5108/    1986 :                     
    5109/    1986 :                     	;; R register adjustment
    5110/    1986 :                     
    5111/    1986 : CD BC 16            	CALL	RDUMP
    5112/    1989 : CD D5 19            	call	dis_call	; list disassemble
    5113/    198C :                     
    5114/    198C :                     skp_rmsg:
    5115/    198C : CD B2 1F            	call	CONST
    5116/    198F : 28 13               	jr	z, t_no_ky		; no key in
    5117/    1991 : CD A7 1F            	call	CONIN
    5118/    1994 : FE 03               	cp	03h	; chk CTL+C
    5119/    1996 : 20 0C               	jr	nz, t_no_ky
    5120/    1998 :                     
    5121/    1998 :                     	; stop_trace
    5122/    1998 :                     backTomon:
    5123/    1998 : AF                  	xor	a
    5124/    1999 : 32 5C EF            	ld	(fever_t), a	; clear forever flag
    5125/    199C : 67                  	ld	h, a
    5126/    199D : 6F                  	ld	l, a
    5127/    199E : 22 58 EF            	ld	(TC_cnt), hl
    5128/    19A1 : C3 BE 00            	JP	WSTART
    5129/    19A4 :                     	
    5130/    19A4 :                     	; check trace forever
    5131/    19A4 :                     t_no_ky:
    5132/    19A4 : 3A 5C EF            	ld	a, (fever_t)
    5133/    19A7 : B7                  	or	a
    5134/    19A8 : C2 B9 19            	jp	nz, repeat_trace
    5135/    19AB :                     
    5136/    19AB : 2A 58 EF            	ld	hl, (TC_cnt)
    5137/    19AE : 2B                  	dec	hl
    5138/    19AF : 22 58 EF            	ld	(TC_cnt), hl
    5139/    19B2 : 7D                  	ld	a, l
    5140/    19B3 : B4                  	or	h
    5141/    19B4 : 20 03               	jr	nz, repeat_trace
    5142/    19B6 : C3 BE 00            	JP	WSTART
    5143/    19B9 :                     
    5144/    19B9 :                     repeat_trace:
    5145/    19B9 : 2A 42 EF            	ld	hl, (REGPC)
    5146/    19BC : 22 5A EF            	ld	(tmpT), hl
    5147/    19BF : C3 E1 03            	jp	t_op_chk
    5148/    19C2 :                     
    5149/    19C2 :                     rstr_tpt:	; HL=buffer point
    5150/    19C2 : E5                  	push	hl
    5151/    19C3 : 7E                  	ld	a, (hl)
    5152/    19C4 : 23                  	inc	hl
    5153/    19C5 : 4E                  	ld	c, (hl)
    5154/    19C6 : 23                  	inc	hl
    5155/    19C7 : 46                  	ld	b, (hl)
    5156/    19C8 :                     
    5157/    19C8 : 02                  	ld	(bc), a		; restor OP CODE
    5158/    19C9 : E1                  	pop	hl
    5159/    19CA : AF                  	xor	a
    5160/    19CB : 2B                  	dec	hl
    5161/    19CC : 77                  	ld	(hl), a		; clear trace flag
    5162/    19CD : C9                  	ret
    5163/    19CE :                     
    5164/    19CE :                     rstr_bpt:	; HL=buffer point
    5165/    19CE : 7E                  	ld	a, (hl)
    5166/    19CF : 23                  	inc	hl
    5167/    19D0 : 4E                  	ld	c, (hl)
    5168/    19D1 : 23                  	inc	hl
    5169/    19D2 : 46                  	ld	b, (hl)
    5170/    19D3 :                     
    5171/    19D3 : 02                  	ld	(bc), a		; restor OP CODE
    5172/    19D4 : C9                  	ret
    5173/    19D5 :                     
    5174/    19D5 :                     dis_call:
    5175/    19D5 : 2A 42 EF            	ld	hl, (REGPC)
    5176/    19D8 : 22 7D EF            	ld	(dasm_adr), hl	; set disasm address
    5177/    19DB : CD 47 08            	call	dis_analysis
    5178/    19DE : CD 0C 08            	call	mk_adr_str	; conout address and machine code
    5179/    19E1 : 21 84 EF            	ld	hl, adr_mc_buf
    5180/    19E4 : CD 48 17            	call	STROUT		; conout disassemble strings
    5181/    19E7 : 2A 42 EF            	ld	hl, (REGPC)
    5182/    19EA : 22 7D EF            	ld	(dasm_adr), hl	; restrore disasm address
    5183/    19ED : C9                  	ret
    5184/    19EE :                     
    5185/    19EE :                     RST38MSG:
    5186/    19EE : 52 53 54 20 33 38   	DB	"RST 38H",CR,LF,00H
             19F4 : 48 0D 0A 00       
    5187/    19F8 :                     stpBrk_msg:	
    5188/    19F8 : 42 72 65 61 6B 21   	db	"Break!",CR,LF,00H
             19FE : 0D 0A 00          
    5189/    1A01 :                     trace_msg:	
    5190/    1A01 : 54 72 61 63 65 21   	db	"Trace!",CR,LF,00H
             1A07 : 0D 0A 00          
    5191/    1A0A :                     
    5192/    1A0A : =>TRUE               	IF RAM12K
    5193/    1A0A :                     STOPW:
    5194/    1A0A :                     	; (input) A = 0 : start timer, (output) none
    5195/    1A0A :                     	; (input) A = 1 : stop timer,  (output) BC : msec time, DE : Sec time
    5196/    1A0A :                     	; (input) A = 2 : lap timer,   (output) BC : msec time, DE : Sec time
    5197/    1A0A :                     	; (input) A = 3 : clear timer counter,  (output) none
    5198/    1A0A :                     
    5199/    1A0A : F5                  	push	af
    5200/    1A0B : E5                  	push	hl
    5201/    1A0C : FE 00               	cp	0
    5202/    1A0E : 28 0F               	jr	z, start_tim
    5203/    1A10 : FE 01               	cp	1
    5204/    1A12 : 28 14               	jr	z, stop_tim
    5205/    1A14 : FE 02               	cp	2
    5206/    1A16 : 28 16               	jr	z, lap_tim
    5207/    1A18 : FE 03               	cp	3
    5208/    1A1A : 28 50               	jr	z, clr_tim
    5209/    1A1C : E1                  	pop	hl
    5210/    1A1D : F1                  	pop	af
    5211/    1A1E : C9                  	ret
    5212/    1A1F :                     
    5213/    1A1F :                     start_tim:
    5214/    1A1F : 21 00 F8            	ld	hl, TIM0_CTL0
    5215/    1A22 : 3E 90               	ld	a, 90h
    5216/    1A24 : 77                  	ld	(hl),a		; enable timer 0
    5217/    1A25 : E1                  	pop	hl
    5218/    1A26 : F1                  	pop	af
    5219/    1A27 : C9                  	ret
    5220/    1A28 :                     	
    5221/    1A28 :                     stop_tim:
    5222/    1A28 : 21 00 F8            	ld	hl, TIM0_CTL0
    5223/    1A2B : 3E 10               	ld	a, 10h
    5224/    1A2D : 77                  	ld	(hl), a		; disable timer 0
    5225/    1A2E :                     
    5226/    1A2E :                     	; save timer counter
    5227/    1A2E :                     
    5228/    1A2E :                     lap_tim:
    5229/    1A2E : 3A 10 F8            	ld	a, (TIMER0_CNTL)
    5230/    1A31 : 32 46 EF            	ld	(c16b), a
    5231/    1A34 : 3A 11 F8            	ld	a, (TIMER0_CNTH)
    5232/    1A37 : 32 47 EF            	ld	(c16b+1), a
    5233/    1A3A :                     
    5234/    1A3A :                     ; adjust 16bit counter
    5235/    1A3A :                     
    5236/    1A3A : 01 E1 87            	ld	bc, TIMER0_INITC
    5237/    1A3D : 2A 46 EF            	ld	hl, (c16b)
    5238/    1A40 : 7C                  	ld	a, h
    5239/    1A41 : B5                  	or	l	; HL = 0?
    5240/    1A42 : 20 06               	jr	nz, adj_tim1
    5241/    1A44 : ED 43 46 EF         	ld	(c16b), bc
    5242/    1A48 : 18 05               	jr	rd_sec
    5243/    1A4A :                     
    5244/    1A4A :                     adj_tim1:
    5245/    1A4A : ED 42               	sbc	hl, bc
    5246/    1A4C : 22 46 EF            	ld	(c16b), hl
    5247/    1A4F :                     
    5248/    1A4F :                     ; read seconds counter
    5249/    1A4F :                     
    5250/    1A4F :                     rd_sec:
    5251/    1A4F : 3A 20 F8            	ld	a, (TIMER0_SCTL)
    5252/    1A52 : 32 48 EF            	ld	(secb), a
    5253/    1A55 : 3A 21 F8            	ld	a, (TIMER0_SCTH)
    5254/    1A58 : 32 49 EF            	ld	(secb+1), a
    5255/    1A5B :                     
    5256/    1A5B :                     	; convert msec from 16bit counter
    5257/    1A5B :                     
    5258/    1A5B : 2A 46 EF            	ld	hl,(c16b)
    5259/    1A5E : CD 8B 1A            	call	chg_msec	; result BC
    5260/    1A61 : ED 43 4A EF         	ld	(msecb),bc	; save result
    5261/    1A65 : ED 5B 48 EF         	ld	de,(secb)	; get sec counter
    5262/    1A69 : E1                  	pop	hl
    5263/    1A6A : F1                  	pop	af
    5264/    1A6B : C9                  	ret
    5265/    1A6C :                     
    5266/    1A6C :                     clr_tim:
    5267/    1A6C : AF                  	xor	a
    5268/    1A6D : 67                  	ld	h, a
    5269/    1A6E : 6F                  	ld	l, a
    5270/    1A6F : 22 4A EF            	ld	(msecb), hl
    5271/    1A72 : 22 48 EF            	ld	(secb), hl
    5272/    1A75 : 22 46 EF            	ld	(c16b), hl
    5273/    1A78 :                     	
    5274/    1A78 : 32 20 F8            	ld	(TIMER0_SCTL), a
    5275/    1A7B : 32 21 F8            	ld	(TIMER0_SCTH), a
    5276/    1A7E : 3E E8               	ld	a, 0e8h
    5277/    1A80 : 32 10 F8            	ld	(TIMER0_CNTL), a
    5278/    1A83 : 3E 86               	ld	a, 86H
    5279/    1A85 : 32 11 F8            	ld	(TIMER0_CNTH), a
    5280/    1A88 : E1                  	pop	hl
    5281/    1A89 : F1                  	pop	af
    5282/    1A8A : C9                  	ret
    5283/    1A8B :                     
    5284/    1A8B :                     chg_msec:
    5285/    1A8B : AF                  	xor	a
    5286/    1A8C : 47                  	ld	b, a
    5287/    1A8D : 4F                  	ld	c ,a		;cear BC
    5288/    1A8E : 2A 46 EF            	ld	hl, (c16b)	; get 16bit counter
    5289/    1A91 : 7D                  	ld	a, l
    5290/    1A92 :                     u_00:
    5291/    1A92 : FE 1F               	cp	31
    5292/    1A94 : 38 06               	jr	c, u_1
    5293/    1A96 : D6 1F               	sub	31
    5294/    1A98 :                     u_0:
    5295/    1A98 : 6F                  	ld	l, a
    5296/    1A99 : 03                  	inc	bc
    5297/    1A9A : 18 F6               	jr	u_00
    5298/    1A9C :                     
    5299/    1A9C :                     u_1:
    5300/    1A9C : 7C                  	ld	a, h
    5301/    1A9D : B7                  	or	a
    5302/    1A9E : C8                  	ret	z	; can't sub
    5303/    1A9F :                     
    5304/    1A9F : 7D                  	ld	a, l
    5305/    1AA0 : D6 1F               	sub	31
    5306/    1AA2 : ED 44               	neg
    5307/    1AA4 : 25                  	dec	h
    5308/    1AA5 : 18 F1               	jr	u_0
    5309/    1AA7 :                     
    5310/    1AA7 : [5192]               	ENDIF
    5311/    1AA7 :                     
    5312/    1AA7 :                     ;
    5313/    1AA7 :                     ; make decimal string
    5314/    1AA7 :                     ;
    5315/    1AA7 :                     ; input HL : output string buffer
    5316/    1AA7 :                     ;       DE : 16bit binary
    5317/    1AA7 :                     ;
    5318/    1AA7 :                     ; output (HL) : decimal strings
    5319/    1AA7 :                     
    5320/    1AA7 :                     DEC_STR:
    5321/    1AA7 : F5                  	PUSH	AF
    5322/    1AA8 : C5                  	PUSH	BC
    5323/    1AA9 : D5                  	PUSH	DE
    5324/    1AAA : E5                  	push	hl
    5325/    1AAB : DD E5               	push	ix
    5326/    1AAD :                     
    5327/    1AAD : E5                  	push	hl
    5328/    1AAE : DD E1               	pop	ix		; ix: save buffer top address
    5329/    1AB0 :                     
    5330/    1AB0 : EB                  	ex	de, hl		; hl: 16bit binary, de: buffer
    5331/    1AB1 : E5                  	push	hl		; save 16bit binary
    5332/    1AB2 : 21 05 00            	ld	hl, 5
    5333/    1AB5 : 19                  	add	hl, de		; hl = buffer + 5
    5334/    1AB6 : AF                  	xor	a
    5335/    1AB7 : 77                  	ld	(hl), A
    5336/    1AB8 : EB                  	ex	de, hl		; de: buffer + 5, hl : buffer
    5337/    1AB9 : E1                  	pop	hl		; hl : 16bit binary
    5338/    1ABA : 01 01 00            	LD	BC, 1
    5339/    1ABD :                     
    5340/    1ABD :                     LOOP_DEC:
    5341/    1ABD : 3E 0A               	LD	A, 10
    5342/    1ABF : CD DD 1A            	CALL	DIV16_8
    5343/    1AC2 : F6 30               	OR	30H
    5344/    1AC4 : 1B                  	DEC	DE
    5345/    1AC5 : 12                  	LD	(DE), A
    5346/    1AC6 : 0C                  	INC	C
    5347/    1AC7 : 7C                  	LD	A, H
    5348/    1AC8 : B5                  	OR	L
    5349/    1AC9 : 20 F2               	JR	NZ, LOOP_DEC
    5350/    1ACB :                     
    5351/    1ACB : 79                  	LD	A, C
    5352/    1ACC : FE 06               	CP	6
    5353/    1ACE : 28 06               	JR	Z, END_DEC
    5354/    1AD0 :                     
    5355/    1AD0 : DD E5               	push	ix
    5356/    1AD2 : E1                  	pop	hl		; hl : buffer top address
    5357/    1AD3 : EB                  	EX	DE, HL
    5358/    1AD4 : ED B0               	LDIR
    5359/    1AD6 :                     
    5360/    1AD6 :                     END_DEC:
    5361/    1AD6 : DD E1               	pop	ix
    5362/    1AD8 : E1                  	pop	hl
    5363/    1AD9 : D1                  	POP	DE
    5364/    1ADA : C1                  	POP	BC
    5365/    1ADB : F1                  	POP	AF
    5366/    1ADC : C9                  	RET
    5367/    1ADD :                     
    5368/    1ADD :                     
    5369/    1ADD :                     ; DIV 16bit / 8 bit
    5370/    1ADD :                     ; input
    5371/    1ADD :                     ;	HL, A
    5372/    1ADD :                     ; output
    5373/    1ADD :                     ;	result = HL, mod = A
    5374/    1ADD :                     
    5375/    1ADD :                     DIV16_8:
    5376/    1ADD : C5                  	PUSH	BC
    5377/    1ADE : D5                  	PUSH	DE
    5378/    1ADF :                     
    5379/    1ADF : 4F                  	LD	C, A
    5380/    1AE0 : 06 0F               	LD	B, 15
    5381/    1AE2 : AF                  	XOR	A
    5382/    1AE3 : 29                  	ADD	HL, HL
    5383/    1AE4 : 17                  	RLA
    5384/    1AE5 : 91                  	SUB	C
    5385/    1AE6 : 38 0D               	JR	C, D16_MINUS_BEFORE
    5386/    1AE8 : 29                  	ADD	HL, HL
    5387/    1AE9 : 2C                  	INC	L
    5388/    1AEA :                     
    5389/    1AEA :                     D16_PLUS:
    5390/    1AEA : 17                  	RLA
    5391/    1AEB : 91                  	SUB	C
    5392/    1AEC : 38 0C               	JR	C, D16_MINUS_AFTER
    5393/    1AEE :                     
    5394/    1AEE :                     D16_PLUS_AFTER:
    5395/    1AEE : 29                  	ADD	HL, HL
    5396/    1AEF : 2C                  	INC	L
    5397/    1AF0 : 10 F8               	DJNZ	D16_PLUS
    5398/    1AF2 : C3 FE 1A            	JP	D16_END
    5399/    1AF5 :                     
    5400/    1AF5 :                     D16_MINUS_BEFORE:
    5401/    1AF5 : 29                  	ADD	HL, HL
    5402/    1AF6 :                     
    5403/    1AF6 :                     D16_MINUS:
    5404/    1AF6 : 17                  	RLA
    5405/    1AF7 : 81                  	ADD	A, C
    5406/    1AF8 : 38 F4               	JR	C, D16_PLUS_AFTER
    5407/    1AFA :                     
    5408/    1AFA :                     D16_MINUS_AFTER:
    5409/    1AFA : 29                  	ADD	HL, HL
    5410/    1AFB : 10 F9               	DJNZ	D16_MINUS
    5411/    1AFD : 81                  	ADD	A,C
    5412/    1AFE :                     D16_END:
    5413/    1AFE : D1                  	POP	DE
    5414/    1AFF : C1                  	POP	BC
    5415/    1B00 : C9                  	RET
    5416/    1B01 :                     
    5417/    1B01 :                     ;
    5418/    1B01 :                     ; input : HL / DE
    5419/    1B01 :                     ; output : quotient HL
    5420/    1B01 :                     ;	   remainder DE
    5421/    1B01 :                     
    5422/    1B01 :                     DIV16:
    5423/    1B01 : 22 4C EF            	LD	(DIV16_NA), HL
    5424/    1B04 : ED 53 4E EF         	LD	(DIV16_NB), DE
    5425/    1B08 :                     
    5426/    1B08 : AF                  	XOR	A
    5427/    1B09 : 32 50 EF            	LD	(DIV16_NC), A
    5428/    1B0C : 32 51 EF            	LD	(DIV16_NC+1), A
    5429/    1B0F : 32 52 EF            	LD	(DIV16_ND), A
    5430/    1B12 : 32 53 EF            	LD	(DIV16_ND+1), A
    5431/    1B15 : 06 10               	LD	B, 16
    5432/    1B17 :                     
    5433/    1B17 :                     DIV16_X2:
    5434/    1B17 : 21 50 EF            	LD	HL, DIV16_NC
    5435/    1B1A : CB 26               	SLA	(HL)
    5436/    1B1C : 23                  	INC	HL
    5437/    1B1D : CB 16               	RL	(HL)
    5438/    1B1F :                     
    5439/    1B1F : 21 4C EF            	LD	HL, DIV16_NA
    5440/    1B22 : CB 26               	SLA	(HL)
    5441/    1B24 : 23                  	INC	HL
    5442/    1B25 : CB 16               	RL	(HL)
    5443/    1B27 : 21 52 EF            	LD	HL, DIV16_ND
    5444/    1B2A : CB 16               	RL	(HL)
    5445/    1B2C : 23                  	INC	HL
    5446/    1B2D : CB 16               	RL	(HL)
    5447/    1B2F :                     
    5448/    1B2F : 2A 4E EF            	LD	HL, (DIV16_NB)
    5449/    1B32 : 5D                  	LD	E, L
    5450/    1B33 : 54                  	LD	D, H
    5451/    1B34 : 2A 52 EF            	LD	HL, (DIV16_ND)
    5452/    1B37 : AF                  	XOR	A
    5453/    1B38 : ED 52               	SBC	HL, DE
    5454/    1B3A : 30 02               	JR	NC, DIV16_X0
    5455/    1B3C : 18 0B               	JR	DIV16_X1
    5456/    1B3E :                     
    5457/    1B3E :                     DIV16_X0:
    5458/    1B3E : 22 52 EF            	LD	(DIV16_ND), HL
    5459/    1B41 :                     
    5460/    1B41 : 3A 50 EF            	LD	A, (DIV16_NC)
    5461/    1B44 : F6 01               	OR	1
    5462/    1B46 : 32 50 EF            	LD	(DIV16_NC), A
    5463/    1B49 :                     
    5464/    1B49 :                     DIV16_X1:
    5465/    1B49 : 10 CC               	DJNZ	DIV16_X2
    5466/    1B4B :                     
    5467/    1B4B : 2A 50 EF            	LD	HL,(DIV16_NC)
    5468/    1B4E : ED 5B 52 EF         	LD	DE,(DIV16_ND)
    5469/    1B52 : C9                  	RET
    5470/    1B53 :                     
    5471/    1B53 :                     ; 8bit * 8bit : ans = 16bit
    5472/    1B53 :                     ; input A , BC
    5473/    1B53 :                     ; output HL
    5474/    1B53 :                     
    5475/    1B53 :                     MUL_8:
    5476/    1B53 : F5                  	PUSH	AF
    5477/    1B54 : C5                  	PUSH	BC
    5478/    1B55 : B7                  	OR	A	; clear carry
    5479/    1B56 : 18 04               	JR	ST_MUL8
    5480/    1B58 :                     
    5481/    1B58 :                     LOOP_M8:
    5482/    1B58 : CB 21               	SLA	C
    5483/    1B5A : CB 10               	RL	B
    5484/    1B5C :                     
    5485/    1B5C :                     ST_MUL8:
    5486/    1B5C : 1F                  	RRA
    5487/    1B5D : 30 F9               	JR	NC, LOOP_M8
    5488/    1B5F : 09                  	ADD	HL, BC
    5489/    1B60 : 20 F6               	JR	NZ, LOOP_M8
    5490/    1B62 : C1                  	POP	BC
    5491/    1B63 : F1                  	POP	AF
    5492/    1B64 : C9                  	RET
    5493/    1B65 :                     ;;;
    5494/    1B65 :                     ;;; Messages
    5495/    1B65 :                     ;;;
    5496/    1B65 :                     
    5497/    1B65 : 3F 20 3A 43 6F 6D   cmd_hlp:	db	"? :Command Help", CR, LF
             1B6B : 6D 61 6E 64 20 48 
             1B71 : 65 6C 70 0D 0A    
    5498/    1B76 : 44 5B 3C 61 64 72   		db	"D[<adr>] :Dump Memory", CR, LF
             1B7C : 3E 5D 20 3A 44 75 
             1B82 : 6D 70 20 4D 65 6D 
             1B88 : 6F 72 79 0D 0A    
    5499/    1B8D : 53 5B 3C 61 64 72   		db	"S[<adr>] :Set Memory", CR, LF
             1B93 : 3E 5D 20 3A 53 65 
             1B99 : 74 20 4D 65 6D 6F 
             1B9F : 72 79 0D 0A       
    5500/    1BA3 : 52 5B 3C 72 65 67   		db	"R[<reg>] :Set or Dump register", CR, LF
             1BA9 : 3E 5D 20 3A 53 65 
             1BAF : 74 20 6F 72 20 44 
             1BB5 : 75 6D 70 20 72 65 
             1BBB : 67 69 73 74 65 72 
             1BC1 : 0D 0A             
    5501/    1BC3 : 47 5B 3C 61 64 72   		db	"G[<adr>][,<stop adr>] :Go and Stop", CR, LF
             1BC9 : 3E 5D 5B 2C 3C 73 
             1BCF : 74 6F 70 20 61 64 
             1BD5 : 72 3E 5D 20 3A 47 
             1BDB : 6F 20 61 6E 64 20 
             1BE1 : 53 74 6F 70 0D 0A 
    5502/    1BE7 : 4C 20 3A 4C 6F 61   		db	"L :Load HexFile", CR, LF
             1BED : 64 20 48 65 78 46 
             1BF3 : 69 6C 65 0D 0A    
    5503/    1BF8 : 50 5B 49 7C 53 5D   		db	"P[I|S] :Save HexFile(I:Intel,S:Motorola)", CR, LF
             1BFE : 20 3A 53 61 76 65 
             1C04 : 20 48 65 78 46 69 
             1C0A : 6C 65 28 49 3A 49 
             1C10 : 6E 74 65 6C 2C 53 
             1C16 : 3A 4D 6F 74 6F 72 
             1C1C : 6F 6C 61 29 0D 0A 
    5504/    1C22 : 23 4C 7C 3C 6E 75   		db	"#L|<num> :Launch program", CR, LF
             1C28 : 6D 3E 20 3A 4C 61 
             1C2E : 75 6E 63 68 20 70 
             1C34 : 72 6F 67 72 61 6D 
             1C3A : 0D 0A             
    5505/    1C3C : 42 5B 31 7C 32 5B   		db	"B[1|2[,<adr>]] :Set or List Break Point", CR, LF
             1C42 : 2C 3C 61 64 72 3E 
             1C48 : 5D 5D 20 3A 53 65 
             1C4E : 74 20 6F 72 20 4C 
             1C54 : 69 73 74 20 42 72 
             1C5A : 65 61 6B 20 50 6F 
             1C60 : 69 6E 74 0D 0A    
    5506/    1C65 : 42 43 5B 31 7C 32   		db	"BC[1|2] :Clear Break Point", CR, LF
             1C6B : 5D 20 3A 43 6C 65 
             1C71 : 61 72 20 42 72 65 
             1C77 : 61 6B 20 50 6F 69 
             1C7D : 6E 74 0D 0A       
    5507/    1C81 : 54 5B 3C 61 64 72   		db	"T[<adr>][,<steps>|-1] : Trace command", CR, LF
             1C87 : 3E 5D 5B 2C 3C 73 
             1C8D : 74 65 70 73 3E 7C 
             1C93 : 2D 31 5D 20 3A 20 
             1C99 : 54 72 61 63 65 20 
             1C9F : 63 6F 6D 6D 61 6E 
             1CA5 : 64 0D 0A          
    5508/    1CA8 : 54 50 5B 4F 4E 7C   		db	"TP[ON|OFF] :Trace Print Mode", CR, LF
             1CAE : 4F 46 46 5D 20 3A 
             1CB4 : 54 72 61 63 65 20 
             1CBA : 50 72 69 6E 74 20 
             1CC0 : 4D 6F 64 65 0D 0A 
    5509/    1CC6 : 54 4D 5B 49 7C 53   		db	"TM[I|S] :Trace Option for CALL", CR, LF
             1CCC : 5D 20 3A 54 72 61 
             1CD2 : 63 65 20 4F 70 74 
             1CD8 : 69 6F 6E 20 66 6F 
             1CDE : 72 20 43 41 4C 4C 
             1CE4 : 0D 0A             
    5510/    1CE6 : 44 49 5B 3C 61 64   		db	"DI[<adr>][,s<steps>|<adr>] :Disassemble", CR, LF, 00h
             1CEC : 72 3E 5D 5B 2C 73 
             1CF2 : 3C 73 74 65 70 73 
             1CF8 : 3E 7C 3C 61 64 72 
             1CFE : 3E 5D 20 3A 44 69 
             1D04 : 73 61 73 73 65 6D 
             1D0A : 62 6C 65 0D 0A 00 
    5511/    1D10 :                     
    5512/    1D10 :                     OPNMSG:
    5513/    1D10 : 0D 0A               	DB	CR,LF
    5514/    1D12 : 45 4D 55 5A 38 30   	db	"EMUZ80 MONITOR Rev.B02.1",CR,LF
             1D18 : 20 4D 4F 4E 49 54 
             1D1E : 4F 52 20 52 65 76 
             1D24 : 2E 42 30 32 2E 31 
             1D2A : 0D 0A             
    5515/    1D2C : 54 68 69 73 20 6D   	db	"This monitor is based on unimon.",CR,LF,00H
             1D32 : 6F 6E 69 74 6F 72 
             1D38 : 20 69 73 20 62 61 
             1D3E : 73 65 64 20 6F 6E 
             1D44 : 20 75 6E 69 6D 6F 
             1D4A : 6E 2E 0D 0A 00    
    5516/    1D4F :                     
    5517/    1D4F :                     PROMPT:
    5518/    1D4F : 5D 20 00            	DB	"] ",00H
    5519/    1D52 :                     
    5520/    1D52 :                     IHEMSG:
    5521/    1D52 : 45 72 72 6F 72 20   	DB	"Error ihex",CR,LF,00H
             1D58 : 69 68 65 78 0D 0A 
             1D5E : 00                
    5522/    1D5F :                     SHEMSG:
    5523/    1D5F : 45 72 72 6F 72 20   	DB	"Error srec",CR,LF,00H
             1D65 : 73 72 65 63 0D 0A 
             1D6B : 00                
    5524/    1D6C :                     ERRMSG:
    5525/    1D6C : 45 72 72 6F 72 0D   	DB	"Error",CR,LF,00H
             1D72 : 0A 00             
    5526/    1D74 :                     
    5527/    1D74 :                     DSEP0:
    5528/    1D74 : 20 3A 00            	DB	" :",00H
    5529/    1D77 :                     DSEP1:
    5530/    1D77 : 20 3A 20 00         	DB	" : ",00H
    5531/    1D7B :                     IHEXER:
    5532/    1D7B : 3A 30 30 30 30 30           DB	":00000001FF",CR,LF,00H
             1D81 : 30 30 31 46 46 0D 
             1D87 : 0A 00             
    5533/    1D89 :                     SRECER:
    5534/    1D89 : 53 39 30 33 30 30           DB	"S9030000FC",CR,LF,00H
             1D8F : 30 30 46 43 0D 0A 
             1D95 : 00                
    5535/    1D96 :                     
    5536/    1D96 :                     	;; Register dump table
    5537/    1D96 : EB 1D 2D EF         RDTAB:	DW	RDSA,   REGAF+1
    5538/    1D9A : 01                  	DB	1
    5539/    1D9B : EF 1D 2E EF         	DW	RDSBC,  REGBC
    5540/    1D9F : 02                  	DB	2
    5541/    1DA0 : F5 1D 30 EF         	DW	RDSDE,  REGDE
    5542/    1DA4 : 02                  	DB	2
    5543/    1DA5 : FB 1D 32 EF         	DW	RDSHL,  REGHL
    5544/    1DA9 : 02                  	DB	2
    5545/    1DAA : 01 1E 2C EF         	DW	RDSF,   REGAF
    5546/    1DAE : 01                  	DB	1
    5547/    1DAF :                     
    5548/    1DAF : 06 1E 3C EF         	DW	RDSIX,  REGIX
    5549/    1DB3 : 02                  	DB	2
    5550/    1DB4 : 0B 1E 3E EF         	DW	RDSIY,  REGIY
    5551/    1DB8 : 02                  	DB	2
    5552/    1DB9 :                     
    5553/    1DB9 : 10 1E 35 EF         	DW	RDSAX,  REGAFX+1
    5554/    1DBD : 01                  	DB	1
    5555/    1DBE : 16 1E 36 EF         	DW	RDSBCX, REGBCX
    5556/    1DC2 : 02                  	DB	2
    5557/    1DC3 : 1C 1E 38 EF         	DW	RDSDEX, REGDEX
    5558/    1DC7 : 02                  	DB	2
    5559/    1DC8 : 22 1E 3A EF         	DW	RDSHLX, REGHLX
    5560/    1DCC : 02                  	DB	2
    5561/    1DCD : 28 1E 34 EF         	DW	RDSFX,  REGAFX
    5562/    1DD1 : 01                  	DB	1
    5563/    1DD2 :                     
    5564/    1DD2 : 2D 1E 40 EF         	DW	RDSSP,  REGSP
    5565/    1DD6 : 02                  	DB	2
    5566/    1DD7 : 32 1E 42 EF         	DW	RDSPC,  REGPC
    5567/    1DDB : 02                  	DB	2
    5568/    1DDC : 37 1E 44 EF         	DW	RDSI,   REGI
    5569/    1DE0 : 01                  	DB	1
    5570/    1DE1 : 3B 1E 45 EF         	DW	RDSR,   REGR
    5571/    1DE5 : 01                  	DB	1
    5572/    1DE6 :                     
    5573/    1DE6 : 00 00 00 00         	DW	0000H,  0000H
    5574/    1DEA : 00                  	DB	0
    5575/    1DEB :                     
    5576/    1DEB : 41 20 3D 00         RDSA:	DB	"A =",00H
    5577/    1DEF : 20 42 43 20 3D 00   RDSBC:	DB	" BC =",00H
    5578/    1DF5 : 20 44 45 20 3D 00   RDSDE:	DB	" DE =",00H
    5579/    1DFB : 20 48 4C 20 3D 00   RDSHL:	DB	" HL =",00H
    5580/    1E01 :                     
    5581/    1E01 : 20 46 20 3D 00      RDSF:	DB	" F =",00H
    5582/    1E06 :                     
    5583/    1E06 : =1EH                 RDSF_H	equ	RDSF >> 8
    5584/    1E06 : =1H                  RDSF_L	equ	RDSF & 0FFh
    5585/    1E06 :                     
    5586/    1E06 :                     
    5587/    1E06 : 20 49 58 3D 00      RDSIX:	DB	" IX=",00H
    5588/    1E0B : 20 49 59 3D 00      RDSIY:	DB	" IY=",00H
    5589/    1E10 : 0D 0A 41 27 3D 00   RDSAX:	DB	CR,LF,"A'=",00H
    5590/    1E16 : 20 42 43 27 3D 00   RDSBCX:	DB	" BC'=",00H
    5591/    1E1C : 20 44 45 27 3D 00   RDSDEX:	DB	" DE'=",00H
    5592/    1E22 : 20 48 4C 27 3D 00   RDSHLX:	DB	" HL'=",00H
    5593/    1E28 :                     
    5594/    1E28 : 20 46 27 3D 00      RDSFX:	DB	" F'=",00H
    5595/    1E2D :                     
    5596/    1E2D : =1EH                 RDSFX_H	equ	RDSFX >> 8
    5597/    1E2D : =28H                 RDSFX_L	equ	RDSFX & 0FFh
    5598/    1E2D :                     
    5599/    1E2D : 20 53 50 3D 00      RDSSP:	DB	" SP=",00H
    5600/    1E32 : 20 50 43 3D 00      RDSPC:	DB	" PC=",00H
    5601/    1E37 : 20 49 3D 00         RDSI:	DB	" I=",00H
    5602/    1E3B : 20 52 3D 00         RDSR:	DB	" R=",00H
    5603/    1E3F :                     
    5604/    1E3F :                     RNTAB:
    5605/    1E3F : 41 0F               	DB	'A',0FH		; "A?"
    5606/    1E41 : 89 1E 00 00         	DW	RNTABA,0
    5607/    1E45 : 42 0F               	DB	'B',0FH		; "B?"
    5608/    1E47 : 97 1E 00 00         	DW	RNTABB,0
    5609/    1E4B : 43 0F               	DB	'C',0FH		; "C?"
    5610/    1E4D : B9 1E 00 00         	DW	RNTABC,0
    5611/    1E51 : 44 0F               	DB	'D',0FH		; "D?"
    5612/    1E53 : C7 1E 00 00         	DW	RNTABD,0
    5613/    1E57 : 45 0F               	DB	'E',0FH		; "E?"
    5614/    1E59 : E9 1E 00 00         	DW	RNTABE,0
    5615/    1E5D : 46 0F               	DB	'F',0FH		; "F?"
    5616/    1E5F : F7 1E 00 00         	DW	RNTABF,0
    5617/    1E63 : 48 0F               	DB	'H',0FH		; "H?"
    5618/    1E65 : 05 1F 00 00         	DW	RNTABH,0
    5619/    1E69 : 49 0F               	DB	'I',0FH		; "I?"
    5620/    1E6B : 35 1F 00 00         	DW	RNTABI,0
    5621/    1E6F : 4C 0F               	DB	'L',0FH		; "L?"
    5622/    1E71 : 27 1F 00 00         	DW	RNTABL,0
    5623/    1E75 : 50 0F               	DB	'P',0FH		; "P?"
    5624/    1E77 : 49 1F 00 00         	DW	RNTABP,0
    5625/    1E7B : 52 01               	DB	'R',1		; "R"
    5626/    1E7D : 45 EF A4 1F         	DW	REGR,RNR
    5627/    1E81 : 53 0F               	DB	'S',0FH		; "S?"
    5628/    1E83 : 51 1F 00 00         	DW	RNTABS,0
    5629/    1E87 :                     
    5630/    1E87 : 00 00               	DB	00H,0		; End mark
    5631/    1E89 :                     
    5632/    1E89 :                     RNTABA:
    5633/    1E89 : 00 01               	DB	00H,1		; "A"
    5634/    1E8B : 2D EF 59 1F         	DW	REGAF+1,RNA
    5635/    1E8F : 27 01               	DB	27H,1		; "A'"
    5636/    1E91 :                     ;;	DB	'\'',1		; "A'"
    5637/    1E91 : 35 EF 72 1F         	DW	REGAFX+1,RNAX
    5638/    1E95 :                     
    5639/    1E95 : 00 00               	DB	00H,0
    5640/    1E97 :                     	
    5641/    1E97 :                     RNTABB:
    5642/    1E97 : 00 01               	DB	00H,1		; "B"
    5643/    1E99 : 2F EF 5E 1F         	DW	REGBC+1,RNB
    5644/    1E9D : 27 01               	DB	27H,1		; "B'"
    5645/    1E9F :                     ;;	DB	'\'',1		; "B'"
    5646/    1E9F : 37 EF 79 1F         	DW	REGBCX+1,RNBX
    5647/    1EA3 : 43 0F               	DB	'C',0FH		; "BC?"
    5648/    1EA5 : AB 1E 00 00         	DW	RNTABBC,0
    5649/    1EA9 :                     
    5650/    1EA9 : 00 00               	DB	00H,0		; End mark
    5651/    1EAB :                     
    5652/    1EAB :                     RNTABBC:
    5653/    1EAB : 00 02               	DB	00H,2		; "BC"
    5654/    1EAD : 2E EF 5B 1F         	DW	REGBC,RNBC
    5655/    1EB1 : 27 02               	DB	27H,2		; "BC'"
    5656/    1EB3 :                     ;;	DB	'\'',2		; "BC'"
    5657/    1EB3 : 36 EF 75 1F         	DW	REGBCX,RNBCX
    5658/    1EB7 :                     
    5659/    1EB7 : 00 00               	DB	00H,0
    5660/    1EB9 :                     	
    5661/    1EB9 :                     RNTABC:
    5662/    1EB9 : 00 01               	DB	00H,1		; "C"
    5663/    1EBB : 2E EF 60 1F         	DW	REGBC,RNC
    5664/    1EBF : 27 01               	DB	27H,1		; "C'"
    5665/    1EC1 :                     ;;	DB	'\'',1		; "C'"
    5666/    1EC1 : 36 EF 7C 1F         	DW	REGBCX,RNCX
    5667/    1EC5 :                     
    5668/    1EC5 : 00 00               	DB	00H,0
    5669/    1EC7 :                     	
    5670/    1EC7 :                     RNTABD:
    5671/    1EC7 : 00 01               	DB	00H,1		; "D"
    5672/    1EC9 : 31 EF 65 1F         	DW	REGDE+1,RND
    5673/    1ECD : 27 01               	DB	27H,1		; "D'"
    5674/    1ECF :                     ;;	DB	'\'',1		; "D'"
    5675/    1ECF : 39 EF 83 1F         	DW	REGDEX+1,RNDX
    5676/    1ED3 : 45 0F               	DB	'E',0FH		; "DE?"
    5677/    1ED5 : DB 1E 00 00         	DW	RNTABDE,0
    5678/    1ED9 :                     
    5679/    1ED9 : 00 00               	DB	00H,0
    5680/    1EDB :                     
    5681/    1EDB :                     RNTABDE:
    5682/    1EDB : 00 02               	DB	00H,2		; "DE"
    5683/    1EDD : 30 EF 62 1F         	DW	REGDE,RNDE
    5684/    1EE1 : 27 02               	DB	27H,2		; "DE'"
    5685/    1EE3 :                     ;;	DB	'\'',2		; "DE'"
    5686/    1EE3 : 38 EF 7F 1F         	DW	REGDEX,RNDEX
    5687/    1EE7 :                     
    5688/    1EE7 : 00 00               	DB	00H,0
    5689/    1EE9 :                     	
    5690/    1EE9 :                     RNTABE:
    5691/    1EE9 : 00 01               	DB	00H,1		; "E"
    5692/    1EEB : 30 EF 67 1F         	DW	REGDE,RNE
    5693/    1EEF : 27 01               	DB	27H,1		; "E'"
    5694/    1EF1 :                     ;;	DB	'\'',1		; "E'"
    5695/    1EF1 : 38 EF 86 1F         	DW	REGDEX,RNEX
    5696/    1EF5 :                     
    5697/    1EF5 : 00 00               	DB	00H,0
    5698/    1EF7 :                     	
    5699/    1EF7 :                     RNTABF:
    5700/    1EF7 : 00 01               	DB	00H,1		; "F"
    5701/    1EF9 : 2C EF 70 1F         	DW	REGAF,RNF
    5702/    1EFD : 27 01               	DB	27H,1		; "F'"
    5703/    1EFF :                     ;;	DB	'\'',1		; "F'"
    5704/    1EFF : 34 EF 93 1F         	DW	REGAFX,RNFX
    5705/    1F03 :                     
    5706/    1F03 : 00 00               	DB	00H,0
    5707/    1F05 :                     	
    5708/    1F05 :                     RNTABH:
    5709/    1F05 : 00 01               	DB	00H,1		; "H"
    5710/    1F07 : 33 EF 6C 1F         	DW	REGHL+1,RNH
    5711/    1F0B : 27 01               	DB	27H,1		; "H'"
    5712/    1F0D :                     ;;	DB	'\'',1		; "H'"
    5713/    1F0D : 3B EF 8D 1F         	DW	REGHLX+1,RNHX
    5714/    1F11 : 4C 0F               	DB	'L',0FH		; "HL?"
    5715/    1F13 : 19 1F 00 00         	DW	RNTABHL,0
    5716/    1F17 :                     
    5717/    1F17 : 00 00               	DB	00H,0
    5718/    1F19 :                     
    5719/    1F19 :                     RNTABHL:
    5720/    1F19 : 00 02               	DB	00H,2		; "HL"
    5721/    1F1B : 32 EF 69 1F         	DW	REGHL,RNHL
    5722/    1F1F : 27 02               	DB	27H,2		; "HL'"
    5723/    1F21 :                     ;;	DB	'\'',2		; "HL'"
    5724/    1F21 : 3A EF 89 1F         	DW	REGHLX,RNHLX
    5725/    1F25 :                     
    5726/    1F25 : 00 00               	DB	00H,0
    5727/    1F27 :                     	
    5728/    1F27 :                     RNTABL:
    5729/    1F27 : 00 01               	DB	00H,1		; "L"
    5730/    1F29 : 32 EF 6E 1F         	DW	REGHL,RNL
    5731/    1F2D : 27 01               	DB	27H,1		; "L'"
    5732/    1F2F :                     ;;	DB	'\'',1		; "L'"
    5733/    1F2F : 3A EF 90 1F         	DW	REGHLX,RNLX
    5734/    1F33 :                     
    5735/    1F33 : 00 00               	DB	00H,0
    5736/    1F35 :                     	
    5737/    1F35 :                     RNTABI:
    5738/    1F35 : 00 01               	DB	00H,1		; "I"
    5739/    1F37 : 44 EF A2 1F         	DW	REGI,RNI
    5740/    1F3B : 58 02               	DB	'X',2		; "IX"
    5741/    1F3D : 3C EF 96 1F         	DW	REGIX,RNIX
    5742/    1F41 : 59 02               	DB	'Y',2		; "IY"
    5743/    1F43 : 3E EF 99 1F         	DW	REGIY,RNIY
    5744/    1F47 :                     	
    5745/    1F47 : 00 00               	DB	00H,0
    5746/    1F49 :                     
    5747/    1F49 :                     RNTABP:
    5748/    1F49 : 43 02               	DB	'C',2		; "PC"
    5749/    1F4B : 42 EF 9F 1F         	DW	REGPC,RNPC
    5750/    1F4F :                     
    5751/    1F4F : 00 00               	DB	00H,0
    5752/    1F51 :                     
    5753/    1F51 :                     RNTABS:
    5754/    1F51 : 50 02               	DB	'P',2		; "SP"
    5755/    1F53 : 40 EF 9C 1F         	DW	REGSP,RNSP
    5756/    1F57 :                     
    5757/    1F57 : 00 00               	DB	00H,0
    5758/    1F59 :                     
    5759/    1F59 : 41 00               RNA:	DB	"A",00H
    5760/    1F5B : 42 43 00            RNBC:	DB	"BC",00H
    5761/    1F5E : 42 00               RNB:	DB	"B",00H
    5762/    1F60 : 43 00               RNC:	DB	"C",00H
    5763/    1F62 : 44 45 00            RNDE:	DB	"DE",00H
    5764/    1F65 : 44 00               RND:	DB	"D",00H
    5765/    1F67 : 45 00               RNE:	DB	"E",00H
    5766/    1F69 : 48 4C 00            RNHL:	DB	"HL",00H
    5767/    1F6C : 48 00               RNH:	DB	"H",00H
    5768/    1F6E : 4C 00               RNL:	DB	"L",00H
    5769/    1F70 : 46 00               RNF:	DB	"F",00H
    5770/    1F72 : 41 27 00            RNAX:	DB	"A'",00H
    5771/    1F75 : 42 43 27 00         RNBCX:	DB	"BC'",00H
    5772/    1F79 : 42 27 00            RNBX:	DB	"B'",00H
    5773/    1F7C : 43 27 00            RNCX:	DB	"C'",00H
    5774/    1F7F : 44 45 27 00         RNDEX:	DB	"DE'",00H
    5775/    1F83 : 44 27 00            RNDX:	DB	"D'",00H
    5776/    1F86 : 45 27 00            RNEX:	DB	"E'",00H
    5777/    1F89 : 48 4C 27 00         RNHLX:	DB	"HL'",00H
    5778/    1F8D : 48 27 00            RNHX:	DB	"H'",00H
    5779/    1F90 : 4C 27 00            RNLX:	DB	"L'",00H
    5780/    1F93 : 46 27 00            RNFX:	DB	"F'",00H
    5781/    1F96 : 49 58 00            RNIX:	DB	"IX",00H
    5782/    1F99 : 49 59 00            RNIY:	DB	"IY",00H
    5783/    1F9C : 53 50 00            RNSP:	DB	"SP",00H
    5784/    1F9F : 50 43 00            RNPC:	DB	"PC",00H
    5785/    1FA2 : 49 00               RNI:	DB	"I",00H
    5786/    1FA4 : 52 00               RNR:	DB	"R",00H
    5787/    1FA6 :                     
    5788/    1FA6 :                     ;;;
    5789/    1FA6 :                     ;;; Cold start for device dependent
    5790/    1FA6 :                     ;;;
    5791/    1FA6 :                     INIT:
    5792/    1FA6 : C9                  	RET
    5793/    1FA7 :                     
    5794/    1FA7 :                     ;;;
    5795/    1FA7 :                     ;;; Console drivers
    5796/    1FA7 :                     ;;;
    5797/    1FA7 :                     
    5798/    1FA7 :                     CONIN:
    5799/    1FA7 : 3A 01 FF            	LD	A,(UARTCR)
    5800/    1FAA : CB 47               	BIT	0,A
    5801/    1FAC : 28 F9               	JR	Z,CONIN
    5802/    1FAE : 3A 00 FF            	LD	A,(UARTDR)
    5803/    1FB1 : C9                  	RET
    5804/    1FB2 :                     
    5805/    1FB2 :                     CONST:
    5806/    1FB2 : 3A 01 FF            	LD	A,(UARTCR)
    5807/    1FB5 : CB 47               	BIT	0,A
    5808/    1FB7 : C9                  	RET
    5809/    1FB8 :                     
    5810/    1FB8 :                     CONOUT:
    5811/    1FB8 : F5                  	PUSH	AF
    5812/    1FB9 : 3A 01 FF            PCST1:	LD	A,(UARTCR)
    5813/    1FBC : CB 4F               	BIT	1,A
    5814/    1FBE : 28 F9               	JR	Z,PCST1
    5815/    1FC0 : F1                  	POP	AF
    5816/    1FC1 : 32 00 FF            	LD	(UARTDR),A
    5817/    1FC4 : C9                  	RET
    5818/    1FC5 :                     
    5819/    1FC5 : FF FF FF FF FF FF   	db	BASIC_TOP - $ dup(0ffH)
             1FCB : FF FF FF FF FF FF 
             1FD1 : FF FF FF FF FF FF 
             1FD7 : FF FF FF FF FF FF 
             1FDD : FF FF FF FF FF FF 
             1FE3 : FF FF FF FF FF FF 
             1FE9 : FF FF FF FF FF FF 
             1FEF : FF FF FF FF FF FF 
             1FF5 : FF FF FF FF FF FF 
             1FFB : FF FF FF FF FF    
    5820/    2000 :                     ;	ORG	BASIC_TOP
    5821/    2000 :                     
    5822/    2000 :                     ;;;
    5823/    2000 :                     ;;; RAM area
    5824/    2000 :                     ;;;
    5825/    2000 :                     
    5826/    2000 :                     	;;
    5827/    2000 :                     	;; Work Area
    5828/    2000 :                     	;;
    5829/    2000 :                     	
    5830/    EF00 :                     	ORG	WORK_B
    5831/    EF00 :                     
    5832/    EF00 : =>FALSE              	IF	BACKDOOR
    5833/    EF00 :                     stealRST08:	ds	2	; hacking RST 08H, set jump address
    5834/    EF00 :                     stealRST10:	ds	2	; hacking RST 10H, set jump address
    5835/    EF00 :                     stealRST18:	ds	2	; hacking RST 18H, set jump address
    5836/    EF00 :                     stealRST20:	ds	2	; hacking RST 20H, set jump address
    5837/    EF00 :                     stealRST28:	ds	2	; hacking RST 28H, set jump address
    5838/    EF00 :                     stealRST30:	ds	2	; hacking RST 30H, set jump address
    5839/    EF00 :                     stealRST38:	ds	2	; hacking RST 38H, set jump address
    5840/    EF00 :                     save_hl:	ds	2
    5841/    EF00 : [5832]               	ENDIF
    5842/    EF00 :                     	
    5843/    EF00 :                     INBUF:	DS	BUFLEN	; Line input buffer
    5844/    EF20 :                     DSADDR:	DS	2	; Dump start address
    5845/    EF22 :                     DEADDR:	DS	2	; Dump end address
    5846/    EF24 :                     DSTATE:	DS	1	; Dump state
    5847/    EF25 :                     GADDR:	DS	2	; Go address
    5848/    EF27 :                     SADDR:	DS	2	; Set address
    5849/    EF29 :                     HEXMOD:	DS	1	; HEX file mode
    5850/    EF2A :                     RECTYP:	DS	1	; Record type
    5851/    EF2B :                     SIZE:	DS	1	; I/O Size 00H,'W','S'
    5852/    EF2C :                     
    5853/    EF2C :                     REG_B:	
    5854/    EF2C :                     REGAF:	DS	2
    5855/    EF2E :                     REGBC:	DS	2
    5856/    EF30 :                     REGDE:	DS	2
    5857/    EF32 :                     REGHL:	DS	2
    5858/    EF34 :                     REGAFX:	DS	2		; Register AF'
    5859/    EF36 :                     REGBCX:	DS	2
    5860/    EF38 :                     REGDEX:	DS	2
    5861/    EF3A :                     REGHLX:	DS	2		; Register HL'
    5862/    EF3C :                     REGIX:	DS	2
    5863/    EF3E :                     REGIY:	DS	2
    5864/    EF40 :                     REGSP:	DS	2
    5865/    EF42 :                     REGPC:	DS	2
    5866/    EF44 :                     REGI:	DS	1
    5867/    EF45 :                     REGR:	DS	1
    5868/    EF46 :                     REG_E:
    5869/    EF46 :                     
    5870/    EF46 : =>TRUE               	IF RAM12K
    5871/    EF46 :                     ; stop watch timer
    5872/    EF46 :                     
    5873/    EF46 :                     c16b:	ds	2	; copy of TIMER0_CNT
    5874/    EF48 :                     secb:	ds	2	; copy of TIMER0_SCTT
    5875/    EF4A :                     msecb:	ds	2
    5876/    EF4C : [5870]               	ENDIF
    5877/    EF4C :                     
    5878/    EF4C :                     ; DIV 16 /16 buffer
    5879/    EF4C :                     DIV16_NA:	ds	2
    5880/    EF4E :                     DIV16_NB:	ds	2
    5881/    EF50 :                     DIV16_NC:	DS	2
    5882/    EF52 :                     DIV16_ND:	DS	2
    5883/    EF54 :                     
    5884/    EF54 :                     ; go command temp start address
    5885/    EF54 :                     goTmp:		ds	2
    5886/    EF56 :                     
    5887/    EF56 :                     ; trace mode switch
    5888/    EF56 :                     TP_mode:	ds	1	; N: display on, F: display off
    5889/    EF57 :                     TM_mode:	ds	1	; 'S':skip call, 'I':trace CALL IN
    5890/    EF58 :                     TC_cnt:		ds	2	; numbers of step
    5891/    EF5A :                     tmpT:		ds	2	; save temp buffer
    5892/    EF5C :                     fever_t:	ds	1	; flag trace forever
    5893/    EF5D :                     
    5894/    EF5D :                     ; break, trace point work area
    5895/    EF5D : =0EF5DH              dbg_wtop	equ	$
    5896/    EF5D :                     tpt1_f:		ds	1
    5897/    EF5E :                     tpt1_op:	ds	1	; save trace point1 opcode
    5898/    EF5F :                     tpt1_adr:	ds	2
    5899/    EF61 :                     tpt2_f:		ds	1
    5900/    EF62 :                     tpt2_op:	ds	1	; save trace point2 opcode (for branch)
    5901/    EF63 :                     tpt2_adr:	ds	2
    5902/    EF65 :                     
    5903/    EF65 :                     ; break point work area
    5904/    EF65 :                     bpt1_f:		ds	1
    5905/    EF66 :                     bpt1_op:	ds	1
    5906/    EF67 :                     bpt1_adr:	ds	2
    5907/    EF69 :                     bpt2_f:		ds	1
    5908/    EF6A :                     bpt2_op:	ds	1
    5909/    EF6B :                     bpt2_adr:	ds	2
    5910/    EF6D :                     
    5911/    EF6D :                     tmpb_f:		ds	1
    5912/    EF6E :                     tmpb_op:	ds	1
    5913/    EF6F :                     tmpb_adr:	ds	2
    5914/    EF71 : =0EF71H              dbg_wend	equ	$
    5915/    EF71 :                     
    5916/    EF71 :                     F_bit:		ds	F_bitSize+1
    5917/    EF7A :                     
    5918/    EF7A :                     ;::::::::::::::::::::::::::
    5919/    EF7A :                     ; DISASEM work area
    5920/    EF7A :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
    5921/    EF7A :                     dasm_ed:	ds	2
    5922/    EF7C :                     dasm_stpf:	ds	1
    5923/    EF7D :                     dasm_adr:	ds	2
    5924/    EF7F :                     reg_xy:		ds	2	; RNIX or RNIY
    5925/    EF81 :                     xy_srtp		ds	2	; strings pointer
    5926/    EF83 :                     
    5927/    EF83 :                     mc_Size:	ds	1
    5928/    EF84 :                     
    5929/    EF84 :                     ;  DidAsm string buffer
    5930/    EF84 :                     ; total 42 bytes
    5931/    EF84 :                     dasm_bs:
    5932/    EF84 :                     adr_mc_buf:	ds	19
    5933/    EF97 :                     dasm_OpcStr:	ds	8
    5934/    EF9F :                     dasm_OprStr:	ds	15
    5935/    EFAE :                     dasm_be:
    5936/    EFAE :                     
    5937/    EFAE :                     	END
 AS V1.42 Beta [Bld 227] - Source File emuz80monRevB021.asm - Page 2 - 10/24/2022 10:32:49


  Symbol Table (* = unused):
  --------------------------

 ACS_KN2K :                    0AD0 C |  ADCSTR :                      1152 C |
 ADDIXRP_TBL :                 12E3 C |  ADDIYRP_TBL :                 12EB C |
 ADDSTR :                      114E C |  ADD_OPSTR :                   1008 C |
 ADD_RP_E :                    10B3 C |  ADD_RP_S :                    10AF C |
 ADJ_TIM1 :                    1A4A C |  ADR_MC_BUF :                 0EF84 C |
 ANDSTR :                      115E C |  APENDTBL :                     15C C |
 API00 :                       188E C |  API01 :                       1891 C |
 API06 :                       18D3 C |  APITBL :                      1864 C |
*ARCHITECTURE :                                        "i386-unknown-win32" - |
 A_COLON_SP :                  105B C |  A_CRLF :                      1026 C |
 BACKDOOR :                       0 - |  BACKTOMON :                   1998 C |
 BASIC_CST :                   2000 - |  BASIC_TOP :                   2000 - |
 BASIC_WST :                   2003 - |  BC_PLUS_DE :                   1FA C |
 BITSTR :                      11D1 C |  BPT1_ADR :                   0EF67 C |
 BPT1_F :                     0EF65 C |  BPT1_OP :                    0EF66 C |
 BPT2_ADR :                   0EF6B C |  BPT2_F :                     0EF69 C |
 BPT2_OP :                    0EF6A C |  BP_CHK1 :                     1936 C |
 BP_CHK_END :                  1963 C |  BP_CLR :                       279 C |
 BP_CLR1 :                      28F C |  BP_LOT :                       2A0 C |
 BP_MSG1 :                      2B6 C |  BP_MSG2 :                      2BA C |
 BRK_CMD :                      222 C |  BS :                             8 - |
 BUFLEN :                        20 - |  B_ACLR :                       294 C |
 B_LIST :                       202 C |  B_LIST1 :                      210 C |
 B_MSG_OUT :                    2BD C |  C16B :                       0EF46 C |
 CALC_DIS_STEP :                7E3 C |  CALLSTR :                     113D C |
*CASESENSITIVE :                  0 - |  CC0 :                         124D C |
 CC1 :                         1250 C |  CC2 :                         1252 C |
 CC3 :                         1255 C |  CC4 :                         1257 C |
 CC5 :                         125A C |  CC6 :                         125D C |
 CC7 :                         125F C |  CCFSTR :                      11A6 C |
 CC_NNNN :                     0BB1 C |  CC_OPR :                      1271 C |
 CHG_MSEC :                    1A8B C |  CHKERR :                       277 C |
 CHK_0CBH :                    0BCE C |  CHK_0DD3OP :                  0D1B C |
 CHK_0DD4OP :                  0D9A C |  CHK_0DDH :                    0C94 C |
 CHK_0DDH_1 :                  0CA7 C |  CHK_0EDH :                    0E3A C |
 CHK_0FDH :                    0F37 C |  CHK_1MC_BNH :                 0A2D C |
 CHK_2MC :                     0A7A C |  CHK_3MC :                     0B2A C |
 CHK_ADC :                      8F3 C |  CHK_ADD :                      8E7 C |
 CHK_ADD_RP :                   9AC C |  CHK_AND :                      91D C |
 CHK_BP :                      1927 C |  CHK_CALCC :                   0BBF C |
 CHK_CALLN4 :                  0B98 C |  CHK_CP :                       941 C |
 CHK_DD_CB :                   0DE6 C |  CHK_DEC :                      966 C |
 CHK_DEC_RP :                   993 C |  CHK_DI1 :                      78B C |
 CHK_DJNZ :                    0AF5 C |  CHK_EX :                       9FC C |
 CHK_FEVRE :                    3CB C |  CHK_INC :                      94E C |
 CHK_INC_RP :                   97A C |  CHK_JPCC :                    0BA4 C |
 CHK_JPN4 :                    0B8C C |  CHK_JRCC :                    0B0E C |
 CHK_JRNN :                    0AFE C |  CHK_LD :                       878 C |
 CHK_LD1 :                      8B6 C |  CHK_LD16 :                    0B4B C |
 CHK_LOGOP2 :                  0AA1 C |  CHK_NTRACE :                  197B C |
 CHK_OR :                       935 C |  CHK_POP_RP :                   9CA C |
 CHK_PUSH_RP :                  9E3 C |  CHK_RET :                     0A40 C |
 CHK_RST :                     0A59 C |  CHK_SBC :                      90E C |
 CHK_STPDI :                    7AA C |  CHK_SUB :                      902 C |
 CHK_XOR :                      929 C |  CLCC_TBLE :                    59B C |
 CLCC_TBLS :                    593 C |  CLR_CRT :                     179B C |
 CLR_TIM :                     1A6C C |  CMD_HLP :                     1B65 C |
 COMMAND_HLP :                  106 C | *COMPMODE :                       0 - |
 CONIN :                       1FA7 C |  CONOUT :                      1FB8 C |
 CONST :                       1FB2 C | *CONSTPI :        3.141592653589793 - |
 CPDRSTR :                     1223 C |  CPDSTR :                      11FD C |
 CPIRSTR :                     120F C |  CPISTR :                      11EC C |
 CPLSTR :                      119E C |  CPSTR :                       1169 C |
 CPSTR_CRLF :                  1034 C |  CR :                            0D - |
 CRLF :                        1791 C |  CSTART :                        40 C |
 D16_END :                     1AFE C |  D16_MINUS :                   1AF6 C |
 D16_MINUS_AFTER :             1AFA C |  D16_MINUS_BEFORE :            1AF5 C |
 D16_PLUS :                    1AEA C |  D16_PLUS_AFTER :              1AEE C |
 DAASTR :                      119A C |  DASM_ADR :                   0EF7D C |
 DASM_BE :                    0EFAE C |  DASM_BS :                    0EF84 C |
 DASM_ED :                    0EF7A C |  DASM_OPCSTR :                0EF97 C |
 DASM_OPRSTR :                0EF9F C |  DASM_STPF :                  0EF7C C |
*DATE :                "10/24/2022" - |  DBG_WEND :                   0EF71 - |
 DBG_WINI :                      7E C |  DBG_WTOP :                   0EF5D - |
 DDLOGTBL :                    12F3 C |  DD_21 :                       0DC0 C |
 DD_22 :                       0DCD C |  DD_2A :                       0DD6 C |
 DD_2A1 :                      0DDA C |  DD_2NDTBL :                    656 C |
 DD_2NDTBL1 :                   65A C |  DD_2NDTBL2 :                   65E C |
 DD_2NDTBL_E :                  660 C |  DD_2OPT :                     12DB C |
 DD_BIT :                      0E2A C |  DD_BIT_OPTBL :                10D7 C |
 DD_BIT_OPTBLE :               10EF C |  DD_BSR :                      0E21 C |
 DD_CB_NN_XX :                 0E06 C |  DD_LD :                       0D5A C |
 DD_LD1 :                      0D72 C |  DD_LDTBL :                    1301 C |
 DD_LD_TBL :                   10BB C |  DD_LD_TBLE :                  10C9 C |
 DD_LOG_TBL :                  10C9 C |  DD_LOG_TBLE :                 10D0 C |
 DD_MIX :                      0D85 C |  DD_MIX1 :                     0D90 C |
 DD_MIX2 :                     0D95 C |  DD_MIX3 :                     0D88 C |
 DD_MIX4 :                     0D7E C |  DD_RES :                      0E32 C |
 DD_RT_STR :                   1339 C |  DD_RT_TBLE :                  10D7 C |
 DD_RT_TBLES :                 10D0 C |  DEADDR :                     0EF22 C |
 DECSTR :                      1170 C |  DEC_OPCDTBLE :                10A7 C |
 DEC_OPCDTBLS :                109F C |  DEC_RP_E :                    10AF C |
 DEC_RP_S :                    10AB C |  DEC_STR :                     1AA7 C |
 DEL :                           7F - |  DIP_TM :                       30E C |
 DISASM_GO :                    7B8 C |  DISASSEMBLE :                  768 C |
 DISREGTBL :                   1261 C |  DISTR :                       11AA C |
 DIS_ANALYSIS :                 847 C |  DIS_CALL :                    19D5 C |
 DIS_GO1 :                      7C3 C | *DIV16 :                       1B01 C |
 DIV16_8 :                     1ADD C |  DIV16_NA :                   0EF4C C |
 DIV16_NB :                   0EF4E C |  DIV16_NC :                   0EF50 C |
 DIV16_ND :                   0EF52 C |  DIV16_X0 :                    1B3E C |
 DIV16_X1 :                    1B49 C |  DIV16_X2 :                    1B17 C |
 DI_NXT :                       771 C |  DJNZSTR :                     1138 C |
 DMKST1 :                      101C C |  DMKST2 :                      101E C |
 DMKSTR0 :                     1012 C |  DONOT_TRACE :                 13AA C |
 DP0 :                          675 C |  DP00 :                         685 C |
 DP1 :                          69A C |  DPB :                          71C C |
 DPB0 :                         733 C |  DPB1 :                         742 C |
 DPB2 :                         747 C |  DPL :                          6E2 C |
 DPL0 :                         6F3 C |  DPL1 :                         703 C |
 DPL2 :                         712 C |  DPL3 :                         717 C |
 DPM :                          6B0 C |  DPM0 :                         6BB C |
 DPM1 :                         6D9 C |  DSADDR :                     0EF20 C |
 DSEP0 :                       1D74 C |  DSEP1 :                       1D77 C |
 DSTATE :                     0EF24 C |  DUMP :                         660 C |
 ED_4MC :                      0F18 C |  ED_ADC :                      0EC6 C |
 ED_IM :                       0EF7 C |  ED_LD_AI :                    0EE0 C |
 ED_LD_AR :                    0ED7 C |  ED_LD_IA :                    0EF2 C |
 ED_LD_RA :                    0EE9 C |  ED_LD_RA1 :                   0EEC C |
 ED_NOOPR :                    130F C |  ED_NO_OPR :                   0F0A C |
 ED_OP_TBL :                   10EF C |  ED_OP_TBLE :                  1127 C |
 ED_OUT :                      0E95 C |  ED_OUT1 :                     0EA9 C |
 ED_RP_STR :                   12CF C |  ED_SBC :                      0EB0 C |
 ED_SBC1 :                     0EBF C |  EISTR :                       11AD C |
 END_DEC :                     1AD6 C |  END_INS_TC :                   503 C |
 ENTRY :                         40 - |  ERR :                          0FE C |
 ERRMSG :                      1D6C C |  ERR_TRACE_SEQ :                506 C |
 ER_OPMSG :                    1240 C |  ESC_CRT_CLR :                 17A4 C |
 EXP_MSB :                      525 C |  EXSTR :                       117D C |
 EXXSTR :                      1180 C |  EX_AF_AF :                    0A17 C |
 EX_SP_HL :                    0A25 C | *E_CSTART :                       0 C |
*E_WSTART :                       3 C | *FALSE :                          0 - |
 FEVER_T :                    0EF5C C |  FLG_LOOP :                    1715 C |
 FLG_NXT :                     1724 C |  FLG_OFF :                     1720 C |
*FULLPMMU :                       1 - |  F_BIT :                      0EF71 C |
 F_BITSIZE :                      8 - |  F_BIT_OFF :                   1740 C |
 F_BIT_ON :                    1738 C |  G0 :                          138A C |
 GADDR :                      0EF25 C |  GETLIN :                      17A8 C |
 GET_BI :                       1D4 C |  GET_DI1 :                      785 C |
 GET_DISASM_ST :                7F1 C |  GET_N4 :                      0B73 C |
 GET_N4CRLF :                  0B45 C |  GET_NNNN :                    0F76 C |
 GET_NUM :                      1B6 C |  GET_NUM0 :                     1B9 C |
 GET_RSTG_OFF :                0F8A C |  GET_R_NUM :                    86F C |
 GET_STRBUFPOINT :             0F8D C |  GL0 :                         17AB C |
 GL00 :                        17AF C |  GL1 :                         17DF C |
 GLB :                         17E3 C |  GLE :                         17FA C |
 GO :                          1347 C |  GO1 :                         1384 C |
 GOSTMP :                      135B C |  GOTMP :                      0EF54 C |
 G_STPADR :                    1365 C |  H2SA_1 :                      0FE2 C |
 H2S_N1 :                      0FF8 C |  H2S_N2 :                      0FFC C |
 H4SA_1 :                      0FD1 C |  H4SA_2 :                      0FD4 C |
*HAS64 :                          0 - | *HASFPU :                         0 - |
*HASPMMU :                        0 - |  HEX2STR :                     0FEF C |
 HEX2STR_ASM :                 0FD9 C |  HEX4STR :                     0FE7 C |
 HEX4STR_ASM :                 0FC8 C |  HEXIN :                       176D C |
 HEXMOD :                     0EF29 C |  HEXOUT1 :                     175F C |
 HEXOUT2 :                     1756 C |  HEXOUT4 :                     1751 C |
 HI0 :                         1775 C |  HI1 :                         178C C |
 HIR :                         178F C |  HLTSTR :                      1149 C |
 HL_CRLF :                     1031 C |  IB1 :                          536 C |
 IB2 :                          535 C |  IB3 :                          534 C |
 ICKA1 :                        56F C |  ICKA_END :                     57A C |
 IHEMSG :                      1D52 C |  IHEXER :                      1D7B C |
 IKK_1 :                       1074 C |  IMSTR :                       11DD C |
 INADR_CHK_AND_WRT :            554 C |  INBUF :                      0EF00 C |
 INCSTR :                      116C C |  INC_DEC :                      960 C |
 INC_DEC_ADDRP :               1289 C |  INC_OPCDTBLE :                109F C |
 INC_OPCDTBLS :                1097 C |  INC_RP_E :                    10AB C |
 INC_RP_S :                    10A7 C |  INDRSTR :                     1228 C |
 INDSTR :                      1201 C |  INIRSTR :                     1214 C |
 INISTR :                      11F0 C | *INIT :                        1FA6 C |
 INS2 :                         5A3 C |  INSBRK_1OP :                   527 C |
 INSBRK_2OP :                   52C C |  INSBRK_3OP :                   531 C |
 INSBRK_BRP :                   53B C |  INSBRK_SP :                    547 C |
 INSPOSTSTR :                  1037 C |  INSTC1 :                       457 C |
*INSTC2 :                       3E5 C |  INSTR :                       11B4 C |
*INSUPMODE :                      0 - |  INS_EX_OPC :                  0A11 C |
 INS_HLKK :                    0B7D C |  INS_HL_OPR :                  0A0E C |
 INS_IXRP :                    0D06 C |  INS_JPIX :                    0CDC C |
*INS_JPIX1 :                   0CE0 C |  INS_KAKKOL :                  106E C |
 INS_KAKKOR :                  1072 C |  INS_KKA :                     0B67 C |
 INS_KKHL :                    0B61 C |  INS_KMR :                     1083 C |
 INS_KN2K :                    0AD9 C |  INS_KN4KCS :                  0FA2 C |
 INS_KSPKIX :                  0CEE C |  INS_MISR :                    107F C |
 INS_N2CRLF :                  0AC6 C |  INS_PLSR :                    107B C |
 INS_RSTG :                    0C79 C |  INS_SPCR :                    1077 C |
 INS_SPIX :                    0CFD C |  IO_B :                       0F000 - |
 IR0 :                           5B C |  IR00 :                          72 C |
 IX_CRLF :                     102B C |  JPCC_TBLE :                    593 C |
 JPCC_TBLS :                    58B C |  JPHL :                         49D C |
 JPSTR :                       1132 C |  JRCC_OPR1 :                   1281 C |
 JRCC_TBLE :                    58B C |  JRCC_TBLS :                    586 C |
 JRCC_TBLS1 :                   587 C |  JRSTR :                       1135 C |
 JR_N4CRLF :                   0B05 C |  KCKSTR :                      1244 C |
 KIXYPNK_CRLF :                0F51 C |  KIXYPNK_CS :                  0F48 C |
 KN2K :                        0AE5 C |  KN4HK :                       0B6D C |
 KN4KCRLF :                    0B83 C |  KRNHL :                       1248 C |
 LANCH1 :                       17C C |  LANCH10 :                      1B4 C |
 LANCH11 :                      1B4 C |  LANCH12 :                      1B4 C |
 LANCH13 :                      1B4 C |  LANCH14 :                      1B4 C |
 LANCH15 :                      1B4 C |  LANCH16 :                      1B4 C |
 LANCH2 :                       198 C |  LANCH3 :                       1B4 C |
 LANCH4 :                       1B4 C |  LANCH5 :                       1B4 C |
 LANCH6 :                       1B4 C |  LANCH7 :                       1B4 C |
 LANCH8 :                       1B4 C |  LANCH9 :                       1B4 C |
 LAP_TIM :                     1A2E C |  LAUNCHER :                     10E C |
 LD1OP :                        8C9 C |  LDDRSTR :                     121E C |
 LDDSTR :                      11F9 C |  LDIRSTR :                     120A C |
 LDISTR :                      11E8 C |  LDSTR :                       1146 C |
 LD_A_KBCK :                    895 C |  LD_A_KDEK :                    8A3 C |
 LD_A_KXXK :                    898 C |  LD_KBCK_A :                    8A8 C |
 LD_KDEK_A :                    8B1 C |  LD_KXXK_A :                    8AB C |
 LD_R_NN_E :                    644 C |  LD_R_NN_S :                    63C C |
 LF :                            0A - |  LH0 :                         14A1 C |
*LH1 :                         14A8 C |  LH2 :                         14AC C |
 LH3 :                         14B4 C |  LHI0 :                        14B9 C |
 LHI1 :                        14DC C |  LHI2 :                        14EE C |
 LHI20 :                       14ED C |  LHI3 :                        14F0 C |
 LHIE :                        1500 C |  LHS0 :                        1509 C |
 LHS1 :                        1526 C |  LHS2 :                        1538 C |
 LHS20 :                       1539 C |  LHS3 :                        153B C |
 LHSE :                        1555 C |  LHSR :                        155B C |
*LISTON :                         1 - |  LOADH :                       1484 C |
 LOGOP2STR :                   12B3 C |  LOGOP3STR :                   12C7 C |
 LOG_OP_E :                     64E C |  LOG_OP_S :                     644 C |
 LOOP_DEC :                    1ABD C |  LOOP_M8 :                     1B58 C |
 LST_END :                      159 C |  LST_PRG :                      13E C |
 LST_PRG1 :                     141 C |  L_B2 :                         2B0 C |
*MACEXP :                         7 - |  MAS_1 :                        822 C |
 MAS_2 :                        833 C |  MAS_3 :                        83F C |
 MC_SIZE :                    0EF83 C |  MEET_DD :                      5CE C |
 MEET_ED :                      5F0 C |  MEET_OP1 :                     60C C |
 MEET_OP2 :                     617 C |  MEET_OP3 :                     622 C |
 MEET_OP4 :                     62D C |  MKOPCSTR :                    100B C |
 MKREL_STR :                   0FBA C |  MK_2NDOPR :                    8D5 C |
 MK_2NDOPR1 :                   8DF C |  MK_ADR_STR :                   80C C |
 MK_BITR :                     0C5C C |  MK_BITR_STR :                 0C74 C |
 MK_KIXPNK :                   0D50 C |  MK_KIXYPNK :                  0F57 C |
*MK_KIYPNK :                   0D54 C |  MK_KN4K :                     0FB1 C |
 MK_KRK :                      1045 C |  MK_KRKCS :                    104D C |
 MK_KRK_1 :                    1042 C |  MK_N2CRLF :                   0F96 C |
 MK_N4CRLF :                   0F9C C |  MK_RCS :                      105E C |
 MK_RESR :                     0C65 C |  MK_RLCR :                     0C1D C |
 MK_RLR :                      0C2F C |  MK_RRCR :                     0C26 C |
 MK_RRR :                      0C38 C |  MK_SLAR :                     0C41 C |
 MK_SRAR :                     0C4A C |  MK_SRLR :                     0C53 C |
 MK_STR :                      0F81 C | *MOMCPU :                        80 - |
*MOMCPUNAME :                 "Z80" - |  MSECB :                      0EF4A C |
 MUL_10 :                       1E3 C |  MUL_8 :                       1B53 C |
 NEGSTR :                      11D9 C | *NESTMAX :                      100 - |
 NEXT_BC1 :                     402 C |  NEXT_BC10 :                    4DC C |
 NEXT_BC11 :                    4E9 C |  NEXT_BC111 :                   4FE C |
 NEXT_BC2 :                     425 C |  NEXT_BC21 :                    433 C |
 NEXT_BC22 :                    44E C | *NEXT_BC221 :                   44C C |
 NEXT_BC222 :                   446 C |  NEXT_BC3 :                     466 C |
 NEXT_BC4 :                     47B C |  NEXT_BC5 :                     492 C |
 NEXT_BC6 :                     489 C |  NEXT_BC7 :                     4A6 C |
 NEXT_BC8 :                     4B5 C |  NEXT_BC9 :                     4C8 C |
 NOPSTR :                      1184 C | *NO_OPERATE :                  1863 C |
 NO_RAM_AREA :                  57C C |  NO_RST38_MSG :                196A C |
 NUMPLUS :                     0F71 C |  OPNMSG :                      1D10 C |
 OP_ERR :                      0C6E C |  ORSTR :                       1166 C |
 OTDRSTR :                     122D C |  OTH_1OP_E :                   1097 C |
 OTH_1OP_S :                   108A C |  OTH_1OP_TBL :                 1299 C |
 OTIRSTR :                     1219 C |  OUTDSTR :                     1205 C |
 OUTISTR :                     11F4 C |  OUTSTR :                      11B0 C |
*PADDING :                        1 - |  PCST1 :                       1FB9 C |
 POPSTR :                      1174 C |  POP_PUSHRP :                  1291 C |
 POP_RP_E :                    10B7 C |  POP_RP_S :                    10B3 C |
 PROMPT :                      1D4F C |  PUSHSTR :                     1178 C |
 PUSH_RP_E :                   10BB C |  PUSH_RP_S :                   10B7 C |
 RAM12K :                         1 - |  RAM4K :                          0 - |
 RAM8K :                          0 - |  RAM_B :                      0C000 - |
*RAM_E :                      0EFFF - |  RD0 :                         16BF C |
 RD1 :                         16F7 C |  RD10 :                        16E5 C |
 RD101 :                       16DB C |  RD20 :                        1704 C |
 RDHEX :                       1812 C |  RDSA :                        1DEB C |
 RDSAX :                       1E10 C |  RDSBC :                       1DEF C |
 RDSBCX :                      1E16 C |  RDSDE :                       1DF5 C |
 RDSDEX :                      1E1C C |  RDSF :                        1E01 C |
 RDSFX :                       1E28 C |  RDSFX_H :                       1E - |
 RDSFX_L :                       28 - |  RDSF_H :                        1E - |
 RDSF_L :                         1 - |  RDSHL :                       1DFB C |
 RDSHLX :                      1E22 C |  RDSI :                        1E37 C |
 RDSIX :                       1E06 C |  RDSIY :                       1E0B C |
 RDSPC :                       1E32 C |  RDSR :                        1E3B C |
 RDSSP :                       1E2D C |  RDTAB :                       1D96 C |
 RDUMP :                       16BC C |  RD_SEC :                      1A4F C |
 RECTYP :                     0EF2A C |  REG :                         1636 C |
 REGAF :                      0EF2C C |  REGAFX :                     0EF34 C |
 REGBC :                      0EF2E C |  REGBCX :                     0EF36 C |
 REGDE :                      0EF30 C |  REGDEX :                     0EF38 C |
 REGHL :                      0EF32 C |  REGHLX :                     0EF3A C |
 REGI :                       0EF44 C |  REGIX :                      0EF3C C |
 REGIY :                      0EF3E C |  REGPC :                      0EF42 C |
 REGR :                       0EF45 C |  REGSP :                      0EF40 C |
 REG_B :                      0EF2C C |  REG_E :                      0EF46 C |
 REG_XY :                     0EF7F C | *RELAXED :                        0 - |
 REL_ADR_C :                    51A C |  REPEAT_TRACE :                19B9 C |
 RESSTR :                      11D5 C |  RETCC_TBLE :                   586 C |
 RETCC_TBLS :                   57E C |  RETISTR :                     1232 C |
 RETNSTR :                     1237 C |  RETSTR :                      112E C |
 RG0 :                         1643 C |  RG1 :                         1647 C |
 RG2 :                         1657 C |  RG3 :                         1666 C |
 RG4 :                         168B C |  RG5 :                         1697 C |
 RG6 :                         16B3 C |  RG7 :                         16B6 C |
 RGE :                         16B9 C |  RGR :                         16B6 C |
 RH0 :                         1817 C |  RH1 :                         182A C |
 RHE :                         1848 C |  RHE1 :                        1852 C |
 RLASTR :                      1192 C |  RLCASTR :                     1188 C |
 RLCSTR :                      11B7 C |  RLDSTR :                      11E4 C |
 RLSTR :                       11BF C |  RNA :                         1F59 C |
 RNAF :                        1127 C |  RNAFX :                       112A C |
 RNAX :                        1F72 C |  RNB :                         1F5E C |
 RNBC :                        1F5B C |  RNBCX :                       1F75 C |
 RNBX :                        1F79 C |  RNC :                         1F60 C |
 RNCX :                        1F7C C |  RND :                         1F65 C |
 RNDE :                        1F62 C |  RNDEX :                       1F7F C |
 RNDX :                        1F83 C |  RNE :                         1F67 C |
 RNEX :                        1F86 C |  RNF :                         1F70 C |
 RNFX :                        1F93 C |  RNH :                         1F6C C |
 RNHL :                        1F69 C |  RNHLX :                       1F89 C |
 RNHX :                        1F8D C |  RNI :                         1FA2 C |
 RNIX :                        1F96 C |  RNIY :                        1F99 C |
 RNL :                         1F6E C |  RNLX :                        1F90 C |
 RNPC :                        1F9F C |  RNR :                         1FA4 C |
 RNSP :                        1F9C C |  RNTAB :                       1E3F C |
 RNTABA :                      1E89 C |  RNTABB :                      1E97 C |
 RNTABBC :                     1EAB C |  RNTABC :                      1EB9 C |
 RNTABD :                      1EC7 C |  RNTABDE :                     1EDB C |
 RNTABE :                      1EE9 C |  RNTABF :                      1EF7 C |
 RNTABH :                      1F05 C |  RNTABHL :                     1F19 C |
 RNTABI :                      1F35 C |  RNTABL :                      1F27 C |
 RNTABP :                      1F49 C |  RNTABS :                      1F51 C |
 ROM_B :                          0 - |  RRASTR :                      1196 C |
 RRCASTR :                     118D C |  RRCSTR :                      11BB C |
 RRDSTR :                      11E0 C |  RRSTR :                       11C2 C |
 RST30H_IN :                   1854 C |  RST38H_IN :                   18D5 C |
 RST38MSG :                    19EE C |  RSTR_BPT :                    19CE C |
 RSTR_TPT :                    19C2 C |  RSTSTR :                      1142 C |
 RST_TBLE :                     5A3 C |  RST_TBLS :                     59B C |
 SADDR :                      0EF27 C |  SAVEH :                       155E C |
 SBCSTR :                      115A C |  SCFSTR :                      11A2 C |
 SECB :                       0EF48 C |  SETBPADR :                     260 C |
 SETM :                        140E C |  SETSTR :                      123C C |
 SET_BITNO :                   0C86 C |  SET_BP :                      1402 C |
 SET_BP1 :                      23E C |  SET_TM :                       325 C |
 SH0 :                         1568 C |  SH1 :                         156C C |
 SH2 :                         1594 C |  SH3 :                         159C C |
 SH4 :                         15B3 C |  SHE :                         1591 C |
 SHEMSG :                      1D5F C |  SHL0 :                        15C7 C |
 SHL00 :                       15BC C |  SHLI0 :                       15F0 C |
 SHLS :                        1604 C |  SHLS0 :                       1623 C |
*SIZE :                       0EF2B C |  SKIPSP :                      1802 C |
 SKP_RMSG :                    198C C |  SKP_TBP :                     13C5 C |
 SLASTR :                      11C5 C |  SM0 :                         1428 C |
 SM1 :                         1429 C |  SM2 :                         144F C |
 SM3 :                         145A C |  SM4 :                         1465 C |
 SRASTR :                      11C9 C |  SRECER :                      1D89 C |
 SRLSTR :                      11CD C |  STACK :                      0EEC0 - |
 STACKM :                     0EF00 - | *START :                          0 C |
 START_TIM :                   1A1F C |  STOPW :                       1A0A C |
 STOP_TIM :                    1A28 C |  STPBRK_MSG :                  19F8 C |
 STP_CHK :                      3AE C |  STROUT :                      1748 C |
 ST_COPY :                     1066 C |  ST_MUL8 :                     1B5C C |
 SUBSTR :                      1156 C |  SV_NNKR :                     0F6B C |
 TADR_CHK :                     39D C |  TC_CNT :                     0EF58 C |
 TERR_MSG :                     510 C |  THREE_OPTBL :                  64E C |
 THREE_OPTBLE :                 652 C |  THREE_OPTBL_E :                656 C |
 TIM0_CTL0 :                  0F800 - | *TIM0_CTL1 :                  0F801 - |
*TIME :                  "10:32:49" - |  TIMER0_CNTH :                0F811 - |
 TIMER0_CNTL :                0F810 - |  TIMER0_INITC :                87E1 - |
 TIMER0_SCTH :                0F821 - |  TIMER0_SCTL :                0F820 - |
 TMPB_ADR :                   0EF6F C |  TMPB_F :                     0EF6D C |
 TMPB_OP :                    0EF6E C |  TMPT :                       0EF5A C |
 TM_MODE :                    0EF57 C |  TM_MSG_0 :                     336 C |
 TM_MSG_I :                     345 C |  TM_MSG_S :                     34B C |
 TPT1_ADR :                   0EF5F C |  TPT1_F :                     0EF5D C |
 TPT1_OP :                    0EF5E C |  TPT2_ADR :                   0EF63 C |
 TPT2_F :                     0EF61 C |  TPT2_OP :                    0EF62 C |
 TP_CHK1 :                     1945 C |  TP_CHK2 :                     1954 C |
 TP_CMD :                       353 C |  TP_MD_ON :                     377 C |
 TP_MODE :                    0EF56 C |  TP_MSG_0 :                     388 C |
 TP_MSG_OFF :                   397 C |  TP_MSG_ON :                    392 C |
 TP_N1 :                        35F C |  TP_N2 :                        368 C |
 TRACE_CMD :                    2D7 C |  TRACE_MSG :                   1A01 C |
*TRUE :                           1 - |  TWO_OPTBL :                    63C C |
 TWO_OPTBL_E :                  64E C |  T_NO_KY :                     19A4 C |
 T_OP1 :                        3C6 C |  T_OP11 :                       3C0 C |
 T_OP_CHK :                     3E1 C |  UARTCR :                     0FF01 - |
 UARTDR :                     0FF00 - |  UPPER :                       1809 C |
 UP_BI :                        1E1 C |  U_0 :                         1A98 C |
 U_00 :                        1A92 C |  U_1 :                         1A9C C |
*VERSION :                     142F - |  WORK_B :                     0EF00 - |
 WSTART :                       0BE C |  WS_CHK1 :                     18A0 C |
 WS_CHK2 :                     18AC C |  WS_CHK3 :                     18B8 C |
 WS_CHK4 :                     18C4 C |  WS_CHK5 :                     18D0 C |
 XORSTR :                      1162 C |  XY_SRTP :                    0EF81 C |

    795 symbols
     35 unused symbols

 AS V1.42 Beta [Bld 227] - Source File emuz80monRevB021.asm - Page 3 - 10/24/2022 10:32:49


  Code Pages:
  ----------

STANDARD (0 changed characters)

1 code page

0.08 seconds assembly time

   5938 lines source file
      2 passes
      0 errors
      0 warnings
